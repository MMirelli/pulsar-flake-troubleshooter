[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:16:59,684 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:17:00,711 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:17:00,713 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:17:01,182 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:17:01,183 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:17:01,183 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:17:01,184 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:17:01,185 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:17:01,186 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:17:01,200 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:17:01,201 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:17:01,201 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:17:01,202 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:17:01,203 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:17:01,203 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:17:01,204 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:17:01,204 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:17:01,205 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:17:01,205 - INFO  - [main:Environment@98] - Client environment:os.memory.free=28MB
2024-02-05T18:17:01,206 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:17:01,206 - INFO  - [main:Environment@98] - Client environment:os.memory.total=128MB
2024-02-05T18:17:02,732 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:17:02,732 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:17:02,733 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:17:02,733 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:17:03,053 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:17:03,054 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:17:03,128 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:17:03,207 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:17:03,209 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:17:03,228 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:17:03,361 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:17:03,410 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:17:03,464 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:17:03,847 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:17:03,848 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:17:03,889 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:17:03,978 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:34557, TLS: (none), listener: (none)
2024-02-05T18:17:04,281 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:34037, TLS: OPENSSL, listener: (none)
2024-02-05T18:17:04,302 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:17:04,307 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:17:04,307 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:17:04,341 - INFO  - [main:Log@170] - Logging initialized @6974ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:17:05,331 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:17:05,361 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:17:05,361 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:17:05,364 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:17:06,146 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/,null,AVAILABLE}
2024-02-05T18:17:07,338 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin,null,AVAILABLE}
2024-02-05T18:17:08,606 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,AVAILABLE}
2024-02-05T18:17:08,976 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,AVAILABLE}
2024-02-05T18:17:09,079 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,AVAILABLE}
2024-02-05T18:17:09,292 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/topics,null,AVAILABLE}
2024-02-05T18:17:09,294 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,AVAILABLE}
2024-02-05T18:17:09,296 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@1978b0d5{/static,null,AVAILABLE}
2024-02-05T18:17:09,311 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:36039}
2024-02-05T18:17:09,474 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:46843}
2024-02-05T18:17:09,475 - INFO  - [main:Server@415] - Started @12109ms
2024-02-05T18:17:09,475 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:36039
2024-02-05T18:17:09,476 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:46843
2024-02-05T18:17:09,484 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:17:09,484 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:17:09,684 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:36039
2024-02-05T18:17:09,704 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:17:09,708 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:36039 is changing the role from null to Leader
2024-02-05T18:17:09,711 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:36039).
2024-02-05T18:17:10,062 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:36039 
2024-02-05T18:17:10,561 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:17:10,592 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:17:10,710 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:17:10,714 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:17:10,726 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:17:10,728 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:17:10,772 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:17:10,803 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:17:10,829 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:17:10,889 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:17:10,904 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:17:10,915 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:17:10,918 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:17:10,950 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:17:10,956 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:10 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 540
2024-02-05T18:17:11,096 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x62c93efa, L:/127.0.0.1:59018 - R:localhost/127.0.0.1:34557]] Connected to server
2024-02-05T18:17:11,138 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:59018] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:17:11,216 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:17:11,224 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x62c93efa, L:/127.0.0.1:59018 - R:localhost/127.0.0.1:34557]
2024-02-05T18:17:11,278 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:17:11,325 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:59018] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:59018, producerName=test-0-0, producerId=0}
2024-02-05T18:17:11,342 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x62c93efa, L:/127.0.0.1:59018 - R:localhost/127.0.0.1:34557]
2024-02-05T18:17:11,344 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:17:11,411 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:17:11,414 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-910b1ec5ee] Subscribing to topic on cnx [id: 0x62c93efa, L:/127.0.0.1:59018 - R:localhost/127.0.0.1:34557], consumerId 0
2024-02-05T18:17:11,427 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xe35c16fa, L:/127.0.0.1:34557 - R:/127.0.0.1:59018]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-910b1ec5ee. consumerId: 0
2024-02-05T18:17:11,464 - INFO  - [pulsar-io-9-1:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-910b1ec5ee] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:17:11,465 - INFO  - [pulsar-io-9-1:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:17:11,466 - INFO  - [pulsar-io-9-1:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-910b1ec5ee, ackPos=3:-1, readPos=3:0}
2024-02-05T18:17:11,491 - INFO  - [pulsar-io-9-1:ServerCnx@1263] - [/127.0.0.1:59018] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-910b1ec5ee
2024-02-05T18:17:11,496 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-910b1ec5ee] Subscribed to topic on localhost/127.0.0.1:34557 -- consumer: 0
2024-02-05T18:17:11,512 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.014 seconds
2024-02-05T18:17:11,513 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:17:11,514 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:17:11,515 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:17:11,562 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:17:11,583 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:17:11,584 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:17:11,586 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:17:11,590 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:11 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 60
2024-02-05T18:17:11,602 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:17:11,611 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:17:11,612 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:17:11,614 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:17:11,615 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:11 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:17:11,638 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:17:11,639 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x62c93efa, L:/127.0.0.1:59018 - R:localhost/127.0.0.1:34557]
2024-02-05T18:17:11,649 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:17:11,657 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:59018] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:59018, producerName=test-0-1, producerId=1}
2024-02-05T18:17:11,661 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x62c93efa, L:/127.0.0.1:59018 - R:localhost/127.0.0.1:34557]
2024-02-05T18:17:11,673 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:17:11,675 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d180544db2] Subscribing to topic on cnx [id: 0x62c93efa, L:/127.0.0.1:59018 - R:localhost/127.0.0.1:34557], consumerId 1
2024-02-05T18:17:11,676 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xe35c16fa, L:/127.0.0.1:34557 - R:/127.0.0.1:59018]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-d180544db2. consumerId: 1
2024-02-05T18:17:11,696 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d180544db2] Created new subscription for 1
2024-02-05T18:17:11,697 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:59018] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-d180544db2
2024-02-05T18:17:11,698 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d180544db2] Subscribed to topic on localhost/127.0.0.1:34557 -- consumer: 1
2024-02-05T18:17:11,722 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:17:11,723 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x62c93efa, L:/127.0.0.1:59018 - R:localhost/127.0.0.1:34557]
2024-02-05T18:17:11,734 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:17:11,741 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:59018] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:59018, producerName=test-0-2, producerId=2}
2024-02-05T18:17:11,743 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x62c93efa, L:/127.0.0.1:59018 - R:localhost/127.0.0.1:34557]
2024-02-05T18:17:11,756 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:17:11,776 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:17:11,783 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:36039 started the ownership monitor.
2024-02-05T18:17:11,801 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:17:11,803 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-41c798c762] Subscribing to topic on cnx [id: 0x62c93efa, L:/127.0.0.1:59018 - R:localhost/127.0.0.1:34557], consumerId 2
2024-02-05T18:17:11,810 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xe35c16fa, L:/127.0.0.1:34557 - R:/127.0.0.1:59018]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-41c798c762. consumerId: 2
2024-02-05T18:17:11,823 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-41c798c762] Created new subscription for 2
2024-02-05T18:17:11,823 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:59018] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-41c798c762
2024-02-05T18:17:11,824 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-41c798c762] Subscribed to topic on localhost/127.0.0.1:34557 -- consumer: 2
2024-02-05T18:17:11,825 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:36039 plays the leader now.
2024-02-05T18:17:11,831 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 54.10%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 54.10%, msgThroughputEMA= 0.00, updatedAt= 1707149831830, reportedAt= 0
2024-02-05T18:17:11,834 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:36039/__change_events
2024-02-05T18:17:11,860 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:17:11,865 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:17:11,866 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:17:11,937 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:36039/0x00000000_0xffffffff - localhost:36039.
2024-02-05T18:17:11,944 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:36039/__change_events][reader-9c1f4edf04] Subscribing to topic on cnx [id: 0x62c93efa, L:/127.0.0.1:59018 - R:localhost/127.0.0.1:34557], consumerId 3
2024-02-05T18:17:11,945 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:36039/0x00000000_0xffffffff
2024-02-05T18:17:11,948 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xe35c16fa, L:/127.0.0.1:34557 - R:/127.0.0.1:59018]] Subscribing on topic persistent://sla-monitor/test/localhost:36039/__change_events / reader-9c1f4edf04. consumerId: 3
2024-02-05T18:17:11,949 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:36039
2024-02-05T18:17:11,950 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:36039/0x00000000_0xffffffff - localhost:36039.
2024-02-05T18:17:11,951 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:36039
2024-02-05T18:17:11,951 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:36039/0x00000000_0xffffffff
2024-02-05T18:17:11,961 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:36039/persistent/__change_events
2024-02-05T18:17:11,963 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:36039/persistent/__change_events'
2024-02-05T18:17:11,968 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:36039 doesn't exist.
2024-02-05T18:17:11,970 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:17:11,971 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:36039/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:17:11,979 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:36039/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:17:11,986 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:36039/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:17:11,989 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:36039/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:36039/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:17:11,991 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:36039/__change_events - dedup is disabled
2024-02-05T18:17:12,004 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:17:12,010 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:36039/__change_events][reader-9c1f4edf04] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:17:12,011 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:36039/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:17:12,011 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:36039/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:36039/persistent/__change_events, cursor=reader-9c1f4edf04, ackPos=7:-1, readPos=7:0}
2024-02-05T18:17:12,013 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:59018] Created subscription on topic persistent://sla-monitor/test/localhost:36039/__change_events / reader-9c1f4edf04
2024-02-05T18:17:12,014 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:36039/__change_events][reader-9c1f4edf04] Subscribed to topic on localhost/127.0.0.1:34557 -- consumer: 3
2024-02-05T18:17:11,985 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=9, bootstrap service port = 36039, tls-port = Optional[46843], broker url= pulsar://localhost:34557, broker tls url= pulsar+ssl://localhost:34037, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[34557], brokerServicePortTls=Optional[34037], webServicePort=Optional[36039], webServicePortTls=Optional[46843], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:17:12,591 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:17:12,591 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:17:12,591 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:17:12,592 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:17:12,597 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:17:12,597 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:17:12,604 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:17:12,608 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:17:12,614 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:17:12,615 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:17:12,622 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:17:12,631 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:17:12,636 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:17:12,645 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:17:12,645 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:17:12,651 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:17:12,654 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:34363, TLS: (none), listener: (none)
2024-02-05T18:17:12,656 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:45149, TLS: OPENSSL, listener: (none)
2024-02-05T18:17:12,660 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:17:12,661 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:17:12,661 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:17:12,674 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:17:12,678 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:17:12,679 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:17:12,679 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:17:12,767 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/,null,AVAILABLE}
2024-02-05T18:17:12,881 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:17:12,882 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:17:13,524 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/admin,null,AVAILABLE}
2024-02-05T18:17:13,883 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:17:13,883 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:17:14,884 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:17:14,885 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:17:14,914 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,AVAILABLE}
2024-02-05T18:17:15,150 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,AVAILABLE}
2024-02-05T18:17:15,216 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,AVAILABLE}
2024-02-05T18:17:15,323 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/topics,null,AVAILABLE}
2024-02-05T18:17:15,325 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,AVAILABLE}
2024-02-05T18:17:15,326 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@554f6e30{/static,null,AVAILABLE}
2024-02-05T18:17:15,334 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:38057}
2024-02-05T18:17:15,348 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:36089}
2024-02-05T18:17:15,349 - INFO  - [main:Server@415] - Started @17983ms
2024-02-05T18:17:15,349 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:38057
2024-02-05T18:17:15,351 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:36089
2024-02-05T18:17:15,353 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:17:15,355 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:17:15,372 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:38057
2024-02-05T18:17:15,373 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:38057 registry has been created.
2024-02-05T18:17:15,374 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:38057. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:17:15,376 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:38057 is changing the role from null to Follower
2024-02-05T18:17:15,380 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:36039).
2024-02-05T18:17:15,386 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:17:15,400 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:38057 
2024-02-05T18:17:15,531 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:15 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 62
2024-02-05T18:17:15,554 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:17:15,556 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:17:15,558 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:17:15,574 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:15 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 34
2024-02-05T18:17:15,576 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:38057/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:17:15,586 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x4e3ea406, L:/127.0.0.1:57330 - R:localhost/127.0.0.1:34363]] Connected to server
2024-02-05T18:17:15,593 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:57330] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:17:15,610 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x81dc736c, L:/127.0.0.1:59026 - R:localhost/127.0.0.1:34557]] Connected to server
2024-02-05T18:17:15,613 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:59026] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:17:15,615 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x81dc736c, L:/127.0.0.1:59026 - R:localhost/127.0.0.1:34557]
2024-02-05T18:17:15,626 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:59026] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:59026, producerName=test-0-3, producerId=0}
2024-02-05T18:17:15,628 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x81dc736c, L:/127.0.0.1:59026 - R:localhost/127.0.0.1:34557]
2024-02-05T18:17:15,642 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-ae853545f4] Subscribing to topic on cnx [id: 0x81dc736c, L:/127.0.0.1:59026 - R:localhost/127.0.0.1:34557], consumerId 0
2024-02-05T18:17:15,644 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x2c4c04a6, L:/127.0.0.1:34557 - R:/127.0.0.1:59026]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-ae853545f4. consumerId: 0
2024-02-05T18:17:15,649 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-ae853545f4] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:17:15,650 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:17:15,650 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-ae853545f4, ackPos=3:-1, readPos=3:0}
2024-02-05T18:17:15,652 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:59026] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-ae853545f4
2024-02-05T18:17:15,653 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-ae853545f4] Subscribed to topic on localhost/127.0.0.1:34557 -- consumer: 0
2024-02-05T18:17:15,657 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:17:15,658 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:17:15,684 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:15 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:17:15,694 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:17:15,698 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:17:15,699 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:17:15,704 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:38057/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:17:15,705 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:15 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 18
2024-02-05T18:17:15,717 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:15 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 9
2024-02-05T18:17:15,722 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:17:15,725 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:17:15,726 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:17:15,729 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:15 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T18:17:15,730 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:38057/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:17:15,746 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x81dc736c, L:/127.0.0.1:59026 - R:localhost/127.0.0.1:34557]
2024-02-05T18:17:15,754 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:59026] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:59026, producerName=test-0-4, producerId=1}
2024-02-05T18:17:15,755 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x81dc736c, L:/127.0.0.1:59026 - R:localhost/127.0.0.1:34557]
2024-02-05T18:17:15,768 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-2c4dbd4a11] Subscribing to topic on cnx [id: 0x81dc736c, L:/127.0.0.1:59026 - R:localhost/127.0.0.1:34557], consumerId 1
2024-02-05T18:17:15,770 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x2c4c04a6, L:/127.0.0.1:34557 - R:/127.0.0.1:59026]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-2c4dbd4a11. consumerId: 1
2024-02-05T18:17:15,783 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-2c4dbd4a11] Created new subscription for 1
2024-02-05T18:17:15,784 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:59026] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-2c4dbd4a11
2024-02-05T18:17:15,785 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-2c4dbd4a11] Subscribed to topic on localhost/127.0.0.1:34557 -- consumer: 1
2024-02-05T18:17:15,802 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x81dc736c, L:/127.0.0.1:59026 - R:localhost/127.0.0.1:34557]
2024-02-05T18:17:15,811 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:59026] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:59026, producerName=test-0-5, producerId=2}
2024-02-05T18:17:15,813 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x81dc736c, L:/127.0.0.1:59026 - R:localhost/127.0.0.1:34557]
2024-02-05T18:17:15,815 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:17:15,819 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:17:15,820 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:38057 plays a follower now.
2024-02-05T18:17:15,837 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:38057/__change_events
2024-02-05T18:17:15,858 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:38057/0x00000000_0xffffffff - localhost:38057.
2024-02-05T18:17:15,860 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:38057/0x00000000_0xffffffff
2024-02-05T18:17:15,860 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:38057
2024-02-05T18:17:15,861 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:38057/0x00000000_0xffffffff - localhost:38057.
2024-02-05T18:17:15,865 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:38057
2024-02-05T18:17:15,865 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:38057/0x00000000_0xffffffff
2024-02-05T18:17:15,867 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:38057/__change_events][reader-9d086a60d0] Subscribing to topic on cnx [id: 0x4e3ea406, L:/127.0.0.1:57330 - R:localhost/127.0.0.1:34363], consumerId 2
2024-02-05T18:17:15,870 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x0b791ef6, L:/127.0.0.1:34363 - R:/127.0.0.1:57330]] Subscribing on topic persistent://sla-monitor/test/localhost:38057/__change_events / reader-9d086a60d0. consumerId: 2
2024-02-05T18:17:15,870 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:38057 doesn't exist.
2024-02-05T18:17:15,877 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:38057/persistent/__change_events
2024-02-05T18:17:15,873 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 38057, tls-port = Optional[36089], broker url= pulsar://localhost:34363, broker tls url= pulsar+ssl://localhost:45149, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[34363], brokerServicePortTls=Optional[45149], webServicePort=Optional[38057], webServicePortTls=Optional[36089], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:17:15,879 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:38057/persistent/__change_events'
2024-02-05T18:17:15,889 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:17:15,889 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:17:15,894 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:17:15,896 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:38057/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:17:15,905 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:38057/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:17:15,909 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:38057/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:17:15,913 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:38057/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:38057/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:17:15,915 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:38057/__change_events - dedup is disabled
2024-02-05T18:17:15,924 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:17:15,931 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:38057/__change_events][reader-9d086a60d0] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:17:15,931 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:38057/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:17:15,932 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:38057/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38057/persistent/__change_events, cursor=reader-9d086a60d0, ackPos=9:-1, readPos=9:0}
2024-02-05T18:17:15,935 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:57330] Created subscription on topic persistent://sla-monitor/test/localhost:38057/__change_events / reader-9d086a60d0
2024-02-05T18:17:15,936 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:38057/__change_events][reader-9d086a60d0] Subscribed to topic on localhost/127.0.0.1:34363 -- consumer: 2
2024-02-05T18:17:16,112 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:17:16,113 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:16 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:17:16,142 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:17:16,143 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:16 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:17:16,167 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:17:16,168 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:17:16,172 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:17:16,173 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:16 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T18:17:16,197 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:17:16,197 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:17:16,198 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:17:16,199 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:16 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 20
2024-02-05T18:17:16,201 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:17:16,202 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:17:16,212 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:17:16,212 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:17:16,217 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:17:16,220 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:16 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T18:17:16,232 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:17:16,233 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:17:16,234 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:17:16,238 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:16 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:17:16,240 - INFO  - [pulsar-7-3:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:17:16,241 - INFO  - [pulsar-62-5:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:17:16,275 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:17:16,284 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:17:16,284 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:17:16,297 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:17:16,310 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:17:16,329 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:38057 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:17:16,377 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36039 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:38057, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149836331, versionId=1]. totalHandledRequests:1
2024-02-05T18:17:16,398 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:17:16,398 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36039 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:38057, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149836376, versionId=2]. totalHandledRequests:1
2024-02-05T18:17:16,406 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:17:16,414 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:16 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 119
2024-02-05T18:17:16,426 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:17:16,463 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-24e87d7e77] Subscribing to topic on cnx [id: 0x4e3ea406, L:/127.0.0.1:57330 - R:localhost/127.0.0.1:34363], consumerId 3
2024-02-05T18:17:16,466 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36039 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:38057, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149836458, versionId=3]. totalHandledRequests:1
2024-02-05T18:17:16,466 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x0b791ef6, L:/127.0.0.1:34363 - R:/127.0.0.1:57330]] Subscribing on topic persistent://public/test/__change_events / reader-24e87d7e77. consumerId: 3
2024-02-05T18:17:16,475 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:17:16,772 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 41.02%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 52.79%, msgThroughputEMA= 0.00, updatedAt= 1707149836771, reportedAt= 1707149831907
2024-02-05T18:17:16,890 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:17:16,890 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:17:17,891 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:17:17,891 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:17:18,892 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:17:18,893 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:17:19,893 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:17:19,894 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:17:20,895 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:17:20,895 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:17:21,772 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 41.02%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 51.62%, msgThroughputEMA= 0.00, updatedAt= 1707149841771, reportedAt= 1707149831907
2024-02-05T18:17:21,896 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:17:21,896 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1441] - Overriding in-flight state ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:38057, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149836458, versionId=3] to overrideData:Optional[ServiceUnitStateData[state=Owned, dstBroker=localhost:38057, sourceBroker=null, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149841896, versionId=4]]
2024-02-05T18:17:21,902 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 5.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:1. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:17:21,904 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:17:21,904 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36039 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:38057, sourceBroker=null, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149841896, versionId=4]. totalHandledRequests:2
2024-02-05T18:17:21,904 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:17:21,905 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:16 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 5487
2024-02-05T18:17:21,906 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:17:21,907 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:17:21,908 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:17:16 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 5637
2024-02-05T18:17:21,909 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:17:21,917 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:17:21,917 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:17:21,924 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:17:21,929 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:17:21,931 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:17:21,933 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:17:21,969 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:17:21,970 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:17:21,972 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:17:21,983 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:17:21,983 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2999ad0], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e9ca1ca] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2999ad0, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3fa203b1], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e9ca1ca, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6c1b172b] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2999ad0, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3fa203b1, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@221a4f62], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e9ca1ca, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6c1b172b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4963281a] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2999ad0, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3fa203b1, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@221a4f62, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@66f3050c], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e9ca1ca, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6c1b172b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4963281a, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52e5f4b6] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2999ad0, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3fa203b1, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@221a4f62, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@66f3050c, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2274c0d7], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e9ca1ca, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6c1b172b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4963281a, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52e5f4b6, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72870f7b] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2999ad0, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3fa203b1, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@221a4f62, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@66f3050c, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2274c0d7, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c22bf42], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e9ca1ca, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6c1b172b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4963281a, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52e5f4b6, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72870f7b, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@711fba34] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2999ad0, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3fa203b1, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@221a4f62, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@66f3050c, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2274c0d7, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c22bf42, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7569beb8], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e9ca1ca, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6c1b172b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4963281a, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52e5f4b6, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72870f7b, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@711fba34, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3fdf9bb9] 
2024-02-05T18:17:21,991 - WARN  - [metadata-store-57-1:PersistentTopic@877] - [persistent://public/test/__change_events] Attempting to subscribe to a fenced topic
2024-02-05T18:17:21,991 - WARN  - [metadata-store-57-1:ServerCnx@1299] - [/127.0.0.1:57330][persistent://public/test/__change_events][reader-24e87d7e77] Failed to create consumer: consumerId=3, Topic is temporarily unavailable
2024-02-05T18:17:21,995 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x4e3ea406, L:/127.0.0.1:57330 - R:localhost/127.0.0.1:34363] Received error from server: Topic is temporarily unavailable
2024-02-05T18:17:21,997 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-24e87d7e77] Failed to subscribe to topic on localhost/127.0.0.1:34363
2024-02-05T18:17:21,997 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-24e87d7e77] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Topic is temporarily unavailable","reqId":2212219357130313491, "remote":"localhost/127.0.0.1:34363", "local":"/127.0.0.1:57330"}
2024-02-05T18:17:21,998 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-24e87d7e77] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Topic is temporarily unavailable","reqId":2212219357130313491, "remote":"localhost/127.0.0.1:34363", "local":"/127.0.0.1:57330"} -- Will try again in 0.1 s
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:17:22,014 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:17:22,016 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 5543.0 ms
2024-02-05T18:17:22,018 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:17:22,024 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@198] - Skipped the message from topic persistent://pulsar/system/loadbalancer-service-unit-state. key=public/test/0x00000000_0xffffffff value=ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:38057, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149836472, versionId=4] prev=ServiceUnitStateData[state=Owned, dstBroker=localhost:38057, sourceBroker=null, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149841896, versionId=4]
2024-02-05T18:17:22,024 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@198] - Skipped the message from topic persistent://pulsar/system/loadbalancer-service-unit-state. key=public/test/0x00000000_0xffffffff value=ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:38057, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149836472, versionId=4] prev=ServiceUnitStateData[state=Owned, dstBroker=localhost:38057, sourceBroker=null, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149841896, versionId=4]
2024-02-05T18:17:22,033 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:17:22,036 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:17:22,036 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:17:22,038 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@554f6e30{/static,null,STOPPED}
2024-02-05T18:17:22,042 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,STOPPED}
2024-02-05T18:17:22,055 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/topics,null,STOPPED}
2024-02-05T18:17:22,058 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,STOPPED}
2024-02-05T18:17:22,060 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,STOPPED}
2024-02-05T18:17:22,063 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,STOPPED}
2024-02-05T18:17:22,066 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/admin,null,STOPPED}
2024-02-05T18:17:22,069 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/,null,STOPPED}
2024-02-05T18:17:22,073 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:17:22,075 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:17:22,076 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:17:22,077 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38057
2024-02-05T18:17:22,081 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:36039. Skipping this broker. Phase one
2024-02-05T18:17:22,082 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:38057, sourceBroker=null, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149841896, versionId=4] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:36039, sourceBroker=localhost:38057, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149842081, versionId=5]
2024-02-05T18:17:22,090 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36039 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:36039, sourceBroker=localhost:38057, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149842081, versionId=5]. totalHandledRequests:6
2024-02-05T18:17:22,092 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:36039 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:36039, sourceBroker=localhost:38057, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149842081, versionId=5], next:, totalHandledRequests:6, totalFailedRequests:6
2024-02-05T18:17:22,093 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:17:22,100 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-24e87d7e77] Reconnecting after connection was closed
2024-02-05T18:17:22,101 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:17:22,102 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:17:22,104 - ERROR - [pulsar-io-64-2:ClientCnx@1196] - [id: 0x4e3ea406, L:/127.0.0.1:57330 - R:localhost/127.0.0.1:34363] Close connection because received internal-server error Failed due to pulsar service is not ready
2024-02-05T18:17:22,105 - WARN  - [pulsar-io-64-2:BinaryProtoLookupService@158] - [persistent://public/test/__change_events] failed to send lookup request : {"errorMsg":"Failed due to pulsar service is not ready","reqId":2212219357130313492, "remote":"localhost/127.0.0.1:34363", "local":"/127.0.0.1:57330"}
2024-02-05T18:17:22,105 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-24e87d7e77] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":2212219357130313492, "remote":"localhost/127.0.0.1:34363", "local":"/127.0.0.1:57330"}
2024-02-05T18:17:22,105 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-24e87d7e77] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":2212219357130313492, "remote":"localhost/127.0.0.1:34363", "local":"/127.0.0.1:57330"} -- Will try again in 0.191 s
2024-02-05T18:17:22,106 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x4e3ea406, L:/127.0.0.1:57330 ! R:localhost/127.0.0.1:34363] Disconnected
2024-02-05T18:17:22,109 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:57330
2024-02-05T18:17:22,110 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:38057/__change_events, name=reader-9d086a60d0}, consumerId=2, consumerName=f6086, address=/127.0.0.1:57330}
2024-02-05T18:17:22,111 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:38057/__change_events][reader-9d086a60d0] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38057/persistent/__change_events, cursor=reader-9d086a60d0, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:17:22,094 - INFO  - [broker-client-shared-internal-executor-65-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 2.0 ms
2024-02-05T18:17:22,112 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:38057/__change_events][reader-9d086a60d0] Successfully closed dispatcher for reader
2024-02-05T18:17:22,115 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:38057/__change_events] [reader-9d086a60d0] Closed connection [id: 0x4e3ea406, L:/127.0.0.1:57330 ! R:localhost/127.0.0.1:34363] -- Will try again in 0.1 s
2024-02-05T18:17:22,141 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:17:22,144 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-4d17f0ff02] Subscribing to topic on cnx [id: 0x62c93efa, L:/127.0.0.1:59018 - R:localhost/127.0.0.1:34557], consumerId 4
2024-02-05T18:17:22,148 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xe35c16fa, L:/127.0.0.1:34557 - R:/127.0.0.1:59018]] Subscribing on topic persistent://public/test/__change_events / reader-4d17f0ff02. consumerId: 4
2024-02-05T18:17:22,160 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:17:22,167 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:17:22,167 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:17:22,176 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:17:22,178 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:17:22,179 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:17:22,183 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:17:22,184 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:17:22,184 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:17:22,188 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:17:22,197 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-4d17f0ff02] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:17:22,197 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:17:22,197 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-4d17f0ff02, ackPos=13:-1, readPos=13:0}
2024-02-05T18:17:22,198 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:59018] Created subscription on topic persistent://public/test/__change_events / reader-4d17f0ff02
2024-02-05T18:17:22,199 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-4d17f0ff02] Subscribed to topic on localhost/127.0.0.1:34557 -- consumer: 4
2024-02-05T18:17:22,215 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://sla-monitor/test/localhost:38057/__change_events] [reader-9d086a60d0] Reconnecting after timeout
2024-02-05T18:17:22,216 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x1b1b91db, L:/127.0.0.1:49688 - R:localhost/127.0.0.1:34363]] Connected to server
2024-02-05T18:17:22,218 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:49688
2024-02-05T18:17:22,219 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x1b1b91db, L:/127.0.0.1:49688 - R:localhost/127.0.0.1:34363] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:17:22,219 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0x1b1b91db, L:/127.0.0.1:49688 - R:localhost/127.0.0.1:34363] Received unknown request id from server: -1
2024-02-05T18:17:22,219 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x1b1b91db, L:/127.0.0.1:49688 ! R:localhost/127.0.0.1:34363] Disconnected
2024-02-05T18:17:22,220 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0x1b1b91db, L:/127.0.0.1:49688 ! R:localhost/127.0.0.1:34363]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:17:22,220 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:38057/__change_events] [reader-9d086a60d0] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:17:22,220 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:38057/__change_events] [reader-9d086a60d0] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.186 s
2024-02-05T18:17:22,297 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-24e87d7e77] Reconnecting after connection was closed
2024-02-05T18:17:22,299 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xaf807cd8, L:/127.0.0.1:49696 - R:localhost/127.0.0.1:34363]] Connected to server
2024-02-05T18:17:22,302 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:49696
2024-02-05T18:17:22,302 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0xaf807cd8, L:/127.0.0.1:49696 - R:localhost/127.0.0.1:34363] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:17:22,303 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0xaf807cd8, L:/127.0.0.1:49696 - R:localhost/127.0.0.1:34363] Received unknown request id from server: -1
2024-02-05T18:17:22,303 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xaf807cd8, L:/127.0.0.1:49696 ! R:localhost/127.0.0.1:34363] Disconnected
2024-02-05T18:17:22,304 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0xaf807cd8, L:/127.0.0.1:49696 ! R:localhost/127.0.0.1:34363]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:17:22,304 - WARN  - [pulsar-io-64-1:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-24e87d7e77] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:17:22,304 - WARN  - [pulsar-io-64-1:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-24e87d7e77] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.386 s
2024-02-05T18:17:22,407 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:38057/__change_events] [reader-9d086a60d0] Reconnecting after connection was closed
2024-02-05T18:17:22,409 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0xdf132939, L:/127.0.0.1:49700 - R:localhost/127.0.0.1:34363]] Connected to server
2024-02-05T18:17:22,412 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:49700
2024-02-05T18:17:22,412 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0xdf132939, L:/127.0.0.1:49700 - R:localhost/127.0.0.1:34363] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:17:22,412 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0xdf132939, L:/127.0.0.1:49700 - R:localhost/127.0.0.1:34363] Received unknown request id from server: -1
2024-02-05T18:17:22,412 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0xdf132939, L:/127.0.0.1:49700 ! R:localhost/127.0.0.1:34363] Disconnected
2024-02-05T18:17:22,413 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0xdf132939, L:/127.0.0.1:49700 ! R:localhost/127.0.0.1:34363]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:17:22,413 - WARN  - [pulsar-io-64-4:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:38057/__change_events] [reader-9d086a60d0] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:17:22,413 - WARN  - [pulsar-io-64-4:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:38057/__change_events] [reader-9d086a60d0] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.379 s
2024-02-05T18:17:22,692 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-24e87d7e77] Reconnecting after connection was closed
2024-02-05T18:17:22,693 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0x68a2ff79, L:/127.0.0.1:49712 - R:localhost/127.0.0.1:34363]] Connected to server
2024-02-05T18:17:22,696 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0x68a2ff79, L:/127.0.0.1:49712 - R:localhost/127.0.0.1:34363] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:17:22,696 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0x68a2ff79, L:/127.0.0.1:49712 - R:localhost/127.0.0.1:34363] Received unknown request id from server: -1
2024-02-05T18:17:22,697 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0x68a2ff79, L:/127.0.0.1:49712 ! R:localhost/127.0.0.1:34363] Disconnected
2024-02-05T18:17:22,697 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0x68a2ff79, L:/127.0.0.1:49712 ! R:localhost/127.0.0.1:34363]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:17:22,697 - WARN  - [pulsar-io-64-3:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-24e87d7e77] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:17:22,697 - WARN  - [pulsar-io-64-3:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-24e87d7e77] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.744 s
2024-02-05T18:17:22,698 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:49712
2024-02-05T18:17:22,793 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:38057/__change_events] [reader-9d086a60d0] Reconnecting after connection was closed
2024-02-05T18:17:22,795 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x3214f192, L:/127.0.0.1:49722 - R:localhost/127.0.0.1:34363]] Connected to server
2024-02-05T18:17:22,798 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:49722
2024-02-05T18:17:22,799 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x3214f192, L:/127.0.0.1:49722 - R:localhost/127.0.0.1:34363] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:17:22,799 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0x3214f192, L:/127.0.0.1:49722 - R:localhost/127.0.0.1:34363] Received unknown request id from server: -1
2024-02-05T18:17:22,800 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x3214f192, L:/127.0.0.1:49722 ! R:localhost/127.0.0.1:34363] Disconnected
2024-02-05T18:17:22,800 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0x3214f192, L:/127.0.0.1:49722 ! R:localhost/127.0.0.1:34363]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:17:22,800 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:38057/__change_events] [reader-9d086a60d0] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:17:22,800 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:38057/__change_events] [reader-9d086a60d0] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.735 s
2024-02-05T18:17:22,902 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:17:22,903 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:17:23,443 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-24e87d7e77] Reconnecting after connection was closed
2024-02-05T18:17:23,444 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xcee40651, L:/127.0.0.1:49726 - R:localhost/127.0.0.1:34363]] Connected to server
2024-02-05T18:17:23,448 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0xcee40651, L:/127.0.0.1:49726 - R:localhost/127.0.0.1:34363] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:17:23,448 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:49726
2024-02-05T18:17:23,448 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0xcee40651, L:/127.0.0.1:49726 - R:localhost/127.0.0.1:34363] Received unknown request id from server: -1
2024-02-05T18:17:23,448 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xcee40651, L:/127.0.0.1:49726 ! R:localhost/127.0.0.1:34363] Disconnected
2024-02-05T18:17:23,449 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0xcee40651, L:/127.0.0.1:49726 ! R:localhost/127.0.0.1:34363]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:17:23,449 - WARN  - [pulsar-io-64-1:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-24e87d7e77] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:17:23,449 - WARN  - [pulsar-io-64-1:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-24e87d7e77] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 1.578 s
2024-02-05T18:17:23,537 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:38057/__change_events] [reader-9d086a60d0] Reconnecting after connection was closed
2024-02-05T18:17:23,539 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0x5c4499ca, L:/127.0.0.1:49730 - R:localhost/127.0.0.1:34363]] Connected to server
2024-02-05T18:17:23,542 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0x5c4499ca, L:/127.0.0.1:49730 - R:localhost/127.0.0.1:34363] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:17:23,542 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:49730
2024-02-05T18:17:23,542 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0x5c4499ca, L:/127.0.0.1:49730 - R:localhost/127.0.0.1:34363] Received unknown request id from server: -1
2024-02-05T18:17:23,542 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0x5c4499ca, L:/127.0.0.1:49730 ! R:localhost/127.0.0.1:34363] Disconnected
2024-02-05T18:17:23,543 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0x5c4499ca, L:/127.0.0.1:49730 ! R:localhost/127.0.0.1:34363]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:17:23,543 - WARN  - [pulsar-io-64-4:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:38057/__change_events] [reader-9d086a60d0] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:17:23,543 - WARN  - [pulsar-io-64-4:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:38057/__change_events] [reader-9d086a60d0] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 1.588 s
2024-02-05T18:17:23,903 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:17:23,904 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:17:24,904 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:17:24,905 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:17:25,028 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-24e87d7e77] Reconnecting after connection was closed
2024-02-05T18:17:25,029 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0xc5a16339, L:/127.0.0.1:49744 - R:localhost/127.0.0.1:34363]] Connected to server
2024-02-05T18:17:25,032 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0xc5a16339, L:/127.0.0.1:49744 - R:localhost/127.0.0.1:34363] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:17:25,032 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:49744
2024-02-05T18:17:25,033 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0xc5a16339, L:/127.0.0.1:49744 - R:localhost/127.0.0.1:34363] Received unknown request id from server: -1
2024-02-05T18:17:25,033 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0xc5a16339, L:/127.0.0.1:49744 ! R:localhost/127.0.0.1:34363] Disconnected
2024-02-05T18:17:25,033 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0xc5a16339, L:/127.0.0.1:49744 ! R:localhost/127.0.0.1:34363]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:17:25,033 - WARN  - [pulsar-io-64-3:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-24e87d7e77] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:17:25,034 - WARN  - [pulsar-io-64-3:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-24e87d7e77] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 3.192 s
2024-02-05T18:17:25,093 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38057 in 3013.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:17:25,101 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:38057 registry has been deleted.
2024-02-05T18:17:25,101 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:38057 was invalidated. state Releasing
2024-02-05T18:17:25,102 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38057 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:17:25,102 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:38057. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:17:25,104 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:38057
2024-02-05T18:17:25,104 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38057 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:17:25,104 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38057
2024-02-05T18:17:25,105 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38057 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:17:25,114 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:38057/0x00000000_0xffffffff.
2024-02-05T18:17:25,115 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:38057/0x00000000_0xffffffff.
2024-02-05T18:17:25,116 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:38057/0x00000000_0xffffffff.
2024-02-05T18:17:25,116 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.012 seconds
2024-02-05T18:17:25,117 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:17:25,120 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:17:25,121 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:38057/persistent/__change_events] Closing managed ledger
2024-02-05T18:17:25,123 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x81dc736c, L:/127.0.0.1:59026 ! R:localhost/127.0.0.1:34557] Disconnected
2024-02-05T18:17:25,123 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:59026
2024-02-05T18:17:25,123 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x81dc736c, L:/127.0.0.1:59026 ! R:localhost/127.0.0.1:34557] -- Will try again in 0.1 s
2024-02-05T18:17:25,123 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x81dc736c, L:/127.0.0.1:59026 ! R:localhost/127.0.0.1:34557] -- Will try again in 0.1 s
2024-02-05T18:17:25,123 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x81dc736c, L:/127.0.0.1:59026 ! R:localhost/127.0.0.1:34557] -- Will try again in 0.1 s
2024-02-05T18:17:25,123 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-ae853545f4] Closed connection [id: 0x81dc736c, L:/127.0.0.1:59026 ! R:localhost/127.0.0.1:34557] -- Will try again in 0.1 s
2024-02-05T18:17:25,124 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-2c4dbd4a11] Closed connection [id: 0x81dc736c, L:/127.0.0.1:59026 ! R:localhost/127.0.0.1:34557] -- Will try again in 0.1 s
2024-02-05T18:17:25,124 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-ae853545f4}, consumerId=0, consumerName=87143, address=/127.0.0.1:59026}
2024-02-05T18:17:25,124 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-ae853545f4] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-ae853545f4, ackPos=3:5, readPos=3:6}]
2024-02-05T18:17:25,125 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-ae853545f4] Successfully closed dispatcher for reader
2024-02-05T18:17:25,125 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:38057/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:17:25,125 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:17:25,127 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:17:25,127 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-2c4dbd4a11}, consumerId=1, consumerName=4cc70, address=/127.0.0.1:59026}
2024-02-05T18:17:25,128 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:17:25,131 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:38057/__change_events] [reader-9d086a60d0] Reconnecting after connection was closed
2024-02-05T18:17:25,134 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:34363
2024-02-05T18:17:25,135 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:17:25,136 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:17:25,137 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:17:25,137 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-2c4dbd4a11] Closed Consumer (not connected)
2024-02-05T18:17:25,140 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-2c4dbd4a11 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-2c4dbd4a11 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:17:25,141 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:38057/__change_events] [reader-9d086a60d0] Closed Consumer (not connected)
2024-02-05T18:17:25,141 - INFO  - [main:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-24e87d7e77] Closed Consumer (not connected)
2024-02-05T18:17:25,141 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-ae853545f4] Closed Consumer (not connected)
2024-02-05T18:17:25,141 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38057/__change_events with subscription name reader-9d086a60d0 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38057/__change_events with subscription name reader-9d086a60d0 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:17:25,142 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-ae853545f4 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-ae853545f4 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:17:25,148 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:17:25,148 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:17:25,151 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:17:25,152 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:17:25,160 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:17:25,160 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:17:25,422 - WARN  - [pulsar-io-64-3:ConnectionPool@304] - Failed to open connection to localhost/<unresolved>:34363 : java.nio.channels.ClosedChannelException
2024-02-05T18:17:25,423 - WARN  - [pulsar-io-64-3:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:38057/__change_events] [reader-9d086a60d0] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: java.util.concurrent.CompletionException: java.nio.channels.ClosedChannelException
2024-02-05T18:17:25,423 - INFO  - [pulsar-io-64-3:ConnectionHandler@132] - [persistent://sla-monitor/test/localhost:38057/__change_events] [reader-9d086a60d0] Ignoring reconnection request (state: Closed)
2024-02-05T18:17:25,908 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:17:25,909 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38057 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:17:25,909 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38057 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:17:25,909 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:38057]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:17:25,910 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38057
2024-02-05T18:17:25,911 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38057 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:17:26,727 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:17:26,728 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:17:26,729 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:17:26,729 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:17:26,730 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:17:26,730 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:17:26,772 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:17:26,772 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 43.75%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 43.75%, msgThroughputEMA= 0.00, updatedAt= 1707149846771, reportedAt= 0
2024-02-05T18:17:26,910 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:17:26,910 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38057 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:17:26,911 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38057 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:17:26,911 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:38057]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:17:26,911 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38057
2024-02-05T18:17:26,912 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38057 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:17:27,912 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:17:27,912 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38057 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:17:27,913 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38057 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:17:27,913 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 1.0 ms. Scheduled cleanups for inactive brokers:[localhost:38057]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:17:27,913 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38057
2024-02-05T18:17:27,915 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38057 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:17:28,743 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:17:28,745 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:17:28,745 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:17:28,745 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:17:28,746 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@1978b0d5{/static,null,STOPPED}
2024-02-05T18:17:28,746 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,STOPPED}
2024-02-05T18:17:28,748 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/topics,null,STOPPED}
2024-02-05T18:17:28,749 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,STOPPED}
2024-02-05T18:17:28,751 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,STOPPED}
2024-02-05T18:17:28,753 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,STOPPED}
2024-02-05T18:17:28,755 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin,null,STOPPED}
2024-02-05T18:17:28,757 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/,null,STOPPED}
2024-02-05T18:17:28,758 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:17:28,759 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:17:28,760 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:17:28,761 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36039
2024-02-05T18:17:28,763 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:36039, sourceBroker=localhost:38057, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149842081, versionId=5]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:17:33,773 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36039 in 5010.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:17:33,784 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:36039 was invalidated. state Releasing
2024-02-05T18:17:33,784 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:36039. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:17:33,784 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:36039
2024-02-05T18:17:33,787 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:36039/0x00000000_0xffffffff.
2024-02-05T18:17:33,788 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:36039/0x00000000_0xffffffff.
2024-02-05T18:17:33,790 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:36039/0x00000000_0xffffffff.
2024-02-05T18:17:33,797 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36039 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:36039, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149853791, versionId=6]. totalHandledRequests:10
2024-02-05T18:17:33,798 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:17:33,799 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-4d17f0ff02}, consumerId=4, consumerName=4e757, address=/127.0.0.1:59018}
2024-02-05T18:17:33,800 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-4d17f0ff02}, consumerId=4, consumerName=4e757, address=/127.0.0.1:59018}
2024-02-05T18:17:33,800 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:34557] Broker notification of Closed consumer: 4
2024-02-05T18:17:33,800 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-4d17f0ff02] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-4d17f0ff02, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:17:33,800 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-4d17f0ff02] Closed connection [id: 0x62c93efa, L:/127.0.0.1:59018 - R:localhost/127.0.0.1:34557] -- Will try again in 0.1 s
2024-02-05T18:17:33,801 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-4d17f0ff02] Successfully closed dispatcher for reader
2024-02-05T18:17:33,801 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-4d17f0ff02] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-4d17f0ff02, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:17:33,801 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-4d17f0ff02] Successfully disconnected and closed subscription
2024-02-05T18:17:33,801 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:17:33,801 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:17:33,802 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:17:33,803 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:17:33,805 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:17:33,806 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-4d17f0ff02] Closed Consumer (not connected)
2024-02-05T18:17:33,806 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 8.0 ms
2024-02-05T18:17:33,806 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-4d17f0ff02 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-4d17f0ff02 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:17:33,813 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36039 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:36039, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149853798, versionId=7]. totalHandledRequests:4
2024-02-05T18:17:33,813 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:17:33,814 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.029 seconds
2024-02-05T18:17:33,814 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:17:33,815 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x62c93efa, L:/127.0.0.1:59018 ! R:localhost/127.0.0.1:34557] Disconnected
2024-02-05T18:17:33,815 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x62c93efa, L:/127.0.0.1:59018 ! R:localhost/127.0.0.1:34557] -- Will try again in 0.1 s
2024-02-05T18:17:33,816 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x62c93efa, L:/127.0.0.1:59018 ! R:localhost/127.0.0.1:34557] -- Will try again in 0.1 s
2024-02-05T18:17:33,816 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x62c93efa, L:/127.0.0.1:59018 ! R:localhost/127.0.0.1:34557] -- Will try again in 0.1 s
2024-02-05T18:17:33,816 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-910b1ec5ee] Closed connection [id: 0x62c93efa, L:/127.0.0.1:59018 ! R:localhost/127.0.0.1:34557] -- Will try again in 0.1 s
2024-02-05T18:17:33,816 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-d180544db2] Closed connection [id: 0x62c93efa, L:/127.0.0.1:59018 ! R:localhost/127.0.0.1:34557] -- Will try again in 0.1 s
2024-02-05T18:17:33,816 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:36039/__change_events] [reader-9c1f4edf04] Closed connection [id: 0x62c93efa, L:/127.0.0.1:59018 ! R:localhost/127.0.0.1:34557] -- Will try again in 0.1 s
2024-02-05T18:17:33,817 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-41c798c762] Closed connection [id: 0x62c93efa, L:/127.0.0.1:59018 ! R:localhost/127.0.0.1:34557] -- Will try again in 0.1 s
2024-02-05T18:17:33,817 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:59018
2024-02-05T18:17:33,817 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-910b1ec5ee}, consumerId=0, consumerName=98808, address=/127.0.0.1:59018}
2024-02-05T18:17:33,817 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-910b1ec5ee] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-910b1ec5ee, ackPos=3:5, readPos=3:8}]
2024-02-05T18:17:33,817 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-910b1ec5ee] Successfully closed dispatcher for reader
2024-02-05T18:17:33,817 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:17:33,817 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:17:33,818 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:36039/__change_events, name=reader-9c1f4edf04}, consumerId=3, consumerName=542f4, address=/127.0.0.1:59018}
2024-02-05T18:17:33,818 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:36039/__change_events][reader-9c1f4edf04] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:36039/persistent/__change_events, cursor=reader-9c1f4edf04, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:17:33,818 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:36039/__change_events][reader-9c1f4edf04] Successfully closed dispatcher for reader
2024-02-05T18:17:33,818 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:36039/persistent/__change_events] Closing managed ledger
2024-02-05T18:17:33,819 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-41c798c762}, consumerId=2, consumerName=cddba, address=/127.0.0.1:59018}
2024-02-05T18:17:33,820 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-d180544db2}, consumerId=1, consumerName=4c0fc, address=/127.0.0.1:59018}
2024-02-05T18:17:33,821 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:17:33,821 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:36039/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:17:33,822 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:17:33,823 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:17:33,823 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:17:33,827 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:34557
2024-02-05T18:17:33,827 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:17:33,827 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:17:33,827 - ERROR - [main:BrokerLoadDataReporter@191] - Failed to clean broker load data.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The producer test-0-1 of the topic non-persistent://pulsar/system/loadbalancer-broker-load-data was already closed when closing the producers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:708) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ProducerImpl$1.sendComplete(ProducerImpl.java:362) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl$OpSendMsg.sendComplete(ProducerImpl.java:1517) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.lambda$failPendingMessages$18(ProducerImpl.java:2061) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.ArrayDeque.forEach(ArrayDeque.java:888) ~[?:?]
	at org.apache.pulsar.client.impl.ProducerImpl$OpSendMsgQueue.forEach(ProducerImpl.java:1608) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.failPendingMessages(ProducerImpl.java:2051) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.closeAndClearPendingMessages(ProducerImpl.java:1104) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.closeAsync(ProducerImpl.java:1071) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.PulsarClientImpl.lambda$closeAsync$18(PulsarClientImpl.java:744) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ConcurrentHashMap$KeySetView.forEach(ConcurrentHashMap.java:4706) ~[?:?]
	at java.util.Collections$SetFromMap.forEach(Collections.java:5700) ~[?:?]
	at org.apache.pulsar.client.impl.PulsarClientImpl.closeAsync(PulsarClientImpl.java:744) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.PulsarClientImpl.close(PulsarClientImpl.java:720) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.PulsarService.closeAsync(PulsarService.java:532) ~[classes/:?]
	at java.lang.invoke.MethodHandle.invokeWithArguments(MethodHandle.java:732) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor$Dispatcher$ByteBuddy$l4DHOrq3.invokeWithArguments(Unknown Source) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor.invoke(InstrumentationMemberAccessor.java:239) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.util.reflection.ModuleMemberAccessor.invoke(ModuleMemberAccessor.java:55) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.tryInvoke(MockMethodAdvice.java:333) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.access$500(MockMethodAdvice.java:60) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice$RealMethodCall.invoke(MockMethodAdvice.java:253) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.invocation.InterceptedInvocation.callRealMethod(InterceptedInvocation.java:142) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.stubbing.answers.CallsRealMethods.answer(CallsRealMethods.java:45) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.Answers.answer(Answers.java:99) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.MockHandlerImpl.handle(MockHandlerImpl.java:110) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.NullResultGuardian.handle(NullResultGuardian.java:29) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.InvocationNotifierHandler.handle(InvocationNotifierHandler.java:34) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodInterceptor.doIntercept(MockMethodInterceptor.java:82) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.handle(MockMethodAdvice.java:151) ~[mockito-core-3.12.4.jar:?]
	at org.apache.pulsar.broker.PulsarService.closeAsync(PulsarService.java:419) ~[classes/:?]
	at org.apache.pulsar.broker.PulsarService.close(PulsarService.java:398) ~[classes/:?]
	at java.lang.invoke.MethodHandle.invokeWithArguments(MethodHandle.java:732) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor$Dispatcher$ByteBuddy$l4DHOrq3.invokeWithArguments(Unknown Source) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor.invoke(InstrumentationMemberAccessor.java:239) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.util.reflection.ModuleMemberAccessor.invoke(ModuleMemberAccessor.java:55) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.tryInvoke(MockMethodAdvice.java:333) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.access$500(MockMethodAdvice.java:60) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice$RealMethodCall.invoke(MockMethodAdvice.java:253) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.invocation.InterceptedInvocation.callRealMethod(InterceptedInvocation.java:142) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.stubbing.answers.CallsRealMethods.answer(CallsRealMethods.java:45) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.Answers.answer(Answers.java:99) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.MockHandlerImpl.handle(MockHandlerImpl.java:110) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.NullResultGuardian.handle(NullResultGuardian.java:29) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.InvocationNotifierHandler.handle(InvocationNotifierHandler.java:34) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodInterceptor.doIntercept(MockMethodInterceptor.java:82) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.handle(MockMethodAdvice.java:151) ~[mockito-core-3.12.4.jar:?]
	at org.apache.pulsar.broker.PulsarService.close(PulsarService.java:398) ~[classes/:?]
	at org.apache.pulsar.broker.testcontext.PulsarTestContext$StartableCustomBuilder.lambda$initializePulsarServices$0(PulsarTestContext.java:664) ~[test-classes/:?]
	at org.apache.pulsar.broker.testcontext.PulsarTestContext.close(PulsarTestContext.java:194) ~[test-classes/:?]
	at org.apache.pulsar.broker.auth.MockedPulsarServiceBaseTest.internalCleanup(MockedPulsarServiceBaseTest.java:247) ~[test-classes/:?]
	at org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.cleanup(ExtensibleLoadManagerImplTest.java:197) ~[test-classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.testng.internal.invokers.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:139) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.MethodInvocationHelper.invokeMethodConsideringTimeout(MethodInvocationHelper.java:69) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.ConfigInvoker.invokeConfigurationMethod(ConfigInvoker.java:361) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.ConfigInvoker.invokeConfigurations(ConfigInvoker.java:296) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.TestMethodWorker.invokeAfterClassMethods(TestMethodWorker.java:222) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.TestMethodWorker.run(TestMethodWorker.java:131) ~[testng-7.7.1.jar:7.7.1]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at org.testng.TestRunner.privateRun(TestRunner.java:829) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestRunner.run(TestRunner.java:602) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.runTest(SuiteRunner.java:437) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:431) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.privateRun(SuiteRunner.java:391) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.run(SuiteRunner.java:330) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:95) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.runSuitesSequentially(TestNG.java:1256) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.runSuitesLocally(TestNG.java:1176) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.runSuites(TestNG.java:1099) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.run(TestNG.java:1067) ~[testng-7.7.1.jar:7.7.1]
	at org.apache.maven.surefire.testng.TestNGExecutor.run(TestNGExecutor.java:155) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.executeSingleClass(TestNGDirectoryTestSuite.java:102) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.executeLazy(TestNGDirectoryTestSuite.java:117) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.execute(TestNGDirectoryTestSuite.java:86) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGProvider.invoke(TestNGProvider.java:137) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385) ~[surefire-booter-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162) ~[surefire-booter-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507) ~[surefire-booter-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495) ~[surefire-booter-3.1.0.jar:3.1.0]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The producer test-0-1 of the topic non-persistent://pulsar/system/loadbalancer-broker-load-data was already closed when closing the producers
	at org.apache.pulsar.client.impl.ProducerImpl.closeAndClearPendingMessages(ProducerImpl.java:1101) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 76 more
2024-02-05T18:17:33,829 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:17:33,829 - ERROR - [main:TopBundleLoadDataReporter@112] - Failed to clean broker load data.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The producer test-0-2 of the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was already closed when closing the producers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:708) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ProducerImpl$1.sendComplete(ProducerImpl.java:362) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl$OpSendMsg.sendComplete(ProducerImpl.java:1517) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.lambda$failPendingMessages$18(ProducerImpl.java:2061) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.ArrayDeque.forEach(ArrayDeque.java:888) ~[?:?]
	at org.apache.pulsar.client.impl.ProducerImpl$OpSendMsgQueue.forEach(ProducerImpl.java:1608) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.failPendingMessages(ProducerImpl.java:2051) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.closeAndClearPendingMessages(ProducerImpl.java:1104) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.closeAsync(ProducerImpl.java:1071) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.PulsarClientImpl.lambda$closeAsync$18(PulsarClientImpl.java:744) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ConcurrentHashMap$KeySetView.forEach(ConcurrentHashMap.java:4706) ~[?:?]
	at java.util.Collections$SetFromMap.forEach(Collections.java:5700) ~[?:?]
	at org.apache.pulsar.client.impl.PulsarClientImpl.closeAsync(PulsarClientImpl.java:744) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.PulsarClientImpl.close(PulsarClientImpl.java:720) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.PulsarService.closeAsync(PulsarService.java:532) ~[classes/:?]
	at java.lang.invoke.MethodHandle.invokeWithArguments(MethodHandle.java:732) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor$Dispatcher$ByteBuddy$l4DHOrq3.invokeWithArguments(Unknown Source) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor.invoke(InstrumentationMemberAccessor.java:239) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.util.reflection.ModuleMemberAccessor.invoke(ModuleMemberAccessor.java:55) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.tryInvoke(MockMethodAdvice.java:333) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.access$500(MockMethodAdvice.java:60) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice$RealMethodCall.invoke(MockMethodAdvice.java:253) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.invocation.InterceptedInvocation.callRealMethod(InterceptedInvocation.java:142) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.stubbing.answers.CallsRealMethods.answer(CallsRealMethods.java:45) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.Answers.answer(Answers.java:99) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.MockHandlerImpl.handle(MockHandlerImpl.java:110) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.NullResultGuardian.handle(NullResultGuardian.java:29) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.InvocationNotifierHandler.handle(InvocationNotifierHandler.java:34) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodInterceptor.doIntercept(MockMethodInterceptor.java:82) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.handle(MockMethodAdvice.java:151) ~[mockito-core-3.12.4.jar:?]
	at org.apache.pulsar.broker.PulsarService.closeAsync(PulsarService.java:419) ~[classes/:?]
	at org.apache.pulsar.broker.PulsarService.close(PulsarService.java:398) ~[classes/:?]
	at java.lang.invoke.MethodHandle.invokeWithArguments(MethodHandle.java:732) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor$Dispatcher$ByteBuddy$l4DHOrq3.invokeWithArguments(Unknown Source) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor.invoke(InstrumentationMemberAccessor.java:239) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.util.reflection.ModuleMemberAccessor.invoke(ModuleMemberAccessor.java:55) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.tryInvoke(MockMethodAdvice.java:333) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.access$500(MockMethodAdvice.java:60) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice$RealMethodCall.invoke(MockMethodAdvice.java:253) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.invocation.InterceptedInvocation.callRealMethod(InterceptedInvocation.java:142) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.stubbing.answers.CallsRealMethods.answer(CallsRealMethods.java:45) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.Answers.answer(Answers.java:99) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.MockHandlerImpl.handle(MockHandlerImpl.java:110) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.NullResultGuardian.handle(NullResultGuardian.java:29) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.InvocationNotifierHandler.handle(InvocationNotifierHandler.java:34) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodInterceptor.doIntercept(MockMethodInterceptor.java:82) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.handle(MockMethodAdvice.java:151) ~[mockito-core-3.12.4.jar:?]
	at org.apache.pulsar.broker.PulsarService.close(PulsarService.java:398) ~[classes/:?]
	at org.apache.pulsar.broker.testcontext.PulsarTestContext$StartableCustomBuilder.lambda$initializePulsarServices$0(PulsarTestContext.java:664) ~[test-classes/:?]
	at org.apache.pulsar.broker.testcontext.PulsarTestContext.close(PulsarTestContext.java:194) ~[test-classes/:?]
	at org.apache.pulsar.broker.auth.MockedPulsarServiceBaseTest.internalCleanup(MockedPulsarServiceBaseTest.java:247) ~[test-classes/:?]
	at org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.cleanup(ExtensibleLoadManagerImplTest.java:197) ~[test-classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.testng.internal.invokers.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:139) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.MethodInvocationHelper.invokeMethodConsideringTimeout(MethodInvocationHelper.java:69) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.ConfigInvoker.invokeConfigurationMethod(ConfigInvoker.java:361) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.ConfigInvoker.invokeConfigurations(ConfigInvoker.java:296) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.TestMethodWorker.invokeAfterClassMethods(TestMethodWorker.java:222) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.TestMethodWorker.run(TestMethodWorker.java:131) ~[testng-7.7.1.jar:7.7.1]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at org.testng.TestRunner.privateRun(TestRunner.java:829) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestRunner.run(TestRunner.java:602) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.runTest(SuiteRunner.java:437) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:431) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.privateRun(SuiteRunner.java:391) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.run(SuiteRunner.java:330) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:95) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.runSuitesSequentially(TestNG.java:1256) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.runSuitesLocally(TestNG.java:1176) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.runSuites(TestNG.java:1099) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.run(TestNG.java:1067) ~[testng-7.7.1.jar:7.7.1]
	at org.apache.maven.surefire.testng.TestNGExecutor.run(TestNGExecutor.java:155) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.executeSingleClass(TestNGDirectoryTestSuite.java:102) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.executeLazy(TestNGDirectoryTestSuite.java:117) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.execute(TestNGDirectoryTestSuite.java:86) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGProvider.invoke(TestNGProvider.java:137) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385) ~[surefire-booter-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162) ~[surefire-booter-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507) ~[surefire-booter-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495) ~[surefire-booter-3.1.0.jar:3.1.0]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The producer test-0-2 of the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was already closed when closing the producers
	at org.apache.pulsar.client.impl.ProducerImpl.closeAndClearPendingMessages(ProducerImpl.java:1101) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 76 more
2024-02-05T18:17:33,831 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-910b1ec5ee] Closed Consumer (not connected)
2024-02-05T18:17:33,831 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:36039/__change_events] [reader-9c1f4edf04] Closed Consumer (not connected)
2024-02-05T18:17:33,831 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-41c798c762] Closed Consumer (not connected)
2024-02-05T18:17:33,831 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-d180544db2] Closed Consumer (not connected)
2024-02-05T18:17:33,831 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-910b1ec5ee was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-910b1ec5ee was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:17:33,832 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:36039/__change_events with subscription name reader-9c1f4edf04 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:36039/__change_events with subscription name reader-9c1f4edf04 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:17:33,832 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-41c798c762 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-41c798c762 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:17:33,832 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-d180544db2 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-d180544db2 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:17:33,834 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:17:33,835 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:17:33,835 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:17:33,835 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:17:33,835 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:17:33,835 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:17:33,837 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:17:33,837 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:17:35,221 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:17:35,222 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:17:35,223 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:17:35,224 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:17:35,224 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:17:35,224 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:17:35,231 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:17:35,231 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:17:35,235 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:17:35,235 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:17:35,235 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:17:35,235 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:17:35,235 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:17:35,235 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:17:35,235 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:17:35,236 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:17:35,236 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:17:35,236 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 191 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T18:17:35,236 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 8 new threads
2024-02-05T18:17:35,236 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:17:35,236 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@767cacee
2024-02-05T18:17:35,236 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:17:35,236 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:17:35,236 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 37.385 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  01:03 min
[INFO] Finished at: 2024-02-05T18:17:35+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 1 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:18:06,339 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:18:07,337 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:18:07,339 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:18:07,768 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:18:07,769 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:18:07,769 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:18:07,770 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:18:07,771 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:18:07,772 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:18:07,788 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:18:07,789 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:18:07,789 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:18:07,790 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:18:07,791 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:18:07,791 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:18:07,792 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:18:07,792 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:18:07,793 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:18:07,793 - INFO  - [main:Environment@98] - Client environment:os.memory.free=32MB
2024-02-05T18:18:07,794 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:18:07,794 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:18:09,229 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:18:09,230 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:18:09,230 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:18:09,231 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:18:09,564 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:18:09,565 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:18:09,655 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:18:09,737 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:18:09,740 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:18:09,758 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:18:09,850 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:18:09,885 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:18:09,928 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:18:10,279 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:18:10,280 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:18:10,313 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:18:10,358 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:42197, TLS: (none), listener: (none)
2024-02-05T18:18:10,672 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:38951, TLS: OPENSSL, listener: (none)
2024-02-05T18:18:10,693 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:18:10,697 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:18:10,698 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:18:10,728 - INFO  - [main:Log@170] - Logging initialized @6741ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:18:11,521 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:18:11,554 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:18:11,554 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:18:11,556 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:18:12,355 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1978b0d5{/,null,AVAILABLE}
2024-02-05T18:18:13,390 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/admin,null,AVAILABLE}
2024-02-05T18:18:14,704 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,AVAILABLE}
2024-02-05T18:18:15,054 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,AVAILABLE}
2024-02-05T18:18:15,167 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,AVAILABLE}
2024-02-05T18:18:15,320 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/topics,null,AVAILABLE}
2024-02-05T18:18:15,321 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,AVAILABLE}
2024-02-05T18:18:15,324 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6556471b{/static,null,AVAILABLE}
2024-02-05T18:18:15,337 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:39923}
2024-02-05T18:18:15,484 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:42361}
2024-02-05T18:18:15,485 - INFO  - [main:Server@415] - Started @11500ms
2024-02-05T18:18:15,485 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:39923
2024-02-05T18:18:15,486 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:42361
2024-02-05T18:18:15,494 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:18:15,495 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:18:15,651 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:39923
2024-02-05T18:18:15,670 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:18:15,674 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:39923 is changing the role from null to Leader
2024-02-05T18:18:15,677 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:39923).
2024-02-05T18:18:15,935 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:39923 
2024-02-05T18:18:16,382 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:18:16,415 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:18:16,530 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:18:16,536 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:18:16,548 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:18:16,550 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:18:16,596 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:18:16,630 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:18:16,671 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:18:16,740 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:18:16,761 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:18:16,769 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:18:16,772 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:18:16,805 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:18:16,815 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:16 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 586
2024-02-05T18:18:17,009 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x437ca233, L:/127.0.0.1:58510 - R:localhost/127.0.0.1:42197]] Connected to server
2024-02-05T18:18:17,047 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:58510] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:18:17,118 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:18:17,127 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x437ca233, L:/127.0.0.1:58510 - R:localhost/127.0.0.1:42197]
2024-02-05T18:18:17,191 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:18:17,224 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:58510] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:58510, producerName=test-0-0, producerId=0}
2024-02-05T18:18:17,234 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x437ca233, L:/127.0.0.1:58510 - R:localhost/127.0.0.1:42197]
2024-02-05T18:18:17,236 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:18:17,309 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:18:17,312 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f29572f2d5] Subscribing to topic on cnx [id: 0x437ca233, L:/127.0.0.1:58510 - R:localhost/127.0.0.1:42197], consumerId 0
2024-02-05T18:18:17,331 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xbf5a4fc7, L:/127.0.0.1:42197 - R:/127.0.0.1:58510]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-f29572f2d5. consumerId: 0
2024-02-05T18:18:17,367 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f29572f2d5] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:18:17,369 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:18:17,369 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-f29572f2d5, ackPos=3:-1, readPos=3:0}
2024-02-05T18:18:17,394 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:58510] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-f29572f2d5
2024-02-05T18:18:17,400 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f29572f2d5] Subscribed to topic on localhost/127.0.0.1:42197 -- consumer: 0
2024-02-05T18:18:17,415 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.014 seconds
2024-02-05T18:18:17,416 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:18:17,418 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:18:17,418 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:18:17,463 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:18:17,484 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:18:17,486 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:18:17,488 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 56
2024-02-05T18:18:17,488 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:18:17,500 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:18:17,510 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:18:17,511 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:18:17,512 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 20
2024-02-05T18:18:17,513 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:18:17,538 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:18:17,540 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x437ca233, L:/127.0.0.1:58510 - R:localhost/127.0.0.1:42197]
2024-02-05T18:18:17,551 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:18:17,558 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:58510] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:58510, producerName=test-0-1, producerId=1}
2024-02-05T18:18:17,560 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x437ca233, L:/127.0.0.1:58510 - R:localhost/127.0.0.1:42197]
2024-02-05T18:18:17,575 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:18:17,577 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-8594b315fd] Subscribing to topic on cnx [id: 0x437ca233, L:/127.0.0.1:58510 - R:localhost/127.0.0.1:42197], consumerId 1
2024-02-05T18:18:17,579 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xbf5a4fc7, L:/127.0.0.1:42197 - R:/127.0.0.1:58510]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-8594b315fd. consumerId: 1
2024-02-05T18:18:17,606 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-8594b315fd] Created new subscription for 1
2024-02-05T18:18:17,608 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:58510] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-8594b315fd
2024-02-05T18:18:17,609 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-8594b315fd] Subscribed to topic on localhost/127.0.0.1:42197 -- consumer: 1
2024-02-05T18:18:17,628 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:18:17,630 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x437ca233, L:/127.0.0.1:58510 - R:localhost/127.0.0.1:42197]
2024-02-05T18:18:17,636 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:18:17,643 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:58510] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:58510, producerName=test-0-2, producerId=2}
2024-02-05T18:18:17,644 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x437ca233, L:/127.0.0.1:58510 - R:localhost/127.0.0.1:42197]
2024-02-05T18:18:17,663 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:18:17,694 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:18:17,700 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:39923 started the ownership monitor.
2024-02-05T18:18:17,717 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:18:17,719 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-b216b37890] Subscribing to topic on cnx [id: 0x437ca233, L:/127.0.0.1:58510 - R:localhost/127.0.0.1:42197], consumerId 2
2024-02-05T18:18:17,722 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xbf5a4fc7, L:/127.0.0.1:42197 - R:/127.0.0.1:58510]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-b216b37890. consumerId: 2
2024-02-05T18:18:17,734 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-b216b37890] Created new subscription for 2
2024-02-05T18:18:17,734 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:58510] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-b216b37890
2024-02-05T18:18:17,735 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-b216b37890] Subscribed to topic on localhost/127.0.0.1:42197 -- consumer: 2
2024-02-05T18:18:17,736 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:39923 plays the leader now.
2024-02-05T18:18:17,741 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.71%, directMemory= 2.73%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 2.73%, weightedMaxEMA= 53.71%, msgThroughputEMA= 0.00, updatedAt= 1707149897740, reportedAt= 0
2024-02-05T18:18:17,748 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:39923/__change_events
2024-02-05T18:18:17,771 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:18:17,776 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:18:17,777 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:18:17,831 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:39923/0x00000000_0xffffffff - localhost:39923.
2024-02-05T18:18:17,834 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:39923
2024-02-05T18:18:17,834 - INFO  - [pulsar-7-4:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:39923/0x00000000_0xffffffff
2024-02-05T18:18:17,835 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:39923/0x00000000_0xffffffff - localhost:39923.
2024-02-05T18:18:17,836 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:39923
2024-02-05T18:18:17,837 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:39923/0x00000000_0xffffffff
2024-02-05T18:18:17,846 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:39923/__change_events][reader-13db631d44] Subscribing to topic on cnx [id: 0x437ca233, L:/127.0.0.1:58510 - R:localhost/127.0.0.1:42197], consumerId 3
2024-02-05T18:18:17,849 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xbf5a4fc7, L:/127.0.0.1:42197 - R:/127.0.0.1:58510]] Subscribing on topic persistent://sla-monitor/test/localhost:39923/__change_events / reader-13db631d44. consumerId: 3
2024-02-05T18:18:17,850 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:39923 doesn't exist.
2024-02-05T18:18:17,864 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:39923/persistent/__change_events
2024-02-05T18:18:17,866 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:39923/persistent/__change_events'
2024-02-05T18:18:17,871 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:18:17,872 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:39923/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:18:17,880 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:39923/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:18:17,886 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:39923/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:18:17,888 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:39923/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:39923/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:18:17,889 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:39923/__change_events - dedup is disabled
2024-02-05T18:18:17,902 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:18:17,912 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:39923/__change_events][reader-13db631d44] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:18:17,912 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:39923/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:18:17,912 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:39923/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:39923/persistent/__change_events, cursor=reader-13db631d44, ackPos=7:-1, readPos=7:0}
2024-02-05T18:18:17,914 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:58510] Created subscription on topic persistent://sla-monitor/test/localhost:39923/__change_events / reader-13db631d44
2024-02-05T18:18:17,916 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:39923/__change_events][reader-13db631d44] Subscribed to topic on localhost/127.0.0.1:42197 -- consumer: 3
2024-02-05T18:18:17,868 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 39923, tls-port = Optional[42361], broker url= pulsar://localhost:42197, broker tls url= pulsar+ssl://localhost:38951, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[42197], brokerServicePortTls=Optional[38951], webServicePort=Optional[39923], webServicePortTls=Optional[42361], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:18:18,537 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:18:18,538 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:18:18,538 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:18:18,538 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:18:18,544 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:18:18,544 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:18:18,550 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:18:18,555 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:18:18,563 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:18:18,564 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:18:18,570 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:18:18,577 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:18:18,580 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:18:18,589 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:18:18,589 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:18:18,597 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:18:18,601 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:42911, TLS: (none), listener: (none)
2024-02-05T18:18:18,602 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:40435, TLS: OPENSSL, listener: (none)
2024-02-05T18:18:18,604 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:18:18,605 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:18:18,605 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:18:18,616 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:18:18,619 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:18:18,619 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:18:18,619 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:18:18,726 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7537f638{/,null,AVAILABLE}
2024-02-05T18:18:18,778 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:18:18,779 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:18:19,393 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/admin,null,AVAILABLE}
2024-02-05T18:18:19,781 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:18:19,782 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:18:20,539 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/admin/v2,null,AVAILABLE}
2024-02-05T18:18:20,780 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin/v3,null,AVAILABLE}
2024-02-05T18:18:20,783 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:18:20,783 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:18:20,836 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/lookup,null,AVAILABLE}
2024-02-05T18:18:20,914 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/topics,null,AVAILABLE}
2024-02-05T18:18:20,915 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@554f6e30{/metrics,null,AVAILABLE}
2024-02-05T18:18:20,915 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@4a842e8a{/static,null,AVAILABLE}
2024-02-05T18:18:20,917 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@60a98fa6{HTTP/1.1, (http/1.1)}{0.0.0.0:43735}
2024-02-05T18:18:20,931 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@1de78f97{SSL, (ssl, http/1.1)}{0.0.0.0:44521}
2024-02-05T18:18:20,931 - INFO  - [main:Server@415] - Started @16946ms
2024-02-05T18:18:20,931 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:43735
2024-02-05T18:18:20,934 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:44521
2024-02-05T18:18:20,936 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:18:20,937 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:18:20,947 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:43735
2024-02-05T18:18:20,947 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:43735 registry has been created.
2024-02-05T18:18:20,948 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:43735. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:18:20,952 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:43735 is changing the role from null to Follower
2024-02-05T18:18:20,956 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:39923).
2024-02-05T18:18:20,962 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:18:20,976 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:43735 
2024-02-05T18:18:21,091 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:21 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 45
2024-02-05T18:18:21,110 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:18:21,112 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:18:21,113 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:18:21,126 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:21 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 31
2024-02-05T18:18:21,129 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:43735/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:18:21,141 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x816358e2, L:/127.0.0.1:56058 - R:localhost/127.0.0.1:42911]] Connected to server
2024-02-05T18:18:21,147 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:56058] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:18:21,166 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xb1c23b94, L:/127.0.0.1:55260 - R:localhost/127.0.0.1:42197]] Connected to server
2024-02-05T18:18:21,171 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:55260] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:18:21,173 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xb1c23b94, L:/127.0.0.1:55260 - R:localhost/127.0.0.1:42197]
2024-02-05T18:18:21,184 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:55260] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:55260, producerName=test-0-3, producerId=0}
2024-02-05T18:18:21,185 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0xb1c23b94, L:/127.0.0.1:55260 - R:localhost/127.0.0.1:42197]
2024-02-05T18:18:21,198 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-14b5b96618] Subscribing to topic on cnx [id: 0xb1c23b94, L:/127.0.0.1:55260 - R:localhost/127.0.0.1:42197], consumerId 0
2024-02-05T18:18:21,200 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xc182795f, L:/127.0.0.1:42197 - R:/127.0.0.1:55260]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-14b5b96618. consumerId: 0
2024-02-05T18:18:21,205 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-14b5b96618] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:18:21,206 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:18:21,206 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-14b5b96618, ackPos=3:-1, readPos=3:0}
2024-02-05T18:18:21,208 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:55260] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-14b5b96618
2024-02-05T18:18:21,209 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-14b5b96618] Subscribed to topic on localhost/127.0.0.1:42197 -- consumer: 0
2024-02-05T18:18:21,212 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:18:21,213 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:18:21,233 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 16
2024-02-05T18:18:21,241 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:18:21,244 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:18:21,244 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:18:21,248 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:18:21,249 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:43735/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:18:21,261 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 7
2024-02-05T18:18:21,268 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:18:21,272 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:18:21,272 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:18:21,276 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:18:21,276 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:43735/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:18:21,293 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xb1c23b94, L:/127.0.0.1:55260 - R:localhost/127.0.0.1:42197]
2024-02-05T18:18:21,301 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:55260] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:55260, producerName=test-0-4, producerId=1}
2024-02-05T18:18:21,302 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0xb1c23b94, L:/127.0.0.1:55260 - R:localhost/127.0.0.1:42197]
2024-02-05T18:18:21,316 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d92c0d2671] Subscribing to topic on cnx [id: 0xb1c23b94, L:/127.0.0.1:55260 - R:localhost/127.0.0.1:42197], consumerId 1
2024-02-05T18:18:21,318 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xc182795f, L:/127.0.0.1:42197 - R:/127.0.0.1:55260]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-d92c0d2671. consumerId: 1
2024-02-05T18:18:21,331 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d92c0d2671] Created new subscription for 1
2024-02-05T18:18:21,331 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:55260] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-d92c0d2671
2024-02-05T18:18:21,332 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d92c0d2671] Subscribed to topic on localhost/127.0.0.1:42197 -- consumer: 1
2024-02-05T18:18:21,347 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xb1c23b94, L:/127.0.0.1:55260 - R:localhost/127.0.0.1:42197]
2024-02-05T18:18:21,354 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:55260] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:55260, producerName=test-0-5, producerId=2}
2024-02-05T18:18:21,356 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0xb1c23b94, L:/127.0.0.1:55260 - R:localhost/127.0.0.1:42197]
2024-02-05T18:18:21,358 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:18:21,362 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:18:21,363 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:43735 plays a follower now.
2024-02-05T18:18:21,397 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:43735/__change_events
2024-02-05T18:18:21,420 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:43735/0x00000000_0xffffffff - localhost:43735.
2024-02-05T18:18:21,421 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:43735
2024-02-05T18:18:21,421 - INFO  - [pulsar-62-3:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:43735/0x00000000_0xffffffff
2024-02-05T18:18:21,422 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:43735/0x00000000_0xffffffff - localhost:43735.
2024-02-05T18:18:21,424 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:43735
2024-02-05T18:18:21,424 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:43735/0x00000000_0xffffffff
2024-02-05T18:18:21,427 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:43735 doesn't exist.
2024-02-05T18:18:21,429 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:43735/__change_events][reader-6db117d0b6] Subscribing to topic on cnx [id: 0x816358e2, L:/127.0.0.1:56058 - R:localhost/127.0.0.1:42911], consumerId 2
2024-02-05T18:18:21,429 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=2, bootstrap service port = 43735, tls-port = Optional[44521], broker url= pulsar://localhost:42911, broker tls url= pulsar+ssl://localhost:40435, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[42911], brokerServicePortTls=Optional[40435], webServicePort=Optional[43735], webServicePortTls=Optional[44521], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:18:21,432 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x93fe9c62, L:/127.0.0.1:42911 - R:/127.0.0.1:56058]] Subscribing on topic persistent://sla-monitor/test/localhost:43735/__change_events / reader-6db117d0b6. consumerId: 2
2024-02-05T18:18:21,443 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:43735/persistent/__change_events
2024-02-05T18:18:21,445 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:43735/persistent/__change_events'
2024-02-05T18:18:21,455 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:18:21,456 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:43735/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:18:21,460 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:43735/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:18:21,465 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:43735/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:18:21,475 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:43735/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:43735/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:18:21,476 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:43735/__change_events - dedup is disabled
2024-02-05T18:18:21,544 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:18:21,557 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:43735/__change_events][reader-6db117d0b6] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:18:21,558 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:43735/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:18:21,558 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:43735/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:43735/persistent/__change_events, cursor=reader-6db117d0b6, ackPos=9:-1, readPos=9:0}
2024-02-05T18:18:21,560 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:56058] Created subscription on topic persistent://sla-monitor/test/localhost:43735/__change_events / reader-6db117d0b6
2024-02-05T18:18:21,563 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:43735/__change_events][reader-6db117d0b6] Subscribed to topic on localhost/127.0.0.1:42911 -- consumer: 2
2024-02-05T18:18:21,615 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:18:21,617 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:21 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:18:21,645 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:18:21,646 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:21 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:18:21,670 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:18:21,670 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:18:21,675 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:18:21,677 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:21 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T18:18:21,701 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:18:21,701 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:18:21,702 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:18:21,703 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:18:21,703 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:21 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 21
2024-02-05T18:18:21,705 - INFO  - [pulsar-7-5:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:18:21,715 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:18:21,716 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:18:21,721 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:18:21,722 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:21 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:18:21,736 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:18:21,737 - INFO  - [pulsar-62-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:18:21,739 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:18:21,740 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:18:21,741 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:21 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:18:21,744 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:18:21,784 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:18:21,784 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:18:21,785 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:18:21,795 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:18:21,796 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:18:21,810 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:18:21,821 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:18:21,838 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:43735 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:18:21,883 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39923 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:43735, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149901840, versionId=1]. totalHandledRequests:1
2024-02-05T18:18:21,902 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39923 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:43735, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149901883, versionId=2]. totalHandledRequests:1
2024-02-05T18:18:21,903 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:18:21,905 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:18:21,919 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:21 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 112
2024-02-05T18:18:21,934 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:18:21,945 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-2d20ef052f] Subscribing to topic on cnx [id: 0x816358e2, L:/127.0.0.1:56058 - R:localhost/127.0.0.1:42911], consumerId 3
2024-02-05T18:18:21,956 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x93fe9c62, L:/127.0.0.1:42911 - R:/127.0.0.1:56058]] Subscribing on topic persistent://public/test/__change_events / reader-2d20ef052f. consumerId: 3
2024-02-05T18:18:21,973 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39923 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:43735, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149901963, versionId=3]. totalHandledRequests:1
2024-02-05T18:18:21,976 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:18:21,976 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:18:21,978 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:18:21,981 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:18:21,982 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:18:21,990 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:18:21,996 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:18:21,997 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:18:22,000 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:18:22,002 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:18:22,002 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:18:22,004 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:18:22,014 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:18:22,014 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:18:22,020 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:18:22,023 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 49.0 ms
2024-02-05T18:18:22,034 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39923 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:43735, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149901974, versionId=4]. totalHandledRequests:1
2024-02-05T18:18:22,035 - WARN  - [broker-client-shared-internal-executor-65-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:43735. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:18:22,035 - WARN  - [broker-client-shared-internal-executor-65-1:ServerCnx@1299] - [/127.0.0.1:56058][persistent://public/test/__change_events][reader-2d20ef052f] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:43735. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:18:22,038 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x816358e2, L:/127.0.0.1:56058 - R:localhost/127.0.0.1:42911] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:43735. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:18:22,039 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:18:22,040 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:18:22,041 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-2d20ef052f] Failed to subscribe to topic on localhost/127.0.0.1:42911
2024-02-05T18:18:22,041 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:21 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 115
2024-02-05T18:18:22,042 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-2d20ef052f] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:43735. Please redo the lookup. Request is denied: namespace=public/test","reqId":4186014483654978176, "remote":"localhost/127.0.0.1:42911", "local":"/127.0.0.1:56058"}
2024-02-05T18:18:22,042 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-2d20ef052f] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:43735. Please redo the lookup. Request is denied: namespace=public/test","reqId":4186014483654978176, "remote":"localhost/127.0.0.1:42911", "local":"/127.0.0.1:56058"} -- Will try again in 0.1 s
2024-02-05T18:18:22,042 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:18:22,044 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:18:21 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 262
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@790fa53], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@790fa53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@790fa53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@875b318], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58bd9952] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@790fa53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@875b318, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2347d83c], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58bd9952, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17550081] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@790fa53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@875b318, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2347d83c, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@329d9c00], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58bd9952, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17550081, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@65ee408] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@790fa53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@875b318, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2347d83c, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@329d9c00, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1bc54ac7], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58bd9952, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17550081, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@65ee408, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@242b0036] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@790fa53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@875b318, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2347d83c, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@329d9c00, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1bc54ac7, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7a88e52f], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58bd9952, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17550081, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@65ee408, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@242b0036, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8720d2] 
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:18:22,144 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-2d20ef052f] Reconnecting after connection was closed
2024-02-05T18:18:22,152 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:43735. Skipping this broker. Phase one
2024-02-05T18:18:22,153 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:39923. Skipping this broker. Phase one
2024-02-05T18:18:22,153 - INFO  - [configuration-metadata-store-59-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:43735 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:18:22,155 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:18:22,161 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39923 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:43735, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149902153, versionId=5]. totalHandledRequests:8
2024-02-05T18:18:22,163 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@60a98fa6{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:18:22,164 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@1de78f97{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:18:22,164 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:18:22,165 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@4a842e8a{/static,null,STOPPED}
2024-02-05T18:18:22,166 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@554f6e30{/metrics,null,STOPPED}
2024-02-05T18:18:22,172 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39923 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:43735, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149902162, versionId=6]. totalHandledRequests:6
2024-02-05T18:18:22,176 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-2d20ef052f] Subscribing to topic on cnx [id: 0x816358e2, L:/127.0.0.1:56058 - R:localhost/127.0.0.1:42911], consumerId 3
2024-02-05T18:18:22,176 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:18:22,177 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x93fe9c62, L:/127.0.0.1:42911 - R:/127.0.0.1:56058]] Subscribing on topic persistent://public/test/__change_events / reader-2d20ef052f. consumerId: 3
2024-02-05T18:18:22,178 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/topics,null,STOPPED}
2024-02-05T18:18:22,181 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/lookup,null,STOPPED}
2024-02-05T18:18:22,183 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin/v3,null,STOPPED}
2024-02-05T18:18:22,185 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/admin/v2,null,STOPPED}
2024-02-05T18:18:22,187 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:18:22,188 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/admin,null,STOPPED}
2024-02-05T18:18:22,190 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7537f638{/,null,STOPPED}
2024-02-05T18:18:22,194 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:18:22,194 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:18:22,195 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:18:22,203 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:18:22,203 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:18:22,205 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:18:22,206 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:18:22,207 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:18:22,210 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:43735
2024-02-05T18:18:22,210 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:18:22,211 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:18:22,211 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:18:22,213 - WARN  - [ForkJoinPool.commonPool-worker-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:39923. Skipping this broker. Phase one
2024-02-05T18:18:22,214 - ERROR - [pulsar-io-64-2:ClientCnx@1196] - [id: 0x816358e2, L:/127.0.0.1:56058 - R:localhost/127.0.0.1:42911] Close connection because received internal-server error {"errorMsg":"Failed due to pulsar service is not ready","reqId":4186014483654978179, "remote":"localhost/127.0.0.1:42911", "local":"/127.0.0.1:56058"}
2024-02-05T18:18:22,214 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:43735, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149902162, versionId=6] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:39923, sourceBroker=localhost:43735, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149902214, versionId=7]
2024-02-05T18:18:22,214 - WARN  - [pulsar-io-64-2:BinaryProtoLookupService@234] - [persistent://public/test/__change_events] failed to get Partitioned metadata : {"errorMsg":"Failed due to pulsar service is not ready","reqId":4186014483654978179, "remote":"localhost/127.0.0.1:42911", "local":"/127.0.0.1:56058"}
org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":4186014483654978179, "remote":"localhost/127.0.0.1:42911", "local":"/127.0.0.1:56058"}
	at org.apache.pulsar.client.impl.ClientCnx.getPulsarClientException(ClientCnx.java:1282) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ClientCnx.handlePartitionResponse(ClientCnx.java:662) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.common.protocol.PulsarDecoder.channelRead(PulsarDecoder.java:144) ~[pulsar-common-3.0.2.jar:3.0.2]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[netty-codec-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[netty-codec-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.flush.FlushConsolidationHandler.channelRead(FlushConsolidationHandler.java:152) ~[netty-handler-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:800) ~[netty-transport-classes-epoll-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:509) ~[netty-transport-classes-epoll-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:407) ~[netty-transport-classes-epoll-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
2024-02-05T18:18:22,217 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:18:22,218 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:56058
2024-02-05T18:18:22,219 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:43735/__change_events, name=reader-6db117d0b6}, consumerId=2, consumerName=133d1, address=/127.0.0.1:56058}
2024-02-05T18:18:22,220 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:43735/__change_events][reader-6db117d0b6] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:43735/persistent/__change_events, cursor=reader-6db117d0b6, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:18:22,223 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39923 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:39923, sourceBroker=localhost:43735, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149902214, versionId=7]. totalHandledRequests:7
2024-02-05T18:18:22,224 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x816358e2, L:/127.0.0.1:56058 ! R:localhost/127.0.0.1:42911] Disconnected
2024-02-05T18:18:22,224 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:18:22,225 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:18:22,225 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:39923 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:39923, sourceBroker=localhost:43735, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149902214, versionId=7], next:, totalHandledRequests:7, totalFailedRequests:6
2024-02-05T18:18:22,225 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:18:22,225 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:18:22,226 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:18:22,227 - WARN  - [PulsarTestContext-executor-OrderedExecutor-0-0:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:43735. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:18:22,227 - WARN  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1299] - [/127.0.0.1:56058][persistent://public/test/__change_events][reader-2d20ef052f] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:43735. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:18:22,225 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-2d20ef052f] Failed to subscribe to topic on localhost/127.0.0.1:42911
2024-02-05T18:18:22,228 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-2d20ef052f] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$ConnectException: Disconnected from server at localhost/127.0.0.1:42911
2024-02-05T18:18:22,229 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-2d20ef052f] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$ConnectException: Disconnected from server at localhost/127.0.0.1:42911 -- Will try again in 0.194 s
2024-02-05T18:18:22,230 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:43735/__change_events] [reader-6db117d0b6] Closed connection [id: 0x816358e2, L:/127.0.0.1:56058 ! R:localhost/127.0.0.1:42911] -- Will try again in 0.1 s
2024-02-05T18:18:22,230 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:18:22,232 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:18:22,233 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:18:22,221 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:43735/__change_events][reader-6db117d0b6] Successfully closed dispatcher for reader
2024-02-05T18:18:22,235 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:18:22,236 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 12.0 ms
2024-02-05T18:18:22,265 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:18:22,267 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-b2868e4b77] Subscribing to topic on cnx [id: 0x437ca233, L:/127.0.0.1:58510 - R:localhost/127.0.0.1:42197], consumerId 4
2024-02-05T18:18:22,269 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xbf5a4fc7, L:/127.0.0.1:42197 - R:/127.0.0.1:58510]] Subscribing on topic persistent://public/test/__change_events / reader-b2868e4b77. consumerId: 4
2024-02-05T18:18:22,276 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:18:22,282 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 14
2024-02-05T18:18:22,283 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 14 after closed null
2024-02-05T18:18:22,286 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=13 rc=0
2024-02-05T18:18:22,290 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:18:22,290 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:18:22,295 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 14:-1
2024-02-05T18:18:22,295 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=14:-1 -- todo=0
2024-02-05T18:18:22,295 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:18:22,299 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:18:22,308 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-b2868e4b77] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:18:22,309 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=14:0 mark-delete-position=14:-1
2024-02-05T18:18:22,309 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-b2868e4b77, ackPos=14:-1, readPos=14:0}
2024-02-05T18:18:22,311 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:58510] Created subscription on topic persistent://public/test/__change_events / reader-b2868e4b77
2024-02-05T18:18:22,312 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-b2868e4b77] Subscribed to topic on localhost/127.0.0.1:42197 -- consumer: 4
2024-02-05T18:18:22,316 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 100 ms
2024-02-05T18:18:22,318 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0x2c3053e9, L:/127.0.0.1:56060 - R:localhost/127.0.0.1:42911]] Connected to server
2024-02-05T18:18:22,322 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0x2c3053e9, L:/127.0.0.1:56060 - R:localhost/127.0.0.1:42911] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:18:22,322 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0x2c3053e9, L:/127.0.0.1:56060 - R:localhost/127.0.0.1:42911] Received unknown request id from server: -1
2024-02-05T18:18:22,322 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:56060
2024-02-05T18:18:22,323 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0x2c3053e9, L:/127.0.0.1:56060 ! R:localhost/127.0.0.1:42911] Disconnected
2024-02-05T18:18:22,323 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0x2c3053e9, L:/127.0.0.1:56060 ! R:localhost/127.0.0.1:42911]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:22,334 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://sla-monitor/test/localhost:43735/__change_events] [reader-6db117d0b6] Reconnecting after timeout
2024-02-05T18:18:22,336 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xdb454766, L:/127.0.0.1:56072 - R:localhost/127.0.0.1:42911]] Connected to server
2024-02-05T18:18:22,339 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0xdb454766, L:/127.0.0.1:56072 - R:localhost/127.0.0.1:42911] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:18:22,339 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0xdb454766, L:/127.0.0.1:56072 - R:localhost/127.0.0.1:42911] Received unknown request id from server: -1
2024-02-05T18:18:22,340 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xdb454766, L:/127.0.0.1:56072 ! R:localhost/127.0.0.1:42911] Disconnected
2024-02-05T18:18:22,340 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0xdb454766, L:/127.0.0.1:56072 ! R:localhost/127.0.0.1:42911]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:22,341 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:43735/__change_events] [reader-6db117d0b6] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:22,341 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:43735/__change_events] [reader-6db117d0b6] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.189 s
2024-02-05T18:18:22,341 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:56072
2024-02-05T18:18:22,424 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-2d20ef052f] Reconnecting after connection was closed
2024-02-05T18:18:22,425 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x56b514db, L:/127.0.0.1:56086 - R:localhost/127.0.0.1:42911]] Connected to server
2024-02-05T18:18:22,428 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0x56b514db, L:/127.0.0.1:56086 - R:localhost/127.0.0.1:42911] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:18:22,428 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:56086
2024-02-05T18:18:22,428 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0x56b514db, L:/127.0.0.1:56086 - R:localhost/127.0.0.1:42911] Received unknown request id from server: -1
2024-02-05T18:18:22,429 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x56b514db, L:/127.0.0.1:56086 ! R:localhost/127.0.0.1:42911] Disconnected
2024-02-05T18:18:22,429 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0x56b514db, L:/127.0.0.1:56086 ! R:localhost/127.0.0.1:42911]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:22,429 - WARN  - [pulsar-io-64-1:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-2d20ef052f] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:22,429 - WARN  - [pulsar-io-64-1:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-2d20ef052f] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.382 s
2024-02-05T18:18:22,513 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 189 ms
2024-02-05T18:18:22,514 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0x6fb795e1, L:/127.0.0.1:56102 - R:localhost/127.0.0.1:42911]] Connected to server
2024-02-05T18:18:22,517 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0x6fb795e1, L:/127.0.0.1:56102 - R:localhost/127.0.0.1:42911] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:18:22,517 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:56102
2024-02-05T18:18:22,517 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0x6fb795e1, L:/127.0.0.1:56102 - R:localhost/127.0.0.1:42911] Received unknown request id from server: -1
2024-02-05T18:18:22,518 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0x6fb795e1, L:/127.0.0.1:56102 ! R:localhost/127.0.0.1:42911] Disconnected
2024-02-05T18:18:22,518 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0x6fb795e1, L:/127.0.0.1:56102 ! R:localhost/127.0.0.1:42911]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:22,531 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:43735/__change_events] [reader-6db117d0b6] Reconnecting after connection was closed
2024-02-05T18:18:22,532 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0x04905b1d, L:/127.0.0.1:56104 - R:localhost/127.0.0.1:42911]] Connected to server
2024-02-05T18:18:22,534 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0x04905b1d, L:/127.0.0.1:56104 - R:localhost/127.0.0.1:42911] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:18:22,534 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:56104
2024-02-05T18:18:22,534 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0x04905b1d, L:/127.0.0.1:56104 - R:localhost/127.0.0.1:42911] Received unknown request id from server: -1
2024-02-05T18:18:22,534 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0x04905b1d, L:/127.0.0.1:56104 ! R:localhost/127.0.0.1:42911] Disconnected
2024-02-05T18:18:22,535 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0x04905b1d, L:/127.0.0.1:56104 ! R:localhost/127.0.0.1:42911]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:22,535 - WARN  - [pulsar-io-64-3:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:43735/__change_events] [reader-6db117d0b6] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:22,535 - WARN  - [pulsar-io-64-3:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:43735/__change_events] [reader-6db117d0b6] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.384 s
2024-02-05T18:18:22,688 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:18:22,688 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 44.14%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 44.14%, msgThroughputEMA= 0.00, updatedAt= 1707149902687, reportedAt= 0
2024-02-05T18:18:22,785 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:18:22,786 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:18:22,813 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-2d20ef052f] Reconnecting after connection was closed
2024-02-05T18:18:22,814 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x2a2c6260, L:/127.0.0.1:56106 - R:localhost/127.0.0.1:42911]] Connected to server
2024-02-05T18:18:22,817 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:56106
2024-02-05T18:18:22,817 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x2a2c6260, L:/127.0.0.1:56106 - R:localhost/127.0.0.1:42911] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:18:22,817 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0x2a2c6260, L:/127.0.0.1:56106 - R:localhost/127.0.0.1:42911] Received unknown request id from server: -1
2024-02-05T18:18:22,817 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x2a2c6260, L:/127.0.0.1:56106 ! R:localhost/127.0.0.1:42911] Disconnected
2024-02-05T18:18:22,817 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0x2a2c6260, L:/127.0.0.1:56106 ! R:localhost/127.0.0.1:42911]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:22,818 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-2d20ef052f] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:22,818 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-2d20ef052f] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.779 s
2024-02-05T18:18:22,906 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 388 ms
2024-02-05T18:18:22,908 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x1e738a5c, L:/127.0.0.1:56120 - R:localhost/127.0.0.1:42911]] Connected to server
2024-02-05T18:18:22,910 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:56120
2024-02-05T18:18:22,911 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0x1e738a5c, L:/127.0.0.1:56120 - R:localhost/127.0.0.1:42911] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:18:22,911 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0x1e738a5c, L:/127.0.0.1:56120 - R:localhost/127.0.0.1:42911] Received unknown request id from server: -1
2024-02-05T18:18:22,912 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x1e738a5c, L:/127.0.0.1:56120 ! R:localhost/127.0.0.1:42911] Disconnected
2024-02-05T18:18:22,912 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0x1e738a5c, L:/127.0.0.1:56120 ! R:localhost/127.0.0.1:42911]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:22,921 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:43735/__change_events] [reader-6db117d0b6] Reconnecting after connection was closed
2024-02-05T18:18:22,922 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0x029c9d68, L:/127.0.0.1:56130 - R:localhost/127.0.0.1:42911]] Connected to server
2024-02-05T18:18:22,924 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0x029c9d68, L:/127.0.0.1:56130 - R:localhost/127.0.0.1:42911] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:18:22,924 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:56130
2024-02-05T18:18:22,924 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0x029c9d68, L:/127.0.0.1:56130 - R:localhost/127.0.0.1:42911] Received unknown request id from server: -1
2024-02-05T18:18:22,925 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0x029c9d68, L:/127.0.0.1:56130 ! R:localhost/127.0.0.1:42911] Disconnected
2024-02-05T18:18:22,925 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0x029c9d68, L:/127.0.0.1:56130 ! R:localhost/127.0.0.1:42911]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:22,926 - WARN  - [pulsar-io-64-4:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:43735/__change_events] [reader-6db117d0b6] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:22,926 - WARN  - [pulsar-io-64-4:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:43735/__change_events] [reader-6db117d0b6] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.726 s
2024-02-05T18:18:23,598 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-2d20ef052f] Reconnecting after connection was closed
2024-02-05T18:18:23,600 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0x70ed813a, L:/127.0.0.1:56140 - R:localhost/127.0.0.1:42911]] Connected to server
2024-02-05T18:18:23,602 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:56140
2024-02-05T18:18:23,602 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0x70ed813a, L:/127.0.0.1:56140 - R:localhost/127.0.0.1:42911] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:18:23,603 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0x70ed813a, L:/127.0.0.1:56140 - R:localhost/127.0.0.1:42911] Received unknown request id from server: -1
2024-02-05T18:18:23,603 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0x70ed813a, L:/127.0.0.1:56140 ! R:localhost/127.0.0.1:42911] Disconnected
2024-02-05T18:18:23,603 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0x70ed813a, L:/127.0.0.1:56140 ! R:localhost/127.0.0.1:42911]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:23,603 - WARN  - [pulsar-io-64-3:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-2d20ef052f] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:23,604 - WARN  - [pulsar-io-64-3:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-2d20ef052f] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 1.486 s
2024-02-05T18:18:23,654 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:43735/__change_events] [reader-6db117d0b6] Reconnecting after connection was closed
2024-02-05T18:18:23,656 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xffa72188, L:/127.0.0.1:56146 - R:localhost/127.0.0.1:42911]] Connected to server
2024-02-05T18:18:23,656 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 744 ms
2024-02-05T18:18:23,658 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0xffa72188, L:/127.0.0.1:56146 - R:localhost/127.0.0.1:42911] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:18:23,658 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:56146
2024-02-05T18:18:23,659 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0xffa72188, L:/127.0.0.1:56146 - R:localhost/127.0.0.1:42911] Received unknown request id from server: -1
2024-02-05T18:18:23,659 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xffa72188, L:/127.0.0.1:56146 ! R:localhost/127.0.0.1:42911] Disconnected
2024-02-05T18:18:23,659 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0xffa72188, L:/127.0.0.1:56146 ! R:localhost/127.0.0.1:42911]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:23,660 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:43735/__change_events] [reader-6db117d0b6] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:23,660 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:43735/__change_events] [reader-6db117d0b6] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 1.532 s
2024-02-05T18:18:23,786 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:18:23,787 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:18:24,787 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:18:24,788 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:18:25,091 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-2d20ef052f] Reconnecting after connection was closed
2024-02-05T18:18:25,093 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x263828b5, L:/127.0.0.1:56152 - R:localhost/127.0.0.1:42911]] Connected to server
2024-02-05T18:18:25,095 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:56152
2024-02-05T18:18:25,095 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0x263828b5, L:/127.0.0.1:56152 - R:localhost/127.0.0.1:42911] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:18:25,095 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0x263828b5, L:/127.0.0.1:56152 - R:localhost/127.0.0.1:42911] Received unknown request id from server: -1
2024-02-05T18:18:25,095 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x263828b5, L:/127.0.0.1:56152 ! R:localhost/127.0.0.1:42911] Disconnected
2024-02-05T18:18:25,095 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0x263828b5, L:/127.0.0.1:56152 ! R:localhost/127.0.0.1:42911]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:25,095 - WARN  - [pulsar-io-64-1:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-2d20ef052f] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:25,096 - WARN  - [pulsar-io-64-1:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-2d20ef052f] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 2.995 s
2024-02-05T18:18:25,158 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 1498 ms
2024-02-05T18:18:25,159 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0x5948f736, L:/127.0.0.1:56168 - R:localhost/127.0.0.1:42911]] Connected to server
2024-02-05T18:18:25,161 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0x5948f736, L:/127.0.0.1:56168 - R:localhost/127.0.0.1:42911] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:18:25,161 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:56168
2024-02-05T18:18:25,161 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0x5948f736, L:/127.0.0.1:56168 - R:localhost/127.0.0.1:42911] Received unknown request id from server: -1
2024-02-05T18:18:25,161 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0x5948f736, L:/127.0.0.1:56168 ! R:localhost/127.0.0.1:42911] Disconnected
2024-02-05T18:18:25,161 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0x5948f736, L:/127.0.0.1:56168 ! R:localhost/127.0.0.1:42911]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:25,193 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:43735/__change_events] [reader-6db117d0b6] Reconnecting after connection was closed
2024-02-05T18:18:25,195 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0x79b6ac2e, L:/127.0.0.1:56182 - R:localhost/127.0.0.1:42911]] Connected to server
2024-02-05T18:18:25,197 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0x79b6ac2e, L:/127.0.0.1:56182 - R:localhost/127.0.0.1:42911] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:18:25,197 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:56182
2024-02-05T18:18:25,197 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0x79b6ac2e, L:/127.0.0.1:56182 - R:localhost/127.0.0.1:42911] Received unknown request id from server: -1
2024-02-05T18:18:25,198 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0x79b6ac2e, L:/127.0.0.1:56182 ! R:localhost/127.0.0.1:42911] Disconnected
2024-02-05T18:18:25,198 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0x79b6ac2e, L:/127.0.0.1:56182 ! R:localhost/127.0.0.1:42911]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:25,198 - WARN  - [pulsar-io-64-3:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:43735/__change_events] [reader-6db117d0b6] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:18:25,198 - WARN  - [pulsar-io-64-3:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:43735/__change_events] [reader-6db117d0b6] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 3.089 s
2024-02-05T18:18:25,240 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:43735 in 3028.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:18:25,247 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:43735 was invalidated. state Releasing
2024-02-05T18:18:25,247 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:43735 registry has been deleted.
2024-02-05T18:18:25,247 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:43735 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:18:25,248 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:43735. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:18:25,249 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:43735 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:18:25,249 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:43735
2024-02-05T18:18:25,249 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:43735
2024-02-05T18:18:25,250 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:43735 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:18:25,257 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:43735/0x00000000_0xffffffff.
2024-02-05T18:18:25,258 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:43735/0x00000000_0xffffffff.
2024-02-05T18:18:25,259 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:43735/0x00000000_0xffffffff.
2024-02-05T18:18:25,260 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.01 seconds
2024-02-05T18:18:25,261 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:18:25,263 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:18:25,264 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:43735/persistent/__change_events] Closing managed ledger
2024-02-05T18:18:25,265 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xb1c23b94, L:/127.0.0.1:55260 ! R:localhost/127.0.0.1:42197] Disconnected
2024-02-05T18:18:25,266 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:55260
2024-02-05T18:18:25,266 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0xb1c23b94, L:/127.0.0.1:55260 ! R:localhost/127.0.0.1:42197] -- Will try again in 0.1 s
2024-02-05T18:18:25,266 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0xb1c23b94, L:/127.0.0.1:55260 ! R:localhost/127.0.0.1:42197] -- Will try again in 0.1 s
2024-02-05T18:18:25,266 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0xb1c23b94, L:/127.0.0.1:55260 ! R:localhost/127.0.0.1:42197] -- Will try again in 0.1 s
2024-02-05T18:18:25,266 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-14b5b96618] Closed connection [id: 0xb1c23b94, L:/127.0.0.1:55260 ! R:localhost/127.0.0.1:42197] -- Will try again in 0.1 s
2024-02-05T18:18:25,266 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-d92c0d2671] Closed connection [id: 0xb1c23b94, L:/127.0.0.1:55260 ! R:localhost/127.0.0.1:42197] -- Will try again in 0.1 s
2024-02-05T18:18:25,267 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-14b5b96618}, consumerId=0, consumerName=a385d, address=/127.0.0.1:55260}
2024-02-05T18:18:25,267 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-14b5b96618] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-14b5b96618, ackPos=3:6, readPos=3:7}]
2024-02-05T18:18:25,267 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-14b5b96618] Successfully closed dispatcher for reader
2024-02-05T18:18:25,267 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-d92c0d2671}, consumerId=1, consumerName=e7ce7, address=/127.0.0.1:55260}
2024-02-05T18:18:25,271 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:43735/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:18:25,271 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:18:25,272 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:18:25,274 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:18:25,278 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:42911
2024-02-05T18:18:25,279 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:18:25,280 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:18:25,280 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:18:25,280 - INFO  - [main:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-2d20ef052f] Closed Consumer (not connected)
2024-02-05T18:18:25,282 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:43735/__change_events] [reader-6db117d0b6] Closed Consumer (not connected)
2024-02-05T18:18:25,282 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-d92c0d2671] Closed Consumer (not connected)
2024-02-05T18:18:25,282 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:43735/__change_events with subscription name reader-6db117d0b6 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:43735/__change_events with subscription name reader-6db117d0b6 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:18:25,283 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-14b5b96618] Closed Consumer (not connected)
2024-02-05T18:18:25,284 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-d92c0d2671 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-d92c0d2671 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:18:25,284 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-14b5b96618 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-14b5b96618 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:18:25,289 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:18:25,289 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:18:25,292 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:18:25,292 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:18:25,298 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:18:25,298 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:18:25,790 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:18:25,790 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:43735 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:18:25,791 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:43735 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:18:25,791 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:43735]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:18:25,791 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:43735
2024-02-05T18:18:25,792 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:43735 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:18:26,572 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:18:26,572 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:18:26,574 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:18:26,576 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:18:26,576 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:18:26,576 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:18:26,792 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:18:26,792 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:43735 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:18:26,792 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:43735 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:18:26,793 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:43735]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:18:26,793 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:43735
2024-02-05T18:18:26,794 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:43735 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:18:27,688 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 45.51%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 44.28%, msgThroughputEMA= 0.00, updatedAt= 1707149907687, reportedAt= 1707149902692
2024-02-05T18:18:27,793 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:18:27,793 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:43735 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:18:27,795 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:43735 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:18:27,795 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 1.0 ms. Scheduled cleanups for inactive brokers:[localhost:43735]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:18:27,796 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:43735
2024-02-05T18:18:27,797 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:43735 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:18:28,591 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:18:28,592 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:18:28,593 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:18:28,593 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:18:28,593 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6556471b{/static,null,STOPPED}
2024-02-05T18:18:28,593 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,STOPPED}
2024-02-05T18:18:28,595 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/topics,null,STOPPED}
2024-02-05T18:18:28,597 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,STOPPED}
2024-02-05T18:18:28,599 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,STOPPED}
2024-02-05T18:18:28,601 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,STOPPED}
2024-02-05T18:18:28,603 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/admin,null,STOPPED}
2024-02-05T18:18:28,605 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1978b0d5{/,null,STOPPED}
2024-02-05T18:18:28,606 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:18:28,607 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:18:28,607 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:18:28,608 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:39923
2024-02-05T18:18:28,610 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:39923, sourceBroker=localhost:43735, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149902214, versionId=7]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:18:33,622 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:39923 in 5011.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:18:33,631 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:39923 was invalidated. state Releasing
2024-02-05T18:18:33,631 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:39923. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:18:33,632 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:39923
2024-02-05T18:18:33,652 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39923 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:39923, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149913641, versionId=8]. totalHandledRequests:10
2024-02-05T18:18:33,654 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:18:33,655 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:18:33,655 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:18:33,656 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-b2868e4b77}, consumerId=4, consumerName=e1c80, address=/127.0.0.1:58510}
2024-02-05T18:18:33,659 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-b2868e4b77}, consumerId=4, consumerName=e1c80, address=/127.0.0.1:58510}
2024-02-05T18:18:33,659 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-b2868e4b77] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-b2868e4b77, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:18:33,660 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-b2868e4b77] Successfully closed dispatcher for reader
2024-02-05T18:18:33,660 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:42197] Broker notification of Closed consumer: 4
2024-02-05T18:18:33,661 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-b2868e4b77] Closed connection [id: 0x437ca233, L:/127.0.0.1:58510 - R:localhost/127.0.0.1:42197] -- Will try again in 0.1 s
2024-02-05T18:18:33,661 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-b2868e4b77] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-b2868e4b77, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:18:33,662 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-b2868e4b77] Successfully disconnected and closed subscription
2024-02-05T18:18:33,662 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:18:33,665 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=14:-1
2024-02-05T18:18:33,668 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:18:33,668 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-b2868e4b77] Closed Consumer (not connected)
2024-02-05T18:18:33,668 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 15.0 ms
2024-02-05T18:18:33,668 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-b2868e4b77 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-b2868e4b77 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:18:33,675 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39923 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:39923, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149913653, versionId=9]. totalHandledRequests:4
2024-02-05T18:18:33,675 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:18:33,676 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:39923/0x00000000_0xffffffff.
2024-02-05T18:18:33,678 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:39923/0x00000000_0xffffffff.
2024-02-05T18:18:33,678 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:18:33,678 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:18:33,679 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:39923/0x00000000_0xffffffff.
2024-02-05T18:18:33,679 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.046 seconds
2024-02-05T18:18:33,679 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:18:33,680 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:18:33,680 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:18:33,680 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:39923/persistent/__change_events] Closing managed ledger
2024-02-05T18:18:33,681 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x437ca233, L:/127.0.0.1:58510 ! R:localhost/127.0.0.1:42197] Disconnected
2024-02-05T18:18:33,680 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:58510
2024-02-05T18:18:33,681 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x437ca233, L:/127.0.0.1:58510 ! R:localhost/127.0.0.1:42197] -- Will try again in 0.1 s
2024-02-05T18:18:33,681 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x437ca233, L:/127.0.0.1:58510 ! R:localhost/127.0.0.1:42197] -- Will try again in 0.1 s
2024-02-05T18:18:33,681 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x437ca233, L:/127.0.0.1:58510 ! R:localhost/127.0.0.1:42197] -- Will try again in 0.1 s
2024-02-05T18:18:33,681 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-f29572f2d5}, consumerId=0, consumerName=42d48, address=/127.0.0.1:58510}
2024-02-05T18:18:33,681 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-f29572f2d5] Closed connection [id: 0x437ca233, L:/127.0.0.1:58510 ! R:localhost/127.0.0.1:42197] -- Will try again in 0.1 s
2024-02-05T18:18:33,681 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f29572f2d5] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-f29572f2d5, ackPos=3:7, readPos=3:9}]
2024-02-05T18:18:33,681 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-8594b315fd] Closed connection [id: 0x437ca233, L:/127.0.0.1:58510 ! R:localhost/127.0.0.1:42197] -- Will try again in 0.1 s
2024-02-05T18:18:33,682 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f29572f2d5] Successfully closed dispatcher for reader
2024-02-05T18:18:33,682 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:39923/__change_events] [reader-13db631d44] Closed connection [id: 0x437ca233, L:/127.0.0.1:58510 ! R:localhost/127.0.0.1:42197] -- Will try again in 0.1 s
2024-02-05T18:18:33,682 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-b216b37890] Closed connection [id: 0x437ca233, L:/127.0.0.1:58510 ! R:localhost/127.0.0.1:42197] -- Will try again in 0.1 s
2024-02-05T18:18:33,682 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:39923/__change_events, name=reader-13db631d44}, consumerId=3, consumerName=e8246, address=/127.0.0.1:58510}
2024-02-05T18:18:33,682 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:39923/__change_events][reader-13db631d44] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:39923/persistent/__change_events, cursor=reader-13db631d44, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:18:33,682 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:39923/__change_events][reader-13db631d44] Successfully closed dispatcher for reader
2024-02-05T18:18:33,682 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-b216b37890}, consumerId=2, consumerName=ae489, address=/127.0.0.1:58510}
2024-02-05T18:18:33,683 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-8594b315fd}, consumerId=1, consumerName=43dd4, address=/127.0.0.1:58510}
2024-02-05T18:18:33,685 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:18:33,685 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:39923/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:18:33,685 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:18:33,687 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:18:33,687 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:18:33,691 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:42197
2024-02-05T18:18:33,691 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:18:33,692 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:18:33,692 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:18:33,692 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:39923/__change_events] [reader-13db631d44] Closed Consumer (not connected)
2024-02-05T18:18:33,692 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-8594b315fd] Closed Consumer (not connected)
2024-02-05T18:18:33,692 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-f29572f2d5] Closed Consumer (not connected)
2024-02-05T18:18:33,692 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-b216b37890] Closed Consumer (not connected)
2024-02-05T18:18:33,692 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:39923/__change_events with subscription name reader-13db631d44 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:39923/__change_events with subscription name reader-13db631d44 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:18:33,693 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-8594b315fd was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-8594b315fd was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:18:33,693 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-f29572f2d5 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-f29572f2d5 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:18:33,693 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-b216b37890 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-b216b37890 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:18:33,695 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:18:33,695 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:18:33,695 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:18:33,695 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:18:33,696 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:18:33,696 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:18:33,697 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:18:33,697 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:18:35,086 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:18:35,087 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:18:35,088 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:18:35,088 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:18:35,089 - INFO  - [GracefulExecutorServicesTerminationHandler:BrokerService@893] - Broker service completely shut down
2024-02-05T18:18:35,089 - INFO  - [GracefulExecutorServicesTerminationHandler:PulsarService@601] - Closed
2024-02-05T18:18:35,095 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:18:35,096 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:18:35,100 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:18:35,100 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:18:35,100 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:18:35,100 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:18:35,100 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:18:35,100 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:18:35,100 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:18:35,100 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 187 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:18:35,101 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 188 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:18:35,101 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 193 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T18:18:35,101 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 8 new threads
2024-02-05T18:18:35,101 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:18:35,101 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@155c2a47
2024-02-05T18:18:35,101 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:18:35,101 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:18:35,101 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 30.511 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  56.347 s
[INFO] Finished at: 2024-02-05T18:18:35+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 2 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:19:05,359 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:19:06,273 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:19:06,274 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:19:06,744 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:19:06,745 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:19:06,746 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:19:06,746 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:19:06,747 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:19:06,748 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:19:06,770 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:19:06,771 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:19:06,771 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:19:06,772 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:19:06,772 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:19:06,773 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:19:06,773 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:19:06,774 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:19:06,774 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:19:06,774 - INFO  - [main:Environment@98] - Client environment:os.memory.free=26MB
2024-02-05T18:19:06,775 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:19:06,775 - INFO  - [main:Environment@98] - Client environment:os.memory.total=126MB
2024-02-05T18:19:08,385 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:19:08,387 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:19:08,387 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:19:08,388 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:19:08,765 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:19:08,767 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:19:08,871 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:19:08,954 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:19:08,957 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:19:08,974 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:19:09,068 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:19:09,107 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:19:09,146 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:19:09,489 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:19:09,490 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:19:09,526 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:19:09,634 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:35181, TLS: (none), listener: (none)
2024-02-05T18:19:09,938 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44289, TLS: OPENSSL, listener: (none)
2024-02-05T18:19:09,957 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:19:09,962 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:19:09,963 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:19:09,992 - INFO  - [main:Log@170] - Logging initialized @6937ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:19:10,837 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:19:10,869 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:19:10,870 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:19:10,873 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:19:11,663 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/,null,AVAILABLE}
2024-02-05T18:19:12,897 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin,null,AVAILABLE}
2024-02-05T18:19:14,170 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,AVAILABLE}
2024-02-05T18:19:14,531 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,AVAILABLE}
2024-02-05T18:19:14,682 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,AVAILABLE}
2024-02-05T18:19:14,823 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/topics,null,AVAILABLE}
2024-02-05T18:19:14,824 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,AVAILABLE}
2024-02-05T18:19:14,826 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@1978b0d5{/static,null,AVAILABLE}
2024-02-05T18:19:14,847 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:34853}
2024-02-05T18:19:15,006 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:46261}
2024-02-05T18:19:15,006 - INFO  - [main:Server@415] - Started @11953ms
2024-02-05T18:19:15,007 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:34853
2024-02-05T18:19:15,008 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:46261
2024-02-05T18:19:15,017 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:19:15,018 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:19:15,240 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:34853
2024-02-05T18:19:15,259 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:19:15,266 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:34853 is changing the role from null to Leader
2024-02-05T18:19:15,268 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:34853).
2024-02-05T18:19:15,660 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:34853 
2024-02-05T18:19:16,141 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:19:16,172 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:19:16,288 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:19:16,294 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:19:16,306 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:19:16,309 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:19:16,357 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:19:16,395 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:19:16,429 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:19:16,496 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:19:16,519 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:19:16,528 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:19:16,532 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:19:16,566 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:19:16,573 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:16 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 566
2024-02-05T18:19:16,755 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x8ac29796, L:/127.0.0.1:45842 - R:localhost/127.0.0.1:35181]] Connected to server
2024-02-05T18:19:16,790 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:45842] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:19:16,850 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:19:16,860 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x8ac29796, L:/127.0.0.1:45842 - R:localhost/127.0.0.1:35181]
2024-02-05T18:19:16,927 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:19:16,965 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:45842] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:45842, producerName=test-0-0, producerId=0}
2024-02-05T18:19:16,975 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x8ac29796, L:/127.0.0.1:45842 - R:localhost/127.0.0.1:35181]
2024-02-05T18:19:16,977 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:19:17,040 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:19:17,042 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c1f5f64db5] Subscribing to topic on cnx [id: 0x8ac29796, L:/127.0.0.1:45842 - R:localhost/127.0.0.1:35181], consumerId 0
2024-02-05T18:19:17,055 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x639f070a, L:/127.0.0.1:35181 - R:/127.0.0.1:45842]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-c1f5f64db5. consumerId: 0
2024-02-05T18:19:17,090 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c1f5f64db5] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:19:17,091 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:19:17,091 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-c1f5f64db5, ackPos=3:-1, readPos=3:0}
2024-02-05T18:19:17,112 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:45842] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-c1f5f64db5
2024-02-05T18:19:17,118 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c1f5f64db5] Subscribed to topic on localhost/127.0.0.1:35181 -- consumer: 0
2024-02-05T18:19:17,133 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.014 seconds
2024-02-05T18:19:17,134 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:19:17,136 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:19:17,136 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:19:17,183 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:19:17,207 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:19:17,208 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:19:17,210 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:19:17,212 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 61
2024-02-05T18:19:17,225 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:19:17,237 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:19:17,238 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:19:17,239 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:19:17,240 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:19:17,259 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:19:17,261 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x8ac29796, L:/127.0.0.1:45842 - R:localhost/127.0.0.1:35181]
2024-02-05T18:19:17,270 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:19:17,277 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:45842] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:45842, producerName=test-0-1, producerId=1}
2024-02-05T18:19:17,279 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x8ac29796, L:/127.0.0.1:45842 - R:localhost/127.0.0.1:35181]
2024-02-05T18:19:17,296 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:19:17,299 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-63a04606aa] Subscribing to topic on cnx [id: 0x8ac29796, L:/127.0.0.1:45842 - R:localhost/127.0.0.1:35181], consumerId 1
2024-02-05T18:19:17,301 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x639f070a, L:/127.0.0.1:35181 - R:/127.0.0.1:45842]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-63a04606aa. consumerId: 1
2024-02-05T18:19:17,325 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-63a04606aa] Created new subscription for 1
2024-02-05T18:19:17,326 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:45842] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-63a04606aa
2024-02-05T18:19:17,327 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-63a04606aa] Subscribed to topic on localhost/127.0.0.1:35181 -- consumer: 1
2024-02-05T18:19:17,347 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:19:17,349 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x8ac29796, L:/127.0.0.1:45842 - R:localhost/127.0.0.1:35181]
2024-02-05T18:19:17,354 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:19:17,362 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:45842] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:45842, producerName=test-0-2, producerId=2}
2024-02-05T18:19:17,364 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x8ac29796, L:/127.0.0.1:45842 - R:localhost/127.0.0.1:35181]
2024-02-05T18:19:17,378 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:19:17,404 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:19:17,410 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:34853 started the ownership monitor.
2024-02-05T18:19:17,429 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:19:17,431 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-4fcd8148b5] Subscribing to topic on cnx [id: 0x8ac29796, L:/127.0.0.1:45842 - R:localhost/127.0.0.1:35181], consumerId 2
2024-02-05T18:19:17,433 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x639f070a, L:/127.0.0.1:35181 - R:/127.0.0.1:45842]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-4fcd8148b5. consumerId: 2
2024-02-05T18:19:17,444 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-4fcd8148b5] Created new subscription for 2
2024-02-05T18:19:17,444 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:45842] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-4fcd8148b5
2024-02-05T18:19:17,444 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:34853/__change_events
2024-02-05T18:19:17,445 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-4fcd8148b5] Subscribed to topic on localhost/127.0.0.1:35181 -- consumer: 2
2024-02-05T18:19:17,446 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:34853 plays the leader now.
2024-02-05T18:19:17,451 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.91%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 53.91%, msgThroughputEMA= 0.00, updatedAt= 1707149957450, reportedAt= 0
2024-02-05T18:19:17,476 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:19:17,482 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:19:17,483 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:19:17,521 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:34853/0x00000000_0xffffffff - localhost:34853.
2024-02-05T18:19:17,523 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:34853
2024-02-05T18:19:17,523 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:34853/0x00000000_0xffffffff
2024-02-05T18:19:17,524 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:34853/0x00000000_0xffffffff - localhost:34853.
2024-02-05T18:19:17,525 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:34853
2024-02-05T18:19:17,525 - INFO  - [pulsar-7-3:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:34853/0x00000000_0xffffffff
2024-02-05T18:19:17,534 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:34853/__change_events][reader-091c0e33f0] Subscribing to topic on cnx [id: 0x8ac29796, L:/127.0.0.1:45842 - R:localhost/127.0.0.1:35181], consumerId 3
2024-02-05T18:19:17,537 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x639f070a, L:/127.0.0.1:35181 - R:/127.0.0.1:45842]] Subscribing on topic persistent://sla-monitor/test/localhost:34853/__change_events / reader-091c0e33f0. consumerId: 3
2024-02-05T18:19:17,538 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:34853 doesn't exist.
2024-02-05T18:19:17,547 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:34853/persistent/__change_events
2024-02-05T18:19:17,549 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:34853/persistent/__change_events'
2024-02-05T18:19:17,559 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:19:17,560 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:34853/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:19:17,569 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:34853/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:19:17,576 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:34853/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:19:17,580 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:34853/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:34853/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:19:17,581 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:34853/__change_events - dedup is disabled
2024-02-05T18:19:17,595 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:19:17,601 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:34853/__change_events][reader-091c0e33f0] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:19:17,601 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:34853/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:19:17,602 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:34853/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:34853/persistent/__change_events, cursor=reader-091c0e33f0, ackPos=7:-1, readPos=7:0}
2024-02-05T18:19:17,604 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:45842] Created subscription on topic persistent://sla-monitor/test/localhost:34853/__change_events / reader-091c0e33f0
2024-02-05T18:19:17,605 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:34853/__change_events][reader-091c0e33f0] Subscribed to topic on localhost/127.0.0.1:35181 -- consumer: 3
2024-02-05T18:19:17,557 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=9, bootstrap service port = 34853, tls-port = Optional[46261], broker url= pulsar://localhost:35181, broker tls url= pulsar+ssl://localhost:44289, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[35181], brokerServicePortTls=Optional[44289], webServicePort=Optional[34853], webServicePortTls=Optional[46261], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:19:18,111 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:19:18,112 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:19:18,112 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:19:18,112 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:19:18,116 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:19:18,116 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:19:18,123 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:19:18,127 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:19:18,134 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:19:18,135 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:19:18,141 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:19:18,147 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:19:18,149 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:19:18,156 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:19:18,156 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:19:18,163 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:19:18,165 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:45383, TLS: (none), listener: (none)
2024-02-05T18:19:18,167 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:42741, TLS: OPENSSL, listener: (none)
2024-02-05T18:19:18,170 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:19:18,171 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:19:18,171 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:19:18,183 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:19:18,187 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:19:18,187 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:19:18,187 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:19:18,276 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/,null,AVAILABLE}
2024-02-05T18:19:18,484 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:19:18,484 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:19:19,005 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/admin,null,AVAILABLE}
2024-02-05T18:19:19,485 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:19:19,486 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:19:20,249 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,AVAILABLE}
2024-02-05T18:19:20,479 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,AVAILABLE}
2024-02-05T18:19:20,487 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:19:20,487 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:19:20,542 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,AVAILABLE}
2024-02-05T18:19:20,622 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/topics,null,AVAILABLE}
2024-02-05T18:19:20,624 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,AVAILABLE}
2024-02-05T18:19:20,627 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@554f6e30{/static,null,AVAILABLE}
2024-02-05T18:19:20,630 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:35857}
2024-02-05T18:19:20,652 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:36083}
2024-02-05T18:19:20,657 - INFO  - [main:Server@415] - Started @17600ms
2024-02-05T18:19:20,658 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:35857
2024-02-05T18:19:20,661 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:36083
2024-02-05T18:19:20,664 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:19:20,665 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:19:20,686 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:35857
2024-02-05T18:19:20,687 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:35857 registry has been created.
2024-02-05T18:19:20,688 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:35857. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:19:20,692 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:35857 is changing the role from null to Follower
2024-02-05T18:19:20,696 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:34853).
2024-02-05T18:19:20,702 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:19:20,718 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:35857 
2024-02-05T18:19:20,836 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:20 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 45
2024-02-05T18:19:20,859 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:19:20,861 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:19:20,863 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:19:20,874 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:20 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 34
2024-02-05T18:19:20,879 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:35857/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:19:20,890 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x681d41eb, L:/127.0.0.1:45792 - R:localhost/127.0.0.1:45383]] Connected to server
2024-02-05T18:19:20,895 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:45792] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:19:20,915 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x1fad5b32, L:/127.0.0.1:45846 - R:localhost/127.0.0.1:35181]] Connected to server
2024-02-05T18:19:20,918 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:45846] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:19:20,919 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x1fad5b32, L:/127.0.0.1:45846 - R:localhost/127.0.0.1:35181]
2024-02-05T18:19:20,930 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:45846] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:45846, producerName=test-0-3, producerId=0}
2024-02-05T18:19:20,931 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x1fad5b32, L:/127.0.0.1:45846 - R:localhost/127.0.0.1:35181]
2024-02-05T18:19:20,943 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6bfbef74a3] Subscribing to topic on cnx [id: 0x1fad5b32, L:/127.0.0.1:45846 - R:localhost/127.0.0.1:35181], consumerId 0
2024-02-05T18:19:20,945 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xf4eb6ded, L:/127.0.0.1:35181 - R:/127.0.0.1:45846]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-6bfbef74a3. consumerId: 0
2024-02-05T18:19:20,952 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6bfbef74a3] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:19:20,953 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:19:20,953 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-6bfbef74a3, ackPos=3:-1, readPos=3:0}
2024-02-05T18:19:20,956 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:45846] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-6bfbef74a3
2024-02-05T18:19:20,957 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6bfbef74a3] Subscribed to topic on localhost/127.0.0.1:35181 -- consumer: 0
2024-02-05T18:19:20,961 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:19:20,962 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:19:20,985 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:20 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T18:19:20,993 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:19:20,995 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:19:20,996 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:19:21,002 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:35857/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:19:21,008 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:20 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 20
2024-02-05T18:19:21,016 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 7
2024-02-05T18:19:21,024 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:19:21,028 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:19:21,029 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:19:21,032 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T18:19:21,032 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:35857/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:19:21,051 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x1fad5b32, L:/127.0.0.1:45846 - R:localhost/127.0.0.1:35181]
2024-02-05T18:19:21,061 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:45846] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:45846, producerName=test-0-4, producerId=1}
2024-02-05T18:19:21,062 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x1fad5b32, L:/127.0.0.1:45846 - R:localhost/127.0.0.1:35181]
2024-02-05T18:19:21,077 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-c71f90d048] Subscribing to topic on cnx [id: 0x1fad5b32, L:/127.0.0.1:45846 - R:localhost/127.0.0.1:35181], consumerId 1
2024-02-05T18:19:21,079 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xf4eb6ded, L:/127.0.0.1:35181 - R:/127.0.0.1:45846]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-c71f90d048. consumerId: 1
2024-02-05T18:19:21,091 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-c71f90d048] Created new subscription for 1
2024-02-05T18:19:21,091 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:45846] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-c71f90d048
2024-02-05T18:19:21,092 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-c71f90d048] Subscribed to topic on localhost/127.0.0.1:35181 -- consumer: 1
2024-02-05T18:19:21,106 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x1fad5b32, L:/127.0.0.1:45846 - R:localhost/127.0.0.1:35181]
2024-02-05T18:19:21,114 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:45846] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:45846, producerName=test-0-5, producerId=2}
2024-02-05T18:19:21,115 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x1fad5b32, L:/127.0.0.1:45846 - R:localhost/127.0.0.1:35181]
2024-02-05T18:19:21,117 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:19:21,120 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:19:21,122 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:35857 plays a follower now.
2024-02-05T18:19:21,143 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:35857/__change_events
2024-02-05T18:19:21,167 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:35857/0x00000000_0xffffffff - localhost:35857.
2024-02-05T18:19:21,173 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:35857/__change_events][reader-70adcea8ce] Subscribing to topic on cnx [id: 0x681d41eb, L:/127.0.0.1:45792 - R:localhost/127.0.0.1:45383], consumerId 2
2024-02-05T18:19:21,175 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x37ab70c7, L:/127.0.0.1:45383 - R:/127.0.0.1:45792]] Subscribing on topic persistent://sla-monitor/test/localhost:35857/__change_events / reader-70adcea8ce. consumerId: 2
2024-02-05T18:19:21,180 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:35857/0x00000000_0xffffffff
2024-02-05T18:19:21,184 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:35857/persistent/__change_events
2024-02-05T18:19:21,184 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:35857
2024-02-05T18:19:21,185 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:35857/persistent/__change_events'
2024-02-05T18:19:21,186 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:35857/0x00000000_0xffffffff - localhost:35857.
2024-02-05T18:19:21,187 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:35857
2024-02-05T18:19:21,187 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:35857/0x00000000_0xffffffff
2024-02-05T18:19:21,189 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:35857 doesn't exist.
2024-02-05T18:19:21,195 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:19:21,196 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:35857/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:19:21,197 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 35857, tls-port = Optional[36083], broker url= pulsar://localhost:45383, broker tls url= pulsar+ssl://localhost:42741, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[45383], brokerServicePortTls=Optional[42741], webServicePort=Optional[35857], webServicePortTls=Optional[36083], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:19:21,213 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:35857/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:19:21,220 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:35857/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:19:21,226 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:35857/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:35857/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:19:21,228 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:35857/__change_events - dedup is disabled
2024-02-05T18:19:21,234 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:19:21,242 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:35857/__change_events][reader-70adcea8ce] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:19:21,243 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:35857/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:19:21,243 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:35857/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:35857/persistent/__change_events, cursor=reader-70adcea8ce, ackPos=9:-1, readPos=9:0}
2024-02-05T18:19:21,246 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:45792] Created subscription on topic persistent://sla-monitor/test/localhost:35857/__change_events / reader-70adcea8ce
2024-02-05T18:19:21,248 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:35857/__change_events][reader-70adcea8ce] Subscribed to topic on localhost/127.0.0.1:45383 -- consumer: 2
2024-02-05T18:19:21,416 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:19:21,418 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:21 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 28
2024-02-05T18:19:21,447 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:19:21,448 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:21 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:19:21,467 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:19:21,468 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:19:21,471 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:19:21,473 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:21 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 20
2024-02-05T18:19:21,488 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:19:21,489 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:19:21,492 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:19:21,493 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:19:21,495 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:19:21,496 - INFO  - [pulsar-62-1:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:19:21,498 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:21 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:19:21,499 - INFO  - [pulsar-7-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:19:21,511 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:19:21,511 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:19:21,516 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:19:21,518 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:21 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:19:21,532 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:19:21,534 - INFO  - [pulsar-62-5:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:19:21,534 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:19:21,535 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:19:21,536 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:21 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T18:19:21,540 - INFO  - [pulsar-7-5:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:19:21,576 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:19:21,589 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:19:21,589 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:19:21,605 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:19:21,617 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:19:21,636 - INFO  - [ForkJoinPool.commonPool-worker-3:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:35857 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:19:21,697 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:19:21,680 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34853 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:35857, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149961638, versionId=1]. totalHandledRequests:1
2024-02-05T18:19:21,702 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34853 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:35857, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149961677, versionId=2]. totalHandledRequests:1
2024-02-05T18:19:21,706 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:19:21,715 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:21 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 114
2024-02-05T18:19:21,728 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:19:21,758 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-ee0a179844] Subscribing to topic on cnx [id: 0x681d41eb, L:/127.0.0.1:45792 - R:localhost/127.0.0.1:45383], consumerId 3
2024-02-05T18:19:21,760 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x37ab70c7, L:/127.0.0.1:45383 - R:/127.0.0.1:45792]] Subscribing on topic persistent://public/test/__change_events / reader-ee0a179844. consumerId: 3
2024-02-05T18:19:21,762 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34853 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:35857, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149961750, versionId=3]. totalHandledRequests:1
2024-02-05T18:19:21,768 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:19:22,400 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 41.02%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 52.62%, msgThroughputEMA= 0.00, updatedAt= 1707149962399, reportedAt= 1707149957515
2024-02-05T18:19:22,489 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:19:22,490 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:19:23,490 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:19:23,491 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:19:24,491 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:19:24,492 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:19:25,493 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:19:25,493 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:19:26,494 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:19:26,494 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:19:27,400 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 41.02%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 51.46%, msgThroughputEMA= 0.00, updatedAt= 1707149967399, reportedAt= 1707149957515
2024-02-05T18:19:27,495 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:19:27,496 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1441] - Overriding in-flight state ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:35857, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149961750, versionId=3] to overrideData:Optional[ServiceUnitStateData[state=Owned, dstBroker=localhost:35857, sourceBroker=null, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149967495, versionId=4]]
2024-02-05T18:19:27,501 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 5.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:1. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:19:27,503 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34853 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:35857, sourceBroker=null, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149967495, versionId=4]. totalHandledRequests:2
2024-02-05T18:19:27,504 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:19:27,504 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:19:27,505 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:21 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 5786
2024-02-05T18:19:27,506 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:19:27,507 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:19:21 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 5936
2024-02-05T18:19:27,507 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:19:27,512 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:19:27,517 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:19:27,517 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:19:27,525 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:19:27,529 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:19:27,566 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:19:27,569 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:19:27,578 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:19:27,578 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:19:27,580 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:19:27,588 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:19:27,594 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:19:27,601 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:19:27,602 - WARN  - [metadata-store-57-1:PersistentTopic@877] - [persistent://public/test/__change_events] Attempting to subscribe to a fenced topic
2024-02-05T18:19:27,602 - WARN  - [metadata-store-57-1:ServerCnx@1299] - [/127.0.0.1:45792][persistent://public/test/__change_events][reader-ee0a179844] Failed to create consumer: consumerId=3, Topic is temporarily unavailable
2024-02-05T18:19:27,602 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 5836.0 ms
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@dd62935], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@44412aab] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@dd62935, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7489ea3d], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@44412aab, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@d13f965] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@dd62935, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7489ea3d, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3130e673], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@44412aab, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@d13f965, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7ce9968c] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@dd62935, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7489ea3d, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3130e673, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@478a432e], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@44412aab, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@d13f965, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7ce9968c, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55c0526b] 
2024-02-05T18:19:27,607 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x681d41eb, L:/127.0.0.1:45792 - R:localhost/127.0.0.1:45383] Received error from server: Topic is temporarily unavailable
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@dd62935, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7489ea3d, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3130e673, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@478a432e, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@63f525de], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@44412aab, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@d13f965, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7ce9968c, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55c0526b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@539882da] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@dd62935, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7489ea3d, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3130e673, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@478a432e, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@63f525de, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@469e28b4], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@44412aab, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@d13f965, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7ce9968c, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55c0526b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@539882da, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@119a6906] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@dd62935, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7489ea3d, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3130e673, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@478a432e, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@63f525de, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@469e28b4, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5b8b753e], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@44412aab, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@d13f965, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7ce9968c, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55c0526b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@539882da, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@119a6906, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4c92a2c7] 
2024-02-05T18:19:27,609 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-ee0a179844] Failed to subscribe to topic on localhost/127.0.0.1:45383
2024-02-05T18:19:27,609 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-ee0a179844] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Topic is temporarily unavailable","reqId":1396731117814916319, "remote":"localhost/127.0.0.1:45383", "local":"/127.0.0.1:45792"}
2024-02-05T18:19:27,609 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-ee0a179844] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Topic is temporarily unavailable","reqId":1396731117814916319, "remote":"localhost/127.0.0.1:45383", "local":"/127.0.0.1:45792"} -- Will try again in 0.1 s
2024-02-05T18:19:27,615 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@198] - Skipped the message from topic persistent://pulsar/system/loadbalancer-service-unit-state. key=public/test/0x00000000_0xffffffff value=ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:35857, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149961766, versionId=4] prev=ServiceUnitStateData[state=Owned, dstBroker=localhost:35857, sourceBroker=null, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149967495, versionId=4]
2024-02-05T18:19:27,615 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@198] - Skipped the message from topic persistent://pulsar/system/loadbalancer-service-unit-state. key=public/test/0x00000000_0xffffffff value=ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:35857, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149961766, versionId=4] prev=ServiceUnitStateData[state=Owned, dstBroker=localhost:35857, sourceBroker=null, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149967495, versionId=4]
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:19:27,640 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:19:27,647 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:19:27,648 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:19:27,648 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:19:27,649 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@554f6e30{/static,null,STOPPED}
2024-02-05T18:19:27,650 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,STOPPED}
2024-02-05T18:19:27,661 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/topics,null,STOPPED}
2024-02-05T18:19:27,664 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,STOPPED}
2024-02-05T18:19:27,674 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,STOPPED}
2024-02-05T18:19:27,677 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,STOPPED}
2024-02-05T18:19:27,680 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/admin,null,STOPPED}
2024-02-05T18:19:27,683 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/,null,STOPPED}
2024-02-05T18:19:27,687 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:19:27,689 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:19:27,689 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:19:27,691 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:35857
2024-02-05T18:19:27,697 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:34853. Skipping this broker. Phase one
2024-02-05T18:19:27,697 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:35857, sourceBroker=null, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149967495, versionId=4] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:34853, sourceBroker=localhost:35857, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149967697, versionId=5]
2024-02-05T18:19:27,704 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34853 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:34853, sourceBroker=localhost:35857, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149967697, versionId=5]. totalHandledRequests:6
2024-02-05T18:19:27,707 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:34853 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:34853, sourceBroker=localhost:35857, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149967697, versionId=5], next:, totalHandledRequests:6, totalFailedRequests:6
2024-02-05T18:19:27,707 - INFO  - [broker-client-shared-internal-executor-65-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 2.0 ms
2024-02-05T18:19:27,708 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:19:27,709 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:19:27,712 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-ee0a179844] Reconnecting after connection was closed
2024-02-05T18:19:27,714 - ERROR - [pulsar-io-64-2:ClientCnx@1196] - [id: 0x681d41eb, L:/127.0.0.1:45792 - R:localhost/127.0.0.1:45383] Close connection because received internal-server error Failed due to pulsar service is not ready
2024-02-05T18:19:27,715 - WARN  - [pulsar-io-64-2:BinaryProtoLookupService@158] - [persistent://public/test/__change_events] failed to send lookup request : {"errorMsg":"Failed due to pulsar service is not ready","reqId":1396731117814916320, "remote":"localhost/127.0.0.1:45383", "local":"/127.0.0.1:45792"}
2024-02-05T18:19:27,715 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-ee0a179844] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":1396731117814916320, "remote":"localhost/127.0.0.1:45383", "local":"/127.0.0.1:45792"}
2024-02-05T18:19:27,715 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-ee0a179844] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":1396731117814916320, "remote":"localhost/127.0.0.1:45383", "local":"/127.0.0.1:45792"} -- Will try again in 0.199 s
2024-02-05T18:19:27,716 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x681d41eb, L:/127.0.0.1:45792 ! R:localhost/127.0.0.1:45383] Disconnected
2024-02-05T18:19:27,717 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:45792
2024-02-05T18:19:27,718 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:35857/__change_events, name=reader-70adcea8ce}, consumerId=2, consumerName=004d6, address=/127.0.0.1:45792}
2024-02-05T18:19:27,718 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:35857/__change_events] [reader-70adcea8ce] Closed connection [id: 0x681d41eb, L:/127.0.0.1:45792 ! R:localhost/127.0.0.1:45383] -- Will try again in 0.1 s
2024-02-05T18:19:27,718 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:19:27,719 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:35857/__change_events][reader-70adcea8ce] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:35857/persistent/__change_events, cursor=reader-70adcea8ce, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:19:27,720 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:35857/__change_events][reader-70adcea8ce] Successfully closed dispatcher for reader
2024-02-05T18:19:27,735 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:19:27,737 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-8e2f9f6969] Subscribing to topic on cnx [id: 0x8ac29796, L:/127.0.0.1:45842 - R:localhost/127.0.0.1:35181], consumerId 4
2024-02-05T18:19:27,738 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x639f070a, L:/127.0.0.1:35181 - R:/127.0.0.1:45842]] Subscribing on topic persistent://public/test/__change_events / reader-8e2f9f6969. consumerId: 4
2024-02-05T18:19:27,745 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:19:27,752 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:19:27,753 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:19:27,756 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:19:27,758 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:19:27,759 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:19:27,764 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:19:27,764 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:19:27,764 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:19:27,769 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:19:27,780 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-8e2f9f6969] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:19:27,780 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:19:27,781 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-8e2f9f6969, ackPos=13:-1, readPos=13:0}
2024-02-05T18:19:27,783 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:45842] Created subscription on topic persistent://public/test/__change_events / reader-8e2f9f6969
2024-02-05T18:19:27,783 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-8e2f9f6969] Subscribed to topic on localhost/127.0.0.1:35181 -- consumer: 4
2024-02-05T18:19:27,819 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://sla-monitor/test/localhost:35857/__change_events] [reader-70adcea8ce] Reconnecting after timeout
2024-02-05T18:19:27,821 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xac84751a, L:/127.0.0.1:46620 - R:localhost/127.0.0.1:45383]] Connected to server
2024-02-05T18:19:27,822 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0xac84751a, L:/127.0.0.1:46620 - R:localhost/127.0.0.1:45383] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:19:27,822 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:46620
2024-02-05T18:19:27,823 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0xac84751a, L:/127.0.0.1:46620 - R:localhost/127.0.0.1:45383] Received unknown request id from server: -1
2024-02-05T18:19:27,823 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xac84751a, L:/127.0.0.1:46620 ! R:localhost/127.0.0.1:45383] Disconnected
2024-02-05T18:19:27,823 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0xac84751a, L:/127.0.0.1:46620 ! R:localhost/127.0.0.1:45383]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:27,823 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:35857/__change_events] [reader-70adcea8ce] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:27,824 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:35857/__change_events] [reader-70adcea8ce] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.19 s
2024-02-05T18:19:27,916 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-ee0a179844] Reconnecting after connection was closed
2024-02-05T18:19:27,917 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x4aa89e86, L:/127.0.0.1:46628 - R:localhost/127.0.0.1:45383]] Connected to server
2024-02-05T18:19:27,919 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:46628
2024-02-05T18:19:27,919 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0x4aa89e86, L:/127.0.0.1:46628 - R:localhost/127.0.0.1:45383] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:19:27,920 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0x4aa89e86, L:/127.0.0.1:46628 - R:localhost/127.0.0.1:45383] Received unknown request id from server: -1
2024-02-05T18:19:27,920 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x4aa89e86, L:/127.0.0.1:46628 ! R:localhost/127.0.0.1:45383] Disconnected
2024-02-05T18:19:27,920 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0x4aa89e86, L:/127.0.0.1:46628 ! R:localhost/127.0.0.1:45383]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:27,921 - WARN  - [pulsar-io-64-1:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-ee0a179844] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:27,921 - WARN  - [pulsar-io-64-1:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-ee0a179844] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.39 s
2024-02-05T18:19:28,015 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:35857/__change_events] [reader-70adcea8ce] Reconnecting after connection was closed
2024-02-05T18:19:28,017 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0x665fc6c7, L:/127.0.0.1:46632 - R:localhost/127.0.0.1:45383]] Connected to server
2024-02-05T18:19:28,020 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0x665fc6c7, L:/127.0.0.1:46632 - R:localhost/127.0.0.1:45383] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:19:28,019 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:46632
2024-02-05T18:19:28,020 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0x665fc6c7, L:/127.0.0.1:46632 - R:localhost/127.0.0.1:45383] Received unknown request id from server: -1
2024-02-05T18:19:28,020 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0x665fc6c7, L:/127.0.0.1:46632 ! R:localhost/127.0.0.1:45383] Disconnected
2024-02-05T18:19:28,020 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0x665fc6c7, L:/127.0.0.1:46632 ! R:localhost/127.0.0.1:45383]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:28,020 - WARN  - [pulsar-io-64-4:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:35857/__change_events] [reader-70adcea8ce] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:28,021 - WARN  - [pulsar-io-64-4:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:35857/__change_events] [reader-70adcea8ce] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.4 s
2024-02-05T18:19:28,312 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-ee0a179844] Reconnecting after connection was closed
2024-02-05T18:19:28,314 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0xd1b41526, L:/127.0.0.1:46638 - R:localhost/127.0.0.1:45383]] Connected to server
2024-02-05T18:19:28,317 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:46638
2024-02-05T18:19:28,317 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0xd1b41526, L:/127.0.0.1:46638 - R:localhost/127.0.0.1:45383] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:19:28,317 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0xd1b41526, L:/127.0.0.1:46638 - R:localhost/127.0.0.1:45383] Received unknown request id from server: -1
2024-02-05T18:19:28,318 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0xd1b41526, L:/127.0.0.1:46638 ! R:localhost/127.0.0.1:45383] Disconnected
2024-02-05T18:19:28,318 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0xd1b41526, L:/127.0.0.1:46638 ! R:localhost/127.0.0.1:45383]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:28,318 - WARN  - [pulsar-io-64-3:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-ee0a179844] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:28,318 - WARN  - [pulsar-io-64-3:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-ee0a179844] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.8 s
2024-02-05T18:19:28,421 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:35857/__change_events] [reader-70adcea8ce] Reconnecting after connection was closed
2024-02-05T18:19:28,423 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xeb3a5321, L:/127.0.0.1:46654 - R:localhost/127.0.0.1:45383]] Connected to server
2024-02-05T18:19:28,425 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0xeb3a5321, L:/127.0.0.1:46654 - R:localhost/127.0.0.1:45383] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:19:28,425 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:46654
2024-02-05T18:19:28,425 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0xeb3a5321, L:/127.0.0.1:46654 - R:localhost/127.0.0.1:45383] Received unknown request id from server: -1
2024-02-05T18:19:28,426 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xeb3a5321, L:/127.0.0.1:46654 ! R:localhost/127.0.0.1:45383] Disconnected
2024-02-05T18:19:28,426 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0xeb3a5321, L:/127.0.0.1:46654 ! R:localhost/127.0.0.1:45383]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:28,426 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:35857/__change_events] [reader-70adcea8ce] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:28,426 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:35857/__change_events] [reader-70adcea8ce] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.763 s
2024-02-05T18:19:28,502 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:19:28,503 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:19:29,120 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-ee0a179844] Reconnecting after connection was closed
2024-02-05T18:19:29,121 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x0fef55b2, L:/127.0.0.1:46660 - R:localhost/127.0.0.1:45383]] Connected to server
2024-02-05T18:19:29,123 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0x0fef55b2, L:/127.0.0.1:46660 - R:localhost/127.0.0.1:45383] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:19:29,123 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:46660
2024-02-05T18:19:29,124 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0x0fef55b2, L:/127.0.0.1:46660 - R:localhost/127.0.0.1:45383] Received unknown request id from server: -1
2024-02-05T18:19:29,124 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x0fef55b2, L:/127.0.0.1:46660 ! R:localhost/127.0.0.1:45383] Disconnected
2024-02-05T18:19:29,124 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0x0fef55b2, L:/127.0.0.1:46660 ! R:localhost/127.0.0.1:45383]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:29,125 - WARN  - [pulsar-io-64-1:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-ee0a179844] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:29,125 - WARN  - [pulsar-io-64-1:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-ee0a179844] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 1.488 s
2024-02-05T18:19:29,190 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:35857/__change_events] [reader-70adcea8ce] Reconnecting after connection was closed
2024-02-05T18:19:29,192 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0xb580e80d, L:/127.0.0.1:46674 - R:localhost/127.0.0.1:45383]] Connected to server
2024-02-05T18:19:29,195 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0xb580e80d, L:/127.0.0.1:46674 - R:localhost/127.0.0.1:45383] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:19:29,195 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:46674
2024-02-05T18:19:29,195 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0xb580e80d, L:/127.0.0.1:46674 - R:localhost/127.0.0.1:45383] Received unknown request id from server: -1
2024-02-05T18:19:29,196 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0xb580e80d, L:/127.0.0.1:46674 ! R:localhost/127.0.0.1:45383] Disconnected
2024-02-05T18:19:29,196 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0xb580e80d, L:/127.0.0.1:46674 ! R:localhost/127.0.0.1:45383]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:29,196 - WARN  - [pulsar-io-64-4:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:35857/__change_events] [reader-70adcea8ce] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:29,196 - WARN  - [pulsar-io-64-4:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:35857/__change_events] [reader-70adcea8ce] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 1.579 s
2024-02-05T18:19:29,503 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:19:29,504 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:19:30,504 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:19:30,505 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:19:30,614 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-ee0a179844] Reconnecting after connection was closed
2024-02-05T18:19:30,616 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0xb562fa4f, L:/127.0.0.1:46686 - R:localhost/127.0.0.1:45383]] Connected to server
2024-02-05T18:19:30,618 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:46686
2024-02-05T18:19:30,618 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0xb562fa4f, L:/127.0.0.1:46686 - R:localhost/127.0.0.1:45383] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:19:30,618 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0xb562fa4f, L:/127.0.0.1:46686 - R:localhost/127.0.0.1:45383] Received unknown request id from server: -1
2024-02-05T18:19:30,619 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0xb562fa4f, L:/127.0.0.1:46686 ! R:localhost/127.0.0.1:45383] Disconnected
2024-02-05T18:19:30,619 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0xb562fa4f, L:/127.0.0.1:46686 ! R:localhost/127.0.0.1:45383]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:30,619 - WARN  - [pulsar-io-64-3:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-ee0a179844] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:30,619 - WARN  - [pulsar-io-64-3:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-ee0a179844] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 3.141 s
2024-02-05T18:19:30,776 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:35857/__change_events] [reader-70adcea8ce] Reconnecting after connection was closed
2024-02-05T18:19:30,778 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xfad7edd5, L:/127.0.0.1:46690 - R:localhost/127.0.0.1:45383]] Connected to server
2024-02-05T18:19:30,780 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0xfad7edd5, L:/127.0.0.1:46690 - R:localhost/127.0.0.1:45383] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:19:30,780 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:46690
2024-02-05T18:19:30,780 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0xfad7edd5, L:/127.0.0.1:46690 - R:localhost/127.0.0.1:45383] Received unknown request id from server: -1
2024-02-05T18:19:30,781 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xfad7edd5, L:/127.0.0.1:46690 ! R:localhost/127.0.0.1:45383] Disconnected
2024-02-05T18:19:30,781 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0xfad7edd5, L:/127.0.0.1:46690 ! R:localhost/127.0.0.1:45383]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:30,781 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:35857/__change_events] [reader-70adcea8ce] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:19:30,781 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:35857/__change_events] [reader-70adcea8ce] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 2.957 s
2024-02-05T18:19:30,804 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:35857 in 3112.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:19:30,811 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:35857 registry has been deleted.
2024-02-05T18:19:30,812 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:35857 was invalidated. state Releasing
2024-02-05T18:19:30,812 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:35857 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:19:30,813 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:35857. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:19:30,814 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:35857 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:19:30,814 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:35857
2024-02-05T18:19:30,814 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:35857
2024-02-05T18:19:30,815 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:35857 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:19:30,822 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:35857/0x00000000_0xffffffff.
2024-02-05T18:19:30,823 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:35857/0x00000000_0xffffffff.
2024-02-05T18:19:30,824 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:35857/0x00000000_0xffffffff.
2024-02-05T18:19:30,825 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.01 seconds
2024-02-05T18:19:30,826 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:19:30,829 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:19:30,829 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:35857/persistent/__change_events] Closing managed ledger
2024-02-05T18:19:30,830 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x1fad5b32, L:/127.0.0.1:45846 ! R:localhost/127.0.0.1:35181] Disconnected
2024-02-05T18:19:30,831 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x1fad5b32, L:/127.0.0.1:45846 ! R:localhost/127.0.0.1:35181] -- Will try again in 0.1 s
2024-02-05T18:19:30,831 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x1fad5b32, L:/127.0.0.1:45846 ! R:localhost/127.0.0.1:35181] -- Will try again in 0.1 s
2024-02-05T18:19:30,831 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:45846
2024-02-05T18:19:30,831 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x1fad5b32, L:/127.0.0.1:45846 ! R:localhost/127.0.0.1:35181] -- Will try again in 0.1 s
2024-02-05T18:19:30,831 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-6bfbef74a3] Closed connection [id: 0x1fad5b32, L:/127.0.0.1:45846 ! R:localhost/127.0.0.1:35181] -- Will try again in 0.1 s
2024-02-05T18:19:30,832 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-c71f90d048] Closed connection [id: 0x1fad5b32, L:/127.0.0.1:45846 ! R:localhost/127.0.0.1:35181] -- Will try again in 0.1 s
2024-02-05T18:19:30,832 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-6bfbef74a3}, consumerId=0, consumerName=ed769, address=/127.0.0.1:45846}
2024-02-05T18:19:30,832 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:35857/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:19:30,833 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6bfbef74a3] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-6bfbef74a3, ackPos=3:5, readPos=3:6}]
2024-02-05T18:19:30,833 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:19:30,833 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6bfbef74a3] Successfully closed dispatcher for reader
2024-02-05T18:19:30,834 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-c71f90d048}, consumerId=1, consumerName=65dcb, address=/127.0.0.1:45846}
2024-02-05T18:19:30,835 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:19:30,836 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:19:30,842 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:45383
2024-02-05T18:19:30,842 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:19:30,843 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:19:30,844 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:19:30,844 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-c71f90d048] Closed Consumer (not connected)
2024-02-05T18:19:30,845 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:35857/__change_events] [reader-70adcea8ce] Closed Consumer (not connected)
2024-02-05T18:19:30,846 - INFO  - [main:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-ee0a179844] Closed Consumer (not connected)
2024-02-05T18:19:30,845 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-c71f90d048 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-c71f90d048 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:19:30,846 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-6bfbef74a3] Closed Consumer (not connected)
2024-02-05T18:19:30,846 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:35857/__change_events with subscription name reader-70adcea8ce was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:35857/__change_events with subscription name reader-70adcea8ce was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:19:30,847 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-6bfbef74a3 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-6bfbef74a3 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:19:30,852 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:19:30,852 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:19:30,855 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:19:30,855 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:19:30,861 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:19:30,862 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:19:31,509 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:19:31,509 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:35857 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:19:31,510 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:35857 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:19:31,510 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:35857]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:19:31,510 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:35857
2024-02-05T18:19:31,511 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:35857 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:19:32,141 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:19:32,141 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:19:32,144 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:19:32,144 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:19:32,145 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:19:32,145 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:19:32,399 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:19:32,400 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 43.95%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 43.95%, msgThroughputEMA= 0.00, updatedAt= 1707149972399, reportedAt= 0
2024-02-05T18:19:32,510 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:19:32,511 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:35857 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:19:32,511 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:35857 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:19:32,511 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:35857]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:19:32,511 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:35857
2024-02-05T18:19:32,512 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:35857 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:19:33,512 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:19:33,512 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:35857 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:19:33,513 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:35857 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:19:33,513 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:35857]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:19:33,513 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:35857
2024-02-05T18:19:33,514 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:35857 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:19:34,157 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:19:34,159 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:19:34,159 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:19:34,159 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:19:34,160 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@1978b0d5{/static,null,STOPPED}
2024-02-05T18:19:34,160 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,STOPPED}
2024-02-05T18:19:34,161 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/topics,null,STOPPED}
2024-02-05T18:19:34,163 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,STOPPED}
2024-02-05T18:19:34,165 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,STOPPED}
2024-02-05T18:19:34,166 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,STOPPED}
2024-02-05T18:19:34,167 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin,null,STOPPED}
2024-02-05T18:19:34,168 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/,null,STOPPED}
2024-02-05T18:19:34,169 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:19:34,170 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:19:34,170 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:19:34,171 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:34853
2024-02-05T18:19:34,173 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:34853, sourceBroker=localhost:35857, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149967697, versionId=5]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:19:39,183 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:34853 in 5010.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:19:39,194 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:34853 was invalidated. state Releasing
2024-02-05T18:19:39,194 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:34853. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:19:39,195 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:34853
2024-02-05T18:19:39,198 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:34853/0x00000000_0xffffffff.
2024-02-05T18:19:39,199 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:34853/0x00000000_0xffffffff.
2024-02-05T18:19:39,200 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:34853/0x00000000_0xffffffff.
2024-02-05T18:19:39,208 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34853 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:34853, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149979200, versionId=6]. totalHandledRequests:10
2024-02-05T18:19:39,209 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:19:39,209 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-8e2f9f6969}, consumerId=4, consumerName=7a112, address=/127.0.0.1:45842}
2024-02-05T18:19:39,210 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-8e2f9f6969}, consumerId=4, consumerName=7a112, address=/127.0.0.1:45842}
2024-02-05T18:19:39,211 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:35181] Broker notification of Closed consumer: 4
2024-02-05T18:19:39,211 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-8e2f9f6969] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-8e2f9f6969, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:19:39,211 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-8e2f9f6969] Successfully closed dispatcher for reader
2024-02-05T18:19:39,211 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-8e2f9f6969] Closed connection [id: 0x8ac29796, L:/127.0.0.1:45842 - R:localhost/127.0.0.1:35181] -- Will try again in 0.1 s
2024-02-05T18:19:39,211 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-8e2f9f6969] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-8e2f9f6969, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:19:39,212 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-8e2f9f6969] Successfully disconnected and closed subscription
2024-02-05T18:19:39,212 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:19:39,212 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:19:39,212 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:19:39,214 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:19:39,214 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:19:39,215 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-8e2f9f6969] Closed Consumer (not connected)
2024-02-05T18:19:39,215 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 7.0 ms
2024-02-05T18:19:39,215 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-8e2f9f6969 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-8e2f9f6969 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:19:39,223 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34853 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:34853, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149979208, versionId=7]. totalHandledRequests:4
2024-02-05T18:19:39,223 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:19:39,224 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.028 seconds
2024-02-05T18:19:39,224 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:19:39,226 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:45842
2024-02-05T18:19:39,226 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:19:39,226 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-c1f5f64db5}, consumerId=0, consumerName=0e618, address=/127.0.0.1:45842}
2024-02-05T18:19:39,226 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:19:39,226 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c1f5f64db5] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-c1f5f64db5, ackPos=3:5, readPos=3:8}]
2024-02-05T18:19:39,226 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:34853/persistent/__change_events] Closing managed ledger
2024-02-05T18:19:39,226 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c1f5f64db5] Successfully closed dispatcher for reader
2024-02-05T18:19:39,227 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:19:39,227 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:34853/__change_events, name=reader-091c0e33f0}, consumerId=3, consumerName=75eb2, address=/127.0.0.1:45842}
2024-02-05T18:19:39,227 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:34853/__change_events][reader-091c0e33f0] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:34853/persistent/__change_events, cursor=reader-091c0e33f0, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:19:39,228 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:34853/__change_events][reader-091c0e33f0] Successfully closed dispatcher for reader
2024-02-05T18:19:39,228 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:19:39,228 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-4fcd8148b5}, consumerId=2, consumerName=53236, address=/127.0.0.1:45842}
2024-02-05T18:19:39,228 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-63a04606aa}, consumerId=1, consumerName=67b45, address=/127.0.0.1:45842}
2024-02-05T18:19:39,228 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x8ac29796, L:/127.0.0.1:45842 ! R:localhost/127.0.0.1:35181] Disconnected
2024-02-05T18:19:39,229 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x8ac29796, L:/127.0.0.1:45842 ! R:localhost/127.0.0.1:35181] -- Will try again in 0.1 s
2024-02-05T18:19:39,229 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x8ac29796, L:/127.0.0.1:45842 ! R:localhost/127.0.0.1:35181] -- Will try again in 0.1 s
2024-02-05T18:19:39,229 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x8ac29796, L:/127.0.0.1:45842 ! R:localhost/127.0.0.1:35181] -- Will try again in 0.1 s
2024-02-05T18:19:39,229 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-c1f5f64db5] Closed connection [id: 0x8ac29796, L:/127.0.0.1:45842 ! R:localhost/127.0.0.1:35181] -- Will try again in 0.1 s
2024-02-05T18:19:39,229 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:19:39,229 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-63a04606aa] Closed connection [id: 0x8ac29796, L:/127.0.0.1:45842 ! R:localhost/127.0.0.1:35181] -- Will try again in 0.1 s
2024-02-05T18:19:39,229 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:34853/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:19:39,229 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:34853/__change_events] [reader-091c0e33f0] Closed connection [id: 0x8ac29796, L:/127.0.0.1:45842 ! R:localhost/127.0.0.1:35181] -- Will try again in 0.1 s
2024-02-05T18:19:39,230 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:19:39,230 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-4fcd8148b5] Closed connection [id: 0x8ac29796, L:/127.0.0.1:45842 ! R:localhost/127.0.0.1:35181] -- Will try again in 0.1 s
2024-02-05T18:19:39,230 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:19:39,231 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:19:39,234 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:35181
2024-02-05T18:19:39,235 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:19:39,235 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:19:39,235 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:19:39,235 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-63a04606aa] Closed Consumer (not connected)
2024-02-05T18:19:39,236 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-4fcd8148b5] Closed Consumer (not connected)
2024-02-05T18:19:39,236 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-c1f5f64db5] Closed Consumer (not connected)
2024-02-05T18:19:39,236 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:34853/__change_events] [reader-091c0e33f0] Closed Consumer (not connected)
2024-02-05T18:19:39,236 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-63a04606aa was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-63a04606aa was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:19:39,237 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-4fcd8148b5 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-4fcd8148b5 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:19:39,238 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-c1f5f64db5 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-c1f5f64db5 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:19:39,238 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:34853/__change_events with subscription name reader-091c0e33f0 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:34853/__change_events with subscription name reader-091c0e33f0 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:19:39,240 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:19:39,241 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:19:39,241 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:19:39,241 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:19:39,241 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:19:39,241 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:19:39,242 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:19:39,242 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:19:40,629 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:19:40,630 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:19:40,631 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:19:40,632 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:19:40,632 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:19:40,632 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:19:40,639 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:19:40,639 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:19:40,643 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:19:40,643 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:19:40,643 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:19:40,643 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:19:40,643 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:19:40,644 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:19:40,644 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:19:40,644 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:19:40,644 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:19:40,644 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 191 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T18:19:40,644 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 8 new threads
2024-02-05T18:19:40,644 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:19:40,644 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@155c2a47
2024-02-05T18:19:40,644 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:19:40,645 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:19:40,645 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 37.061 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  01:02 min
[INFO] Finished at: 2024-02-05T18:19:41+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 3 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:20:11,138 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:20:12,067 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:20:12,069 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:20:12,526 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:20:12,527 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:20:12,528 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:20:12,529 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:20:12,529 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:20:12,530 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:20:12,550 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:20:12,551 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:20:12,552 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:20:12,552 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:20:12,553 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:20:12,554 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:20:12,554 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:20:12,555 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:20:12,555 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:20:12,556 - INFO  - [main:Environment@98] - Client environment:os.memory.free=30MB
2024-02-05T18:20:12,556 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:20:12,557 - INFO  - [main:Environment@98] - Client environment:os.memory.total=126MB
2024-02-05T18:20:14,101 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:20:14,102 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:20:14,102 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:20:14,103 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:20:14,449 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:20:14,451 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:20:14,533 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:20:14,615 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:20:14,618 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:20:14,638 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:20:14,745 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:20:14,786 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:20:14,833 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:20:15,263 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:20:15,264 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:20:15,301 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:20:15,365 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:38161, TLS: (none), listener: (none)
2024-02-05T18:20:15,692 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:38059, TLS: OPENSSL, listener: (none)
2024-02-05T18:20:15,715 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:20:15,720 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:20:15,720 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:20:15,754 - INFO  - [main:Log@170] - Logging initialized @6766ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:20:16,696 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:20:16,731 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:20:16,732 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:20:16,735 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:20:17,494 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1978b0d5{/,null,AVAILABLE}
2024-02-05T18:20:18,531 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/admin,null,AVAILABLE}
2024-02-05T18:20:19,786 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,AVAILABLE}
2024-02-05T18:20:20,181 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,AVAILABLE}
2024-02-05T18:20:20,292 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,AVAILABLE}
2024-02-05T18:20:20,456 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/topics,null,AVAILABLE}
2024-02-05T18:20:20,458 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,AVAILABLE}
2024-02-05T18:20:20,460 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6556471b{/static,null,AVAILABLE}
2024-02-05T18:20:20,475 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:44461}
2024-02-05T18:20:20,618 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:35211}
2024-02-05T18:20:20,618 - INFO  - [main:Server@415] - Started @11633ms
2024-02-05T18:20:20,619 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:44461
2024-02-05T18:20:20,620 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:35211
2024-02-05T18:20:20,628 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:20:20,629 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:20:20,763 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:44461
2024-02-05T18:20:20,778 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:20:20,784 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:44461 is changing the role from null to Leader
2024-02-05T18:20:20,785 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:44461).
2024-02-05T18:20:21,102 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:44461 
2024-02-05T18:20:21,590 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:20:21,622 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:20:21,738 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:20:21,744 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:20:21,757 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:20:21,763 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:20:21,804 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:20:21,834 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:20:21,863 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:20:21,923 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:20:21,944 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:20:21,952 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:20:21,954 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:20:21,982 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:20:21,989 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:20:21 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 544
2024-02-05T18:20:22,142 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x1bf93463, L:/127.0.0.1:48048 - R:localhost/127.0.0.1:38161]] Connected to server
2024-02-05T18:20:22,182 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:48048] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:20:22,255 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:20:22,261 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x1bf93463, L:/127.0.0.1:48048 - R:localhost/127.0.0.1:38161]
2024-02-05T18:20:22,321 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:20:22,358 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:48048] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:48048, producerName=test-0-0, producerId=0}
2024-02-05T18:20:22,367 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x1bf93463, L:/127.0.0.1:48048 - R:localhost/127.0.0.1:38161]
2024-02-05T18:20:22,369 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:20:22,429 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:20:22,430 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-288dc12f57] Subscribing to topic on cnx [id: 0x1bf93463, L:/127.0.0.1:48048 - R:localhost/127.0.0.1:38161], consumerId 0
2024-02-05T18:20:22,441 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x9a12f51c, L:/127.0.0.1:38161 - R:/127.0.0.1:48048]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-288dc12f57. consumerId: 0
2024-02-05T18:20:22,472 - INFO  - [pulsar-io-9-1:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-288dc12f57] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:20:22,473 - INFO  - [pulsar-io-9-1:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:20:22,473 - INFO  - [pulsar-io-9-1:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-288dc12f57, ackPos=3:-1, readPos=3:0}
2024-02-05T18:20:22,490 - INFO  - [pulsar-io-9-1:ServerCnx@1263] - [/127.0.0.1:48048] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-288dc12f57
2024-02-05T18:20:22,495 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-288dc12f57] Subscribed to topic on localhost/127.0.0.1:38161 -- consumer: 0
2024-02-05T18:20:22,504 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.008 seconds
2024-02-05T18:20:22,505 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:20:22,506 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:20:22,507 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:20:22,548 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:20:22,570 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:20:22,571 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:20:22,574 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:20:22,574 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:20:22 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 58
2024-02-05T18:20:22,588 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:20:22,603 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:20:22,604 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:20:22,606 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:20:22 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T18:20:22,607 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:20:22,633 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:20:22,636 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x1bf93463, L:/127.0.0.1:48048 - R:localhost/127.0.0.1:38161]
2024-02-05T18:20:22,644 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:20:22,651 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:48048] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:48048, producerName=test-0-1, producerId=1}
2024-02-05T18:20:22,653 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x1bf93463, L:/127.0.0.1:48048 - R:localhost/127.0.0.1:38161]
2024-02-05T18:20:22,670 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:20:22,672 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-3b0c89a14f] Subscribing to topic on cnx [id: 0x1bf93463, L:/127.0.0.1:48048 - R:localhost/127.0.0.1:38161], consumerId 1
2024-02-05T18:20:22,674 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x9a12f51c, L:/127.0.0.1:38161 - R:/127.0.0.1:48048]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-3b0c89a14f. consumerId: 1
2024-02-05T18:20:22,701 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-3b0c89a14f] Created new subscription for 1
2024-02-05T18:20:22,702 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:48048] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-3b0c89a14f
2024-02-05T18:20:22,706 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-3b0c89a14f] Subscribed to topic on localhost/127.0.0.1:38161 -- consumer: 1
2024-02-05T18:20:22,731 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:20:22,733 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x1bf93463, L:/127.0.0.1:48048 - R:localhost/127.0.0.1:38161]
2024-02-05T18:20:22,744 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:20:22,750 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:48048] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:48048, producerName=test-0-2, producerId=2}
2024-02-05T18:20:22,752 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x1bf93463, L:/127.0.0.1:48048 - R:localhost/127.0.0.1:38161]
2024-02-05T18:20:22,767 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:20:22,793 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:20:22,799 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:44461 started the ownership monitor.
2024-02-05T18:20:22,819 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:20:22,821 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-b5af654311] Subscribing to topic on cnx [id: 0x1bf93463, L:/127.0.0.1:48048 - R:localhost/127.0.0.1:38161], consumerId 2
2024-02-05T18:20:22,823 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x9a12f51c, L:/127.0.0.1:38161 - R:/127.0.0.1:48048]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-b5af654311. consumerId: 2
2024-02-05T18:20:22,837 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-b5af654311] Created new subscription for 2
2024-02-05T18:20:22,837 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:48048] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-b5af654311
2024-02-05T18:20:22,839 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-b5af654311] Subscribed to topic on localhost/127.0.0.1:38161 -- consumer: 2
2024-02-05T18:20:22,840 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:44461 plays the leader now.
2024-02-05T18:20:22,846 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 54.10%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 54.10%, msgThroughputEMA= 0.00, updatedAt= 1707150022845, reportedAt= 0
2024-02-05T18:20:22,854 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:44461/__change_events
2024-02-05T18:20:22,871 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:20:22,883 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:20:22,888 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 1.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:20:22,971 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:44461/0x00000000_0xffffffff - localhost:44461.
2024-02-05T18:20:22,976 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:44461/__change_events][reader-d3bd96c5d8] Subscribing to topic on cnx [id: 0x1bf93463, L:/127.0.0.1:48048 - R:localhost/127.0.0.1:38161], consumerId 3
2024-02-05T18:20:22,977 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:44461/0x00000000_0xffffffff
2024-02-05T18:20:22,978 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x9a12f51c, L:/127.0.0.1:38161 - R:/127.0.0.1:48048]] Subscribing on topic persistent://sla-monitor/test/localhost:44461/__change_events / reader-d3bd96c5d8. consumerId: 3
2024-02-05T18:20:22,984 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:44461
2024-02-05T18:20:22,985 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:44461/0x00000000_0xffffffff - localhost:44461.
2024-02-05T18:20:22,987 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:44461/0x00000000_0xffffffff
2024-02-05T18:20:22,989 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:44461
2024-02-05T18:20:22,992 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:44461/persistent/__change_events
2024-02-05T18:20:22,998 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:44461/persistent/__change_events'
2024-02-05T18:20:23,004 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:20:23,004 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:44461 doesn't exist.
2024-02-05T18:20:23,005 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:44461/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:20:23,013 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:44461/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:20:23,026 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:44461/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:20:23,029 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:44461/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:44461/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:20:23,030 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:44461/__change_events - dedup is disabled
2024-02-05T18:20:23,040 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:20:23,046 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:44461/__change_events][reader-d3bd96c5d8] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:20:23,047 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:44461/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:20:23,047 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:44461/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:44461/persistent/__change_events, cursor=reader-d3bd96c5d8, ackPos=7:-1, readPos=7:0}
2024-02-05T18:20:23,049 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:48048] Created subscription on topic persistent://sla-monitor/test/localhost:44461/__change_events / reader-d3bd96c5d8
2024-02-05T18:20:23,050 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:44461/__change_events][reader-d3bd96c5d8] Subscribed to topic on localhost/127.0.0.1:38161 -- consumer: 3
2024-02-05T18:20:23,029 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 44461, tls-port = Optional[35211], broker url= pulsar://localhost:38161, broker tls url= pulsar+ssl://localhost:38059, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[38161], brokerServicePortTls=Optional[38059], webServicePort=Optional[44461], webServicePortTls=Optional[35211], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:20:23,582 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:20:23,582 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:20:23,582 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:20:23,583 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:20:23,588 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:20:23,588 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:20:23,593 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:20:23,596 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:20:23,601 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:20:23,602 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:20:23,607 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:20:23,612 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:20:23,616 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:20:23,623 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:20:23,623 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:20:23,627 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:20:23,630 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:40617, TLS: (none), listener: (none)
2024-02-05T18:20:23,632 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:39009, TLS: OPENSSL, listener: (none)
2024-02-05T18:20:23,637 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:20:23,638 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:20:23,639 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:20:23,654 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:20:23,657 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:20:23,657 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:20:23,658 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:20:23,762 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@4a842e8a{/,null,AVAILABLE}
2024-02-05T18:20:23,889 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:20:23,890 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:20:24,365 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/admin,null,AVAILABLE}
2024-02-05T18:20:24,891 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:20:24,891 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:20:25,507 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/admin/v2,null,AVAILABLE}
2024-02-05T18:20:25,723 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/admin/v3,null,AVAILABLE}
2024-02-05T18:20:25,796 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@554f6e30{/lookup,null,AVAILABLE}
2024-02-05T18:20:25,892 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:20:25,893 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:20:25,902 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/topics,null,AVAILABLE}
2024-02-05T18:20:25,903 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7537f638{/metrics,null,AVAILABLE}
2024-02-05T18:20:25,904 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6b909973{/static,null,AVAILABLE}
2024-02-05T18:20:25,906 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@3af4b14e{HTTP/1.1, (http/1.1)}{0.0.0.0:41827}
2024-02-05T18:20:25,918 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@36b6ce5d{SSL, (ssl, http/1.1)}{0.0.0.0:44913}
2024-02-05T18:20:25,919 - INFO  - [main:Server@415] - Started @16933ms
2024-02-05T18:20:25,919 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:41827
2024-02-05T18:20:25,922 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:44913
2024-02-05T18:20:25,929 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:20:25,931 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:20:25,947 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:41827
2024-02-05T18:20:25,949 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:41827 registry has been created.
2024-02-05T18:20:25,950 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:41827. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:20:25,952 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:41827 is changing the role from null to Follower
2024-02-05T18:20:25,957 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:44461).
2024-02-05T18:20:25,962 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:20:25,983 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:41827 
2024-02-05T18:20:26,108 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:20:26 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 59
2024-02-05T18:20:26,128 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:20:26,131 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:20:26,132 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:20:26,143 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:20:26 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 29
2024-02-05T18:20:26,148 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:41827/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:20:26,158 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x9a82eb01, L:/127.0.0.1:52572 - R:localhost/127.0.0.1:40617]] Connected to server
2024-02-05T18:20:26,164 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:52572] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:20:26,181 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xc3e88a83, L:/127.0.0.1:48064 - R:localhost/127.0.0.1:38161]] Connected to server
2024-02-05T18:20:26,185 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:48064] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:20:26,186 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xc3e88a83, L:/127.0.0.1:48064 - R:localhost/127.0.0.1:38161]
2024-02-05T18:20:26,200 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:48064] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:48064, producerName=test-0-3, producerId=0}
2024-02-05T18:20:26,201 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0xc3e88a83, L:/127.0.0.1:48064 - R:localhost/127.0.0.1:38161]
2024-02-05T18:20:26,217 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-b1a6155450] Subscribing to topic on cnx [id: 0xc3e88a83, L:/127.0.0.1:48064 - R:localhost/127.0.0.1:38161], consumerId 0
2024-02-05T18:20:26,219 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xee9f0895, L:/127.0.0.1:38161 - R:/127.0.0.1:48064]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-b1a6155450. consumerId: 0
2024-02-05T18:20:26,224 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-b1a6155450] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:20:26,225 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:20:26,225 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-b1a6155450, ackPos=3:-1, readPos=3:0}
2024-02-05T18:20:26,227 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:48064] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-b1a6155450
2024-02-05T18:20:26,228 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-b1a6155450] Subscribed to topic on localhost/127.0.0.1:38161 -- consumer: 0
2024-02-05T18:20:26,231 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:20:26,232 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:20:26,266 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:20:26 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 29
2024-02-05T18:20:26,269 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:20:26,272 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:20:26,273 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:20:26,278 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:41827/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:20:26,279 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:20:26 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T18:20:26,292 - INFO  - [pulsar-web-84-7:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:20:26 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 9
2024-02-05T18:20:26,301 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:20:26,304 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:20:26,304 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:20:26,308 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:20:26 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T18:20:26,309 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:41827/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:20:26,324 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xc3e88a83, L:/127.0.0.1:48064 - R:localhost/127.0.0.1:38161]
2024-02-05T18:20:26,333 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:48064] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:48064, producerName=test-0-4, producerId=1}
2024-02-05T18:20:26,334 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0xc3e88a83, L:/127.0.0.1:48064 - R:localhost/127.0.0.1:38161]
2024-02-05T18:20:26,348 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-26efc10419] Subscribing to topic on cnx [id: 0xc3e88a83, L:/127.0.0.1:48064 - R:localhost/127.0.0.1:38161], consumerId 1
2024-02-05T18:20:26,349 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xee9f0895, L:/127.0.0.1:38161 - R:/127.0.0.1:48064]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-26efc10419. consumerId: 1
2024-02-05T18:20:26,361 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-26efc10419] Created new subscription for 1
2024-02-05T18:20:26,361 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:48064] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-26efc10419
2024-02-05T18:20:26,362 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-26efc10419] Subscribed to topic on localhost/127.0.0.1:38161 -- consumer: 1
2024-02-05T18:20:26,380 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xc3e88a83, L:/127.0.0.1:48064 - R:localhost/127.0.0.1:38161]
2024-02-05T18:20:26,388 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:48064] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:48064, producerName=test-0-5, producerId=2}
2024-02-05T18:20:26,390 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0xc3e88a83, L:/127.0.0.1:48064 - R:localhost/127.0.0.1:38161]
2024-02-05T18:20:26,392 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:20:26,396 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:20:26,397 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:41827 plays a follower now.
2024-02-05T18:20:26,418 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:41827/__change_events
2024-02-05T18:20:26,438 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:41827/0x00000000_0xffffffff - localhost:41827.
2024-02-05T18:20:26,439 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:41827
2024-02-05T18:20:26,440 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:41827/0x00000000_0xffffffff - localhost:41827.
2024-02-05T18:20:26,439 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:41827/0x00000000_0xffffffff
2024-02-05T18:20:26,441 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:41827/0x00000000_0xffffffff
2024-02-05T18:20:26,442 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:41827
2024-02-05T18:20:26,444 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:41827 doesn't exist.
2024-02-05T18:20:26,448 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:41827/__change_events][reader-7c0ff5a305] Subscribing to topic on cnx [id: 0x9a82eb01, L:/127.0.0.1:52572 - R:localhost/127.0.0.1:40617], consumerId 2
2024-02-05T18:20:26,448 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=2, bootstrap service port = 41827, tls-port = Optional[44913], broker url= pulsar://localhost:40617, broker tls url= pulsar+ssl://localhost:39009, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[40617], brokerServicePortTls=Optional[39009], webServicePort=Optional[41827], webServicePortTls=Optional[44913], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:20:26,450 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x5dd09594, L:/127.0.0.1:40617 - R:/127.0.0.1:52572]] Subscribing on topic persistent://sla-monitor/test/localhost:41827/__change_events / reader-7c0ff5a305. consumerId: 2
2024-02-05T18:20:26,458 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:41827/persistent/__change_events
2024-02-05T18:20:26,460 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:41827/persistent/__change_events'
2024-02-05T18:20:26,470 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:20:26,472 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:41827/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:20:26,475 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:41827/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:20:26,481 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:41827/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:20:26,487 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:41827/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:41827/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:20:26,488 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:41827/__change_events - dedup is disabled
2024-02-05T18:20:26,500 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:20:26,508 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:41827/__change_events][reader-7c0ff5a305] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:20:26,508 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:41827/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:20:26,509 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:41827/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:41827/persistent/__change_events, cursor=reader-7c0ff5a305, ackPos=9:-1, readPos=9:0}
2024-02-05T18:20:26,511 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:52572] Created subscription on topic persistent://sla-monitor/test/localhost:41827/__change_events / reader-7c0ff5a305
2024-02-05T18:20:26,512 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:41827/__change_events][reader-7c0ff5a305] Subscribed to topic on localhost/127.0.0.1:40617 -- consumer: 2
2024-02-05T18:20:26,663 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:20:26,664 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:20:26 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T18:20:26,692 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:20:26,695 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:20:26 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:20:26,717 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:20:26,719 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:20:26,724 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:20:26,725 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:20:26 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:20:26,748 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:20:26,749 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:20:26,751 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:20:26,753 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:20:26 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:20:26,753 - INFO  - [pulsar-62-1:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:20:26,757 - INFO  - [pulsar-7-2:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:20:26,762 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:20:26,764 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:20:26,768 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:20:26,769 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:20:26 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T18:20:26,783 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:20:26,783 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:20:26,783 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:20:26,784 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:20:26 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T18:20:26,790 - INFO  - [pulsar-62-3:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:20:26,794 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:20:26,824 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:20:26,833 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:20:26,833 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:20:26,848 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:20:26,860 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:20:26,881 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:44461 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:20:26,894 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:20:26,914 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 19.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:20:26,927 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44461 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:44461, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150026883, versionId=1]. totalHandledRequests:1
2024-02-05T18:20:26,959 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44461 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:44461, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150026948, versionId=2]. totalHandledRequests:1
2024-02-05T18:20:26,963 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:20:26,986 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:20:26,992 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:20:26,993 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:20:27,022 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44461 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:44461, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150026975, versionId=3]. totalHandledRequests:1
2024-02-05T18:20:27,027 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:20:27,035 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 12.0 ms
2024-02-05T18:20:27,044 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44461 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:44461, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150027022, versionId=4]. totalHandledRequests:1
2024-02-05T18:20:27,048 - WARN  - [ForkJoinPool.commonPool-worker-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:44461. Skipping this broker. Phase one
2024-02-05T18:20:27,048 - WARN  - [ForkJoinPool.commonPool-worker-1:LeastResourceUsageWithWeight@126] - There is no broker load data for broker:localhost:44461. Skipping this broker. Phase two
2024-02-05T18:20:27,049 - INFO  - [broker-client-shared-internal-executor-11-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:44461 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:20:27,050 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:20:27,050 - INFO  - [broker-client-shared-internal-executor-11-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:20:27,053 - INFO  - [AsyncHttpClient-37-1:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:20:27,054 - INFO  - [AsyncHttpClient-37-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:20:26 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 234
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:20:27,065 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:20:26 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 219
2024-02-05T18:20:27,066 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44461 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:44461, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150027049, versionId=5]. totalHandledRequests:2
2024-02-05T18:20:27,075 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44461 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:44461, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150027066, versionId=6]. totalHandledRequests:2
2024-02-05T18:20:27,077 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-dacdb40ce6] Subscribing to topic on cnx [id: 0x1bf93463, L:/127.0.0.1:48048 - R:localhost/127.0.0.1:38161], consumerId 4
2024-02-05T18:20:27,079 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:20:27,079 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x9a12f51c, L:/127.0.0.1:38161 - R:/127.0.0.1:48048]] Subscribing on topic persistent://public/test/__change_events / reader-dacdb40ce6. consumerId: 4
2024-02-05T18:20:27,090 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:20:27,093 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:20:27,099 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:20:27,100 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:20:27,108 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:20:27,153 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:20:27,155 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:20:27,158 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:20:27,167 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:20:27,167 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:20:27,169 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-fb6873fe9f] Subscribing to topic on cnx [id: 0x1bf93463, L:/127.0.0.1:48048 - R:localhost/127.0.0.1:38161], consumerId 5
2024-02-05T18:20:27,171 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x9a12f51c, L:/127.0.0.1:38161 - R:/127.0.0.1:48048]] Subscribing on topic persistent://public/test/__change_events / reader-fb6873fe9f. consumerId: 5
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19b094d1], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31486e5] 
2024-02-05T18:20:27,175 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-dacdb40ce6] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:20:27,176 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:20:27,176 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-dacdb40ce6, ackPos=11:-1, readPos=11:0}
2024-02-05T18:20:27,178 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:48048] Created subscription on topic persistent://public/test/__change_events / reader-dacdb40ce6
2024-02-05T18:20:27,181 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-dacdb40ce6] Subscribed to topic on localhost/127.0.0.1:38161 -- consumer: 4
2024-02-05T18:20:27,185 - INFO  - [pulsar-io-9-1:ServerCnx@2007] - [/127.0.0.1:48048] Closing consumer: consumerId=4
2024-02-05T18:20:27,185 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-dacdb40ce6}, consumerId=4, consumerName=e721c, address=/127.0.0.1:48048}
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19b094d1, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6b17ac0], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31486e5, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@36583474] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19b094d1, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6b17ac0, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2b533872], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31486e5, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@36583474, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c57b053] 
2024-02-05T18:20:27,193 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-fb6873fe9f] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:20:27,193 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:20:27,193 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-fb6873fe9f, ackPos=11:-1, readPos=11:0}
2024-02-05T18:20:27,194 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-dacdb40ce6] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-dacdb40ce6, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:20:27,195 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-dacdb40ce6] Successfully closed dispatcher for reader
2024-02-05T18:20:27,195 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:48048] Created subscription on topic persistent://public/test/__change_events / reader-fb6873fe9f
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19b094d1, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6b17ac0, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2b533872, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13dac63], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31486e5, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@36583474, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c57b053, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7631c3a4] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19b094d1, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6b17ac0, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2b533872, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13dac63, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4413e5b8], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31486e5, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@36583474, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c57b053, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7631c3a4, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@75771041] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19b094d1, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6b17ac0, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2b533872, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13dac63, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4413e5b8, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19c5e438], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31486e5, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@36583474, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c57b053, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7631c3a4, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@75771041, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@61912847] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19b094d1, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6b17ac0, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2b533872, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13dac63, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4413e5b8, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19c5e438, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a743fe8], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31486e5, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@36583474, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c57b053, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7631c3a4, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@75771041, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@61912847, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@77ccc5ff] 
2024-02-05T18:20:27,210 - INFO  - [pulsar-io-9-1:ServerCnx@2043] - [/127.0.0.1:48048] Closed consumer, consumerId=4
2024-02-05T18:20:27,211 - INFO  - [pulsar-io-9-4:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-dacdb40ce6] Closed consumer
2024-02-05T18:20:27,213 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-fb6873fe9f] Subscribed to topic on localhost/127.0.0.1:38161 -- consumer: 5
2024-02-05T18:20:27,213 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:20:27,215 - INFO  - [pulsar-io-9-1:ServerCnx@2007] - [/127.0.0.1:48048] Closing consumer: consumerId=5
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:20:27,216 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-fb6873fe9f}, consumerId=5, consumerName=853d3, address=/127.0.0.1:48048}
2024-02-05T18:20:27,216 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-fb6873fe9f] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-fb6873fe9f, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:20:27,217 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-fb6873fe9f] Successfully closed dispatcher for reader
2024-02-05T18:20:27,224 - INFO  - [pulsar-io-9-1:ServerCnx@2043] - [/127.0.0.1:48048] Closed consumer, consumerId=5
2024-02-05T18:20:27,225 - INFO  - [pulsar-io-9-4:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-fb6873fe9f] Closed consumer
2024-02-05T18:20:27,226 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:20:27,243 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:20:27,251 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@3af4b14e{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:20:27,252 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@36b6ce5d{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:20:27,252 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:20:27,254 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6b909973{/static,null,STOPPED}
2024-02-05T18:20:27,255 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7537f638{/metrics,null,STOPPED}
2024-02-05T18:20:27,263 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/topics,null,STOPPED}
2024-02-05T18:20:27,270 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@554f6e30{/lookup,null,STOPPED}
2024-02-05T18:20:27,272 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/admin/v3,null,STOPPED}
2024-02-05T18:20:27,275 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/admin/v2,null,STOPPED}
2024-02-05T18:20:27,277 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/admin,null,STOPPED}
2024-02-05T18:20:27,280 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@4a842e8a{/,null,STOPPED}
2024-02-05T18:20:27,284 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:20:27,286 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:20:27,287 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:20:27,289 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:41827
2024-02-05T18:20:27,294 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:41827 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:20:27,302 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:41827 was invalidated. state Releasing
2024-02-05T18:20:27,304 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:41827 registry has been deleted.
2024-02-05T18:20:27,304 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:41827 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:20:27,305 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:41827. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:20:27,306 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:41827
2024-02-05T18:20:27,307 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:41827 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:20:27,308 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:41827
2024-02-05T18:20:27,309 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:41827 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:20:27,320 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:41827/0x00000000_0xffffffff.
2024-02-05T18:20:27,322 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:41827/0x00000000_0xffffffff.
2024-02-05T18:20:27,323 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:41827/0x00000000_0xffffffff.
2024-02-05T18:20:27,324 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.016 seconds
2024-02-05T18:20:27,326 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:20:27,332 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xc3e88a83, L:/127.0.0.1:48064 ! R:localhost/127.0.0.1:38161] Disconnected
2024-02-05T18:20:27,334 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x9a82eb01, L:/127.0.0.1:52572 ! R:localhost/127.0.0.1:40617] Disconnected
2024-02-05T18:20:27,335 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:41827/__change_events] [reader-7c0ff5a305] Closed connection [id: 0x9a82eb01, L:/127.0.0.1:52572 ! R:localhost/127.0.0.1:40617] -- Will try again in 0.1 s
2024-02-05T18:20:27,335 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:52572
2024-02-05T18:20:27,335 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:48064
2024-02-05T18:20:27,336 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:41827/__change_events, name=reader-7c0ff5a305}, consumerId=2, consumerName=a551b, address=/127.0.0.1:52572}
2024-02-05T18:20:27,336 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:20:27,337 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:41827/__change_events][reader-7c0ff5a305] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:41827/persistent/__change_events, cursor=reader-7c0ff5a305, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:20:27,337 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:41827/__change_events][reader-7c0ff5a305] Successfully closed dispatcher for reader
2024-02-05T18:20:27,338 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0xc3e88a83, L:/127.0.0.1:48064 ! R:localhost/127.0.0.1:38161] -- Will try again in 0.1 s
2024-02-05T18:20:27,339 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0xc3e88a83, L:/127.0.0.1:48064 ! R:localhost/127.0.0.1:38161] -- Will try again in 0.1 s
2024-02-05T18:20:27,339 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0xc3e88a83, L:/127.0.0.1:48064 ! R:localhost/127.0.0.1:38161] -- Will try again in 0.1 s
2024-02-05T18:20:27,339 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-b1a6155450] Closed connection [id: 0xc3e88a83, L:/127.0.0.1:48064 ! R:localhost/127.0.0.1:38161] -- Will try again in 0.1 s
2024-02-05T18:20:27,339 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-26efc10419] Closed connection [id: 0xc3e88a83, L:/127.0.0.1:48064 ! R:localhost/127.0.0.1:38161] -- Will try again in 0.1 s
2024-02-05T18:20:27,340 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-b1a6155450}, consumerId=0, consumerName=4878c, address=/127.0.0.1:48064}
2024-02-05T18:20:27,340 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-b1a6155450] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-b1a6155450, ackPos=3:5, readPos=3:6}]
2024-02-05T18:20:27,341 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-b1a6155450] Successfully closed dispatcher for reader
2024-02-05T18:20:27,341 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:41827/persistent/__change_events] Closing managed ledger
2024-02-05T18:20:27,341 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-26efc10419}, consumerId=1, consumerName=39134, address=/127.0.0.1:48064}
2024-02-05T18:20:27,346 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:41827/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:20:27,346 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:20:27,347 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:20:27,349 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:20:27,355 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:40617
2024-02-05T18:20:27,356 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:20:27,358 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:20:27,358 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:20:27,359 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-b1a6155450] Closed Consumer (not connected)
2024-02-05T18:20:27,360 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-b1a6155450 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-b1a6155450 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:20:27,362 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:41827/__change_events] [reader-7c0ff5a305] Closed Consumer (not connected)
2024-02-05T18:20:27,363 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:41827/__change_events with subscription name reader-7c0ff5a305 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:41827/__change_events with subscription name reader-7c0ff5a305 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:20:27,366 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-26efc10419] Closed Consumer (not connected)
2024-02-05T18:20:27,366 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-26efc10419 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-26efc10419 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:20:27,374 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:20:27,374 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:20:27,378 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:20:27,379 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:20:27,387 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:20:27,388 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:20:27,788 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:20:27,789 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 45.31%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 45.31%, msgThroughputEMA= 0.00, updatedAt= 1707150027788, reportedAt= 0
2024-02-05T18:20:27,918 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:20:27,918 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:20:28,644 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:20:28,644 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:20:28,647 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:20:28,647 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:20:28,648 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:20:28,648 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:20:28,919 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:20:28,920 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:20:29,921 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:20:29,921 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:20:30,660 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:20:30,661 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:20:30,662 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:20:30,662 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:20:30,662 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6556471b{/static,null,STOPPED}
2024-02-05T18:20:30,663 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,STOPPED}
2024-02-05T18:20:30,664 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/topics,null,STOPPED}
2024-02-05T18:20:30,665 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,STOPPED}
2024-02-05T18:20:30,666 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,STOPPED}
2024-02-05T18:20:30,668 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,STOPPED}
2024-02-05T18:20:30,669 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/admin,null,STOPPED}
2024-02-05T18:20:30,670 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1978b0d5{/,null,STOPPED}
2024-02-05T18:20:30,671 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:20:30,673 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:20:30,673 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:20:30,674 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:44461
2024-02-05T18:20:30,677 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:44461, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150027066, versionId=6]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:20:35,687 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:44461 in 5011.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:20:35,693 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:44461 was invalidated. state Releasing
2024-02-05T18:20:35,693 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:44461. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:20:35,693 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:44461
2024-02-05T18:20:35,697 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:44461/0x00000000_0xffffffff.
2024-02-05T18:20:35,705 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44461 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:44461, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150035698, versionId=7]. totalHandledRequests:10
2024-02-05T18:20:35,706 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:20:35,708 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:20:35,708 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:20:35,709 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:20:35,713 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:20:35,718 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:20:35,719 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 14.0 ms
2024-02-05T18:20:35,727 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44461 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:44461, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150035705, versionId=8]. totalHandledRequests:4
2024-02-05T18:20:35,727 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:20:35,728 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:44461/0x00000000_0xffffffff.
2024-02-05T18:20:35,730 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:44461/0x00000000_0xffffffff.
2024-02-05T18:20:35,730 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.036 seconds
2024-02-05T18:20:35,730 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:20:35,731 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x1bf93463, L:/127.0.0.1:48048 ! R:localhost/127.0.0.1:38161] Disconnected
2024-02-05T18:20:35,731 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x1bf93463, L:/127.0.0.1:48048 ! R:localhost/127.0.0.1:38161] -- Will try again in 0.1 s
2024-02-05T18:20:35,732 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:48048
2024-02-05T18:20:35,732 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x1bf93463, L:/127.0.0.1:48048 ! R:localhost/127.0.0.1:38161] -- Will try again in 0.1 s
2024-02-05T18:20:35,732 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x1bf93463, L:/127.0.0.1:48048 ! R:localhost/127.0.0.1:38161] -- Will try again in 0.1 s
2024-02-05T18:20:35,732 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-288dc12f57}, consumerId=0, consumerName=025bc, address=/127.0.0.1:48048}
2024-02-05T18:20:35,732 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-288dc12f57] Closed connection [id: 0x1bf93463, L:/127.0.0.1:48048 ! R:localhost/127.0.0.1:38161] -- Will try again in 0.1 s
2024-02-05T18:20:35,732 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-3b0c89a14f] Closed connection [id: 0x1bf93463, L:/127.0.0.1:48048 ! R:localhost/127.0.0.1:38161] -- Will try again in 0.1 s
2024-02-05T18:20:35,732 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:44461/__change_events] [reader-d3bd96c5d8] Closed connection [id: 0x1bf93463, L:/127.0.0.1:48048 ! R:localhost/127.0.0.1:38161] -- Will try again in 0.1 s
2024-02-05T18:20:35,733 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-b5af654311] Closed connection [id: 0x1bf93463, L:/127.0.0.1:48048 ! R:localhost/127.0.0.1:38161] -- Will try again in 0.1 s
2024-02-05T18:20:35,732 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-288dc12f57] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-288dc12f57, ackPos=3:6, readPos=3:8}]
2024-02-05T18:20:35,733 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-288dc12f57] Successfully closed dispatcher for reader
2024-02-05T18:20:35,734 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:44461/__change_events, name=reader-d3bd96c5d8}, consumerId=3, consumerName=2d505, address=/127.0.0.1:48048}
2024-02-05T18:20:35,734 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:44461/__change_events][reader-d3bd96c5d8] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:44461/persistent/__change_events, cursor=reader-d3bd96c5d8, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:20:35,734 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:44461/__change_events][reader-d3bd96c5d8] Successfully closed dispatcher for reader
2024-02-05T18:20:35,735 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-b5af654311}, consumerId=2, consumerName=c6afe, address=/127.0.0.1:48048}
2024-02-05T18:20:35,735 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-3b0c89a14f}, consumerId=1, consumerName=749b4, address=/127.0.0.1:48048}
2024-02-05T18:20:35,738 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:20:35,738 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:20:35,739 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:44461/persistent/__change_events] Closing managed ledger
2024-02-05T18:20:35,739 - WARN  - [pulsar-io-9-1:ServerCnx@407] - [/127.0.0.1:48048] Got exception java.util.concurrent.RejectedExecutionException: event executor terminated
	at io.netty.util.concurrent.SingleThreadEventExecutor.reject(SingleThreadEventExecutor.java:934)
	at io.netty.util.concurrent.SingleThreadEventExecutor.offerTask(SingleThreadEventExecutor.java:351)
	at io.netty.util.concurrent.SingleThreadEventExecutor.addTask(SingleThreadEventExecutor.java:344)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:836)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute0(SingleThreadEventExecutor.java:827)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:817)
	at io.netty.util.concurrent.AbstractEventExecutorGroup.execute(AbstractEventExecutorGroup.java:115)
	at java.base/java.util.concurrent.CompletableFuture.asyncRunStage(CompletableFuture.java:1818)
	at java.base/java.util.concurrent.CompletableFuture.runAsync(CompletableFuture.java:2033)
	at org.apache.pulsar.broker.service.nonpersistent.NonPersistentTopic.unsubscribe(NonPersistentTopic.java:1151)
	at org.apache.pulsar.broker.service.nonpersistent.NonPersistentSubscription.removeConsumer(NonPersistentSubscription.java:189)
	at org.apache.pulsar.broker.service.Consumer.close(Consumer.java:400)
	at org.apache.pulsar.broker.service.Consumer.close(Consumer.java:396)
	at org.apache.pulsar.broker.service.ServerCnx.lambda$channelInactive$1(ServerCnx.java:378)
	at org.apache.pulsar.common.util.collections.ConcurrentLongHashMap$Section.forEach(ConcurrentLongHashMap.java:562)
	at org.apache.pulsar.common.util.collections.ConcurrentLongHashMap.forEach(ConcurrentLongHashMap.java:242)
	at org.apache.pulsar.broker.service.ServerCnx.channelInactive(ServerCnx.java:369)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.handler.flow.FlowControlHandler.channelInactive(FlowControlHandler.java:134)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.handler.codec.ByteToMessageDecoder.channelInputClosed(ByteToMessageDecoder.java:411)
	at io.netty.handler.codec.ByteToMessageDecoder.channelInactive(ByteToMessageDecoder.java:376)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:413)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:840)

2024-02-05T18:20:35,743 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:44461/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:20:35,743 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:20:35,744 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:20:35,745 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:20:35,745 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:20:35,749 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:38161
2024-02-05T18:20:35,750 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:20:35,750 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:20:35,750 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:20:35,750 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-3b0c89a14f] Closed Consumer (not connected)
2024-02-05T18:20:35,750 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-288dc12f57] Closed Consumer (not connected)
2024-02-05T18:20:35,750 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:44461/__change_events] [reader-d3bd96c5d8] Closed Consumer (not connected)
2024-02-05T18:20:35,750 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-b5af654311] Closed Consumer (not connected)
2024-02-05T18:20:35,750 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-3b0c89a14f was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-3b0c89a14f was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:20:35,751 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-288dc12f57 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-288dc12f57 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:20:35,751 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:44461/__change_events with subscription name reader-d3bd96c5d8 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:44461/__change_events with subscription name reader-d3bd96c5d8 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:20:35,752 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-b5af654311 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-b5af654311 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:20:35,755 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:20:35,755 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:20:35,755 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:20:35,755 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:20:35,756 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:20:35,756 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:20:35,758 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:20:35,758 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:20:37,044 - INFO  - [globalEventExecutor-10-7:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:20:37,045 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:20:37,047 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:20:37,047 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:20:37,047 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:20:37,047 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:20:37,055 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:20:37,055 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:20:37,059 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:20:37,059 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:20:37,059 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:20:37,059 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-2,5,main]'
2024-02-05T18:20:37,060 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:20:37,060 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:20:37,060 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:20:37,060 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:20:37,060 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:20:37,060 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:20:37,060 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 190 with name 'Thread[globalEventExecutor-10-7,5,main]'
2024-02-05T18:20:37,060 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:20:37,060 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:20:37,060 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@155c2a47
2024-02-05T18:20:37,061 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:20:37,061 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:20:37,061 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 27.665 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  53.131 s
[INFO] Finished at: 2024-02-05T18:20:37+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 4 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:21:08,344 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:21:09,340 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:21:09,342 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:21:09,792 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:21:09,793 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:21:09,794 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:21:09,795 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:21:09,795 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:21:09,796 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:21:09,816 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:21:09,816 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:21:09,817 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:21:09,817 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:21:09,818 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:21:09,819 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:21:09,819 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:21:09,820 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:21:09,820 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:21:09,822 - INFO  - [main:Environment@98] - Client environment:os.memory.free=26MB
2024-02-05T18:21:09,823 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:21:09,823 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:21:11,395 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:21:11,395 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:21:11,396 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:21:11,396 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:21:11,758 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:21:11,759 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:21:11,841 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:21:11,933 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:21:11,936 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:21:11,957 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:21:12,059 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:21:12,102 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:21:12,147 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:21:12,563 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:21:12,564 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:21:12,595 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:21:12,654 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:39525, TLS: (none), listener: (none)
2024-02-05T18:21:12,993 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:33083, TLS: OPENSSL, listener: (none)
2024-02-05T18:21:13,014 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:21:13,020 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:21:13,020 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:21:13,052 - INFO  - [main:Log@170] - Logging initialized @6906ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:21:14,076 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:21:14,116 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:21:14,117 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:21:14,120 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:21:15,006 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1978b0d5{/,null,AVAILABLE}
2024-02-05T18:21:16,120 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/admin,null,AVAILABLE}
2024-02-05T18:21:17,413 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,AVAILABLE}
2024-02-05T18:21:17,817 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,AVAILABLE}
2024-02-05T18:21:17,929 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,AVAILABLE}
2024-02-05T18:21:18,132 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/topics,null,AVAILABLE}
2024-02-05T18:21:18,134 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,AVAILABLE}
2024-02-05T18:21:18,137 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6556471b{/static,null,AVAILABLE}
2024-02-05T18:21:18,154 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:39543}
2024-02-05T18:21:18,306 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:37015}
2024-02-05T18:21:18,306 - INFO  - [main:Server@415] - Started @12162ms
2024-02-05T18:21:18,307 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:39543
2024-02-05T18:21:18,308 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:37015
2024-02-05T18:21:18,316 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:21:18,317 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:21:18,512 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:39543
2024-02-05T18:21:18,532 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:21:18,536 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:39543 is changing the role from null to Leader
2024-02-05T18:21:18,540 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:39543).
2024-02-05T18:21:18,878 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:39543 
2024-02-05T18:21:19,344 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:21:19,376 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:21:19,493 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:21:19,497 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:21:19,513 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:21:19,517 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:21:19,574 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:21:19,606 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:21:19,643 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:21:19,717 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:21:19,743 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:21:19,756 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:21:19,759 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:21:19,792 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:21:19,794 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:19 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 597
2024-02-05T18:21:19,944 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0xbbf5e0ba, L:/127.0.0.1:37344 - R:localhost/127.0.0.1:39525]] Connected to server
2024-02-05T18:21:19,984 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:37344] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:21:20,057 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:21:20,067 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xbbf5e0ba, L:/127.0.0.1:37344 - R:localhost/127.0.0.1:39525]
2024-02-05T18:21:20,157 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:21:20,193 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:37344] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:37344, producerName=test-0-0, producerId=0}
2024-02-05T18:21:20,203 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0xbbf5e0ba, L:/127.0.0.1:37344 - R:localhost/127.0.0.1:39525]
2024-02-05T18:21:20,205 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:21:20,255 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:21:20,256 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7db7916a68] Subscribing to topic on cnx [id: 0xbbf5e0ba, L:/127.0.0.1:37344 - R:localhost/127.0.0.1:39525], consumerId 0
2024-02-05T18:21:20,267 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x7b90e917, L:/127.0.0.1:39525 - R:/127.0.0.1:37344]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-7db7916a68. consumerId: 0
2024-02-05T18:21:20,302 - INFO  - [pulsar-io-9-1:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7db7916a68] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:21:20,303 - INFO  - [pulsar-io-9-1:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:21:20,304 - INFO  - [pulsar-io-9-1:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-7db7916a68, ackPos=3:-1, readPos=3:0}
2024-02-05T18:21:20,321 - INFO  - [pulsar-io-9-1:ServerCnx@1263] - [/127.0.0.1:37344] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-7db7916a68
2024-02-05T18:21:20,326 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7db7916a68] Subscribed to topic on localhost/127.0.0.1:39525 -- consumer: 0
2024-02-05T18:21:20,341 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.014 seconds
2024-02-05T18:21:20,343 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:21:20,344 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:21:20,345 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:21:20,390 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:21:20,412 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:21:20,413 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:21:20,417 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:20 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 59
2024-02-05T18:21:20,417 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:21:20,432 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:21:20,443 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:21:20,444 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:21:20,446 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:21:20,447 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:20 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T18:21:20,467 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:21:20,468 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xbbf5e0ba, L:/127.0.0.1:37344 - R:localhost/127.0.0.1:39525]
2024-02-05T18:21:20,478 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:21:20,485 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:37344] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:37344, producerName=test-0-1, producerId=1}
2024-02-05T18:21:20,486 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0xbbf5e0ba, L:/127.0.0.1:37344 - R:localhost/127.0.0.1:39525]
2024-02-05T18:21:20,501 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:21:20,503 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-1f44a14de9] Subscribing to topic on cnx [id: 0xbbf5e0ba, L:/127.0.0.1:37344 - R:localhost/127.0.0.1:39525], consumerId 1
2024-02-05T18:21:20,505 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x7b90e917, L:/127.0.0.1:39525 - R:/127.0.0.1:37344]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-1f44a14de9. consumerId: 1
2024-02-05T18:21:20,531 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-1f44a14de9] Created new subscription for 1
2024-02-05T18:21:20,532 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:37344] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-1f44a14de9
2024-02-05T18:21:20,537 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-1f44a14de9] Subscribed to topic on localhost/127.0.0.1:39525 -- consumer: 1
2024-02-05T18:21:20,561 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:21:20,562 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xbbf5e0ba, L:/127.0.0.1:37344 - R:localhost/127.0.0.1:39525]
2024-02-05T18:21:20,568 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:21:20,574 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:37344] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:37344, producerName=test-0-2, producerId=2}
2024-02-05T18:21:20,576 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0xbbf5e0ba, L:/127.0.0.1:37344 - R:localhost/127.0.0.1:39525]
2024-02-05T18:21:20,592 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:21:20,623 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:21:20,631 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:39543 started the ownership monitor.
2024-02-05T18:21:20,650 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:21:20,651 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-a2b47ba79b] Subscribing to topic on cnx [id: 0xbbf5e0ba, L:/127.0.0.1:37344 - R:localhost/127.0.0.1:39525], consumerId 2
2024-02-05T18:21:20,656 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x7b90e917, L:/127.0.0.1:39525 - R:/127.0.0.1:37344]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-a2b47ba79b. consumerId: 2
2024-02-05T18:21:20,676 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-a2b47ba79b] Created new subscription for 2
2024-02-05T18:21:20,677 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:39543/__change_events
2024-02-05T18:21:20,677 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:37344] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-a2b47ba79b
2024-02-05T18:21:20,678 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-a2b47ba79b] Subscribed to topic on localhost/127.0.0.1:39525 -- consumer: 2
2024-02-05T18:21:20,679 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:39543 plays the leader now.
2024-02-05T18:21:20,684 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 54.10%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 54.10%, msgThroughputEMA= 0.00, updatedAt= 1707150080683, reportedAt= 0
2024-02-05T18:21:20,715 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:21:20,743 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:21:20,745 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:21:20,780 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:39543/0x00000000_0xffffffff - localhost:39543.
2024-02-05T18:21:20,782 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:39543
2024-02-05T18:21:20,782 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:39543/0x00000000_0xffffffff
2024-02-05T18:21:20,783 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:39543/0x00000000_0xffffffff - localhost:39543.
2024-02-05T18:21:20,785 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:39543
2024-02-05T18:21:20,785 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:39543/0x00000000_0xffffffff
2024-02-05T18:21:20,810 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:39543/__change_events][reader-adad2e9ffd] Subscribing to topic on cnx [id: 0xbbf5e0ba, L:/127.0.0.1:37344 - R:localhost/127.0.0.1:39525], consumerId 3
2024-02-05T18:21:20,809 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:39543 doesn't exist.
2024-02-05T18:21:20,814 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x7b90e917, L:/127.0.0.1:39525 - R:/127.0.0.1:37344]] Subscribing on topic persistent://sla-monitor/test/localhost:39543/__change_events / reader-adad2e9ffd. consumerId: 3
2024-02-05T18:21:20,830 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:39543/persistent/__change_events
2024-02-05T18:21:20,832 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:39543/persistent/__change_events'
2024-02-05T18:21:20,839 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:21:20,840 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:39543/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:21:20,847 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:39543/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:21:20,853 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:39543/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:21:20,856 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:39543/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:39543/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:21:20,857 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:39543/__change_events - dedup is disabled
2024-02-05T18:21:20,868 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:21:20,874 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:39543/__change_events][reader-adad2e9ffd] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:21:20,875 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:39543/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:21:20,876 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:39543/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:39543/persistent/__change_events, cursor=reader-adad2e9ffd, ackPos=7:-1, readPos=7:0}
2024-02-05T18:21:20,882 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:37344] Created subscription on topic persistent://sla-monitor/test/localhost:39543/__change_events / reader-adad2e9ffd
2024-02-05T18:21:20,884 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:39543/__change_events][reader-adad2e9ffd] Subscribed to topic on localhost/127.0.0.1:39525 -- consumer: 3
2024-02-05T18:21:20,831 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=9, bootstrap service port = 39543, tls-port = Optional[37015], broker url= pulsar://localhost:39525, broker tls url= pulsar+ssl://localhost:33083, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[39525], brokerServicePortTls=Optional[33083], webServicePort=Optional[39543], webServicePortTls=Optional[37015], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:21:21,530 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:21:21,530 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:21:21,530 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:21:21,531 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:21:21,539 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:21:21,540 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:21:21,547 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:21:21,552 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:21:21,562 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:21:21,563 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:21:21,571 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:21:21,580 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:21:21,585 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:21:21,596 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:21:21,596 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:21:21,606 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:21:21,610 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44651, TLS: (none), listener: (none)
2024-02-05T18:21:21,613 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:46243, TLS: OPENSSL, listener: (none)
2024-02-05T18:21:21,618 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:21:21,620 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:21:21,620 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:21:21,639 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:21:21,646 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:21:21,646 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:21:21,646 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:21:21,724 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/,null,AVAILABLE}
2024-02-05T18:21:21,746 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:21:21,747 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:21:22,458 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/admin,null,AVAILABLE}
2024-02-05T18:21:22,747 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:21:22,748 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:21:23,721 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,AVAILABLE}
2024-02-05T18:21:23,749 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:21:23,749 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:21:24,023 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,AVAILABLE}
2024-02-05T18:21:24,094 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,AVAILABLE}
2024-02-05T18:21:24,183 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/topics,null,AVAILABLE}
2024-02-05T18:21:24,184 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,AVAILABLE}
2024-02-05T18:21:24,185 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@554f6e30{/static,null,AVAILABLE}
2024-02-05T18:21:24,189 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:41773}
2024-02-05T18:21:24,204 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:43125}
2024-02-05T18:21:24,204 - INFO  - [main:Server@415] - Started @18060ms
2024-02-05T18:21:24,205 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:41773
2024-02-05T18:21:24,206 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:43125
2024-02-05T18:21:24,209 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:21:24,210 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:21:24,225 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:41773
2024-02-05T18:21:24,227 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:41773 registry has been created.
2024-02-05T18:21:24,227 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:41773. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:21:24,230 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:41773 is changing the role from null to Follower
2024-02-05T18:21:24,234 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:39543).
2024-02-05T18:21:24,241 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:21:24,254 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:41773 
2024-02-05T18:21:24,373 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:24 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 59
2024-02-05T18:21:24,392 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:21:24,395 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:21:24,396 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:21:24,412 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:24 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 33
2024-02-05T18:21:24,413 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:41773/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:21:24,424 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x1d1d55e7, L:/127.0.0.1:45304 - R:localhost/127.0.0.1:44651]] Connected to server
2024-02-05T18:21:24,438 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:45304] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:21:24,454 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xbb819313, L:/127.0.0.1:48062 - R:localhost/127.0.0.1:39525]] Connected to server
2024-02-05T18:21:24,458 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:48062] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:21:24,459 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xbb819313, L:/127.0.0.1:48062 - R:localhost/127.0.0.1:39525]
2024-02-05T18:21:24,470 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:48062] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:48062, producerName=test-0-3, producerId=0}
2024-02-05T18:21:24,472 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0xbb819313, L:/127.0.0.1:48062 - R:localhost/127.0.0.1:39525]
2024-02-05T18:21:24,486 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-bc3bd5d46b] Subscribing to topic on cnx [id: 0xbb819313, L:/127.0.0.1:48062 - R:localhost/127.0.0.1:39525], consumerId 0
2024-02-05T18:21:24,488 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x138dbe92, L:/127.0.0.1:39525 - R:/127.0.0.1:48062]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-bc3bd5d46b. consumerId: 0
2024-02-05T18:21:24,494 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-bc3bd5d46b] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:21:24,494 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:21:24,494 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-bc3bd5d46b, ackPos=3:-1, readPos=3:0}
2024-02-05T18:21:24,496 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:48062] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-bc3bd5d46b
2024-02-05T18:21:24,498 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-bc3bd5d46b] Subscribed to topic on localhost/127.0.0.1:39525 -- consumer: 0
2024-02-05T18:21:24,500 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:21:24,501 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:21:24,527 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:24 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:21:24,536 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:21:24,540 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:21:24,541 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:21:24,546 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:41773/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:21:24,546 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:24 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T18:21:24,561 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:24 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 10
2024-02-05T18:21:24,567 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:21:24,570 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:21:24,571 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:21:24,575 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:24 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T18:21:24,576 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:41773/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:21:24,589 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xbb819313, L:/127.0.0.1:48062 - R:localhost/127.0.0.1:39525]
2024-02-05T18:21:24,597 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:48062] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:48062, producerName=test-0-4, producerId=1}
2024-02-05T18:21:24,598 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0xbb819313, L:/127.0.0.1:48062 - R:localhost/127.0.0.1:39525]
2024-02-05T18:21:24,611 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-dd067019a3] Subscribing to topic on cnx [id: 0xbb819313, L:/127.0.0.1:48062 - R:localhost/127.0.0.1:39525], consumerId 1
2024-02-05T18:21:24,612 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x138dbe92, L:/127.0.0.1:39525 - R:/127.0.0.1:48062]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-dd067019a3. consumerId: 1
2024-02-05T18:21:24,624 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-dd067019a3] Created new subscription for 1
2024-02-05T18:21:24,624 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:48062] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-dd067019a3
2024-02-05T18:21:24,625 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-dd067019a3] Subscribed to topic on localhost/127.0.0.1:39525 -- consumer: 1
2024-02-05T18:21:24,637 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xbb819313, L:/127.0.0.1:48062 - R:localhost/127.0.0.1:39525]
2024-02-05T18:21:24,645 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:48062] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:48062, producerName=test-0-5, producerId=2}
2024-02-05T18:21:24,646 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0xbb819313, L:/127.0.0.1:48062 - R:localhost/127.0.0.1:39525]
2024-02-05T18:21:24,648 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:21:24,651 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:21:24,652 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:41773 plays a follower now.
2024-02-05T18:21:24,670 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:41773/__change_events
2024-02-05T18:21:24,693 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:41773/0x00000000_0xffffffff - localhost:41773.
2024-02-05T18:21:24,694 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:41773/0x00000000_0xffffffff
2024-02-05T18:21:24,695 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:41773
2024-02-05T18:21:24,698 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:41773/0x00000000_0xffffffff - localhost:41773.
2024-02-05T18:21:24,700 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:41773/0x00000000_0xffffffff
2024-02-05T18:21:24,701 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:41773/__change_events][reader-2367b1faaf] Subscribing to topic on cnx [id: 0x1d1d55e7, L:/127.0.0.1:45304 - R:localhost/127.0.0.1:44651], consumerId 2
2024-02-05T18:21:24,703 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:41773
2024-02-05T18:21:24,704 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x4cf7bc2e, L:/127.0.0.1:44651 - R:/127.0.0.1:45304]] Subscribing on topic persistent://sla-monitor/test/localhost:41773/__change_events / reader-2367b1faaf. consumerId: 2
2024-02-05T18:21:24,707 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:41773 doesn't exist.
2024-02-05T18:21:24,716 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:41773/persistent/__change_events
2024-02-05T18:21:24,711 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 41773, tls-port = Optional[43125], broker url= pulsar://localhost:44651, broker tls url= pulsar+ssl://localhost:46243, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[44651], brokerServicePortTls=Optional[46243], webServicePort=Optional[41773], webServicePortTls=Optional[43125], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:21:24,718 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:41773/persistent/__change_events'
2024-02-05T18:21:24,728 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:21:24,729 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:41773/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:21:24,735 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:41773/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:21:24,740 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:41773/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:21:24,744 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:41773/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:41773/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:21:24,745 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:41773/__change_events - dedup is disabled
2024-02-05T18:21:24,750 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:21:24,751 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:21:24,753 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:21:24,760 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:41773/__change_events][reader-2367b1faaf] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:21:24,760 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:41773/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:21:24,760 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:41773/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:41773/persistent/__change_events, cursor=reader-2367b1faaf, ackPos=9:-1, readPos=9:0}
2024-02-05T18:21:24,762 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:45304] Created subscription on topic persistent://sla-monitor/test/localhost:41773/__change_events / reader-2367b1faaf
2024-02-05T18:21:24,764 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:41773/__change_events][reader-2367b1faaf] Subscribed to topic on localhost/127.0.0.1:44651 -- consumer: 2
2024-02-05T18:21:24,948 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:21:24,950 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:24 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:21:24,978 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:21:24,980 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:24 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:21:25,003 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:21:25,004 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:21:25,009 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:21:25,010 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:24 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T18:21:25,039 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:21:25,042 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:21:25,042 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:21:25,043 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:21:25,045 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:25 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 28
2024-02-05T18:21:25,046 - INFO  - [pulsar-7-5:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:21:25,058 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:21:25,058 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:21:25,063 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:21:25,065 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:25 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:21:25,078 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:21:25,078 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:21:25,079 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:21:25,080 - INFO  - [pulsar-62-2:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:21:25,080 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:25 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T18:21:25,084 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:21:25,118 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:21:25,132 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:21:25,133 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:21:25,149 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:21:25,162 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:21:25,187 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:41773 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:21:25,262 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:21:25,236 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39543 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:41773, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150085189, versionId=1]. totalHandledRequests:1
2024-02-05T18:21:25,289 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39543 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:41773, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150085236, versionId=2]. totalHandledRequests:1
2024-02-05T18:21:25,292 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:21:25,300 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:25 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 155
2024-02-05T18:21:25,301 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-e516eafb4e] Subscribing to topic on cnx [id: 0x1d1d55e7, L:/127.0.0.1:45304 - R:localhost/127.0.0.1:44651], consumerId 3
2024-02-05T18:21:25,303 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x4cf7bc2e, L:/127.0.0.1:44651 - R:/127.0.0.1:45304]] Subscribing on topic persistent://public/test/__change_events / reader-e516eafb4e. consumerId: 3
2024-02-05T18:21:25,312 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:21:25,315 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:21:25,320 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:21:25,325 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:21:25,326 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:21:25,333 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:21:25,338 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:21:25,341 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39543 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:41773, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150085333, versionId=3]. totalHandledRequests:1
2024-02-05T18:21:25,345 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:21:25,348 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:21:25,351 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:21:25,354 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:21:25,355 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:21:25,357 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:21:25,367 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:21:25,368 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:21:25,378 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:21:25,381 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 38.0 ms
2024-02-05T18:21:25,390 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39543 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:41773, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150085343, versionId=4]. totalHandledRequests:1
2024-02-05T18:21:25,393 - WARN  - [broker-client-shared-internal-executor-65-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:41773. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:21:25,393 - WARN  - [broker-client-shared-internal-executor-65-1:ServerCnx@1299] - [/127.0.0.1:45304][persistent://public/test/__change_events][reader-e516eafb4e] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:41773. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:21:25,397 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:21:25,397 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x1d1d55e7, L:/127.0.0.1:45304 - R:localhost/127.0.0.1:44651] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:41773. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:21:25,397 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:21:25,398 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:25 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 92
2024-02-05T18:21:25,399 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-e516eafb4e] Failed to subscribe to topic on localhost/127.0.0.1:44651
2024-02-05T18:21:25,400 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-e516eafb4e] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:41773. Please redo the lookup. Request is denied: namespace=public/test","reqId":3505553895925664329, "remote":"localhost/127.0.0.1:44651", "local":"/127.0.0.1:45304"}
2024-02-05T18:21:25,401 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:21:25,401 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-e516eafb4e] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:41773. Please redo the lookup. Request is denied: namespace=public/test","reqId":3505553895925664329, "remote":"localhost/127.0.0.1:44651", "local":"/127.0.0.1:45304"} -- Will try again in 0.1 s
2024-02-05T18:21:25,402 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:21:25 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 288
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55f8ee95], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2cb7e4dd] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55f8ee95, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@197337ef], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2cb7e4dd, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2bf21b73] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55f8ee95, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@197337ef, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@39ecd4de], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2cb7e4dd, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2bf21b73, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a6e5e32] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55f8ee95, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@197337ef, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@39ecd4de, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a22c8df], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2cb7e4dd, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2bf21b73, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a6e5e32, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@11b0676b] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55f8ee95, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@197337ef, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@39ecd4de, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a22c8df, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4e251ba7], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2cb7e4dd, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2bf21b73, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a6e5e32, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@11b0676b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1662439f] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55f8ee95, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@197337ef, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@39ecd4de, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a22c8df, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4e251ba7, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a3a05bc], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2cb7e4dd, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2bf21b73, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a6e5e32, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@11b0676b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1662439f, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@38a3a4af] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55f8ee95, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@197337ef, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@39ecd4de, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a22c8df, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4e251ba7, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a3a05bc, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5e3d683f], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2cb7e4dd, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2bf21b73, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a6e5e32, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@11b0676b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1662439f, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@38a3a4af, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5ac7b6dc] 
2024-02-05T18:21:25,503 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-e516eafb4e] Reconnecting after connection was closed
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:21:25,516 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:41773. Skipping this broker. Phase one
2024-02-05T18:21:25,516 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:39543. Skipping this broker. Phase one
2024-02-05T18:21:25,517 - INFO  - [pulsar-io-64-3:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:39543 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:21:25,525 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39543 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:39543, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150085517, versionId=5]. totalHandledRequests:8
2024-02-05T18:21:25,531 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:21:25,544 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39543 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:39543, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150085525, versionId=6]. totalHandledRequests:6
2024-02-05T18:21:25,546 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-e516eafb4e] Subscribing to topic on cnx [id: 0xbb819313, L:/127.0.0.1:48062 - R:localhost/127.0.0.1:39525], consumerId 3
2024-02-05T18:21:25,548 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:21:25,549 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:21:25,549 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:21:25,550 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@554f6e30{/static,null,STOPPED}
2024-02-05T18:21:25,553 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,STOPPED}
2024-02-05T18:21:25,555 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x138dbe92, L:/127.0.0.1:39525 - R:/127.0.0.1:48062]] Subscribing on topic persistent://public/test/__change_events / reader-e516eafb4e. consumerId: 3
2024-02-05T18:21:25,556 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:21:25,557 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:21:25,560 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/topics,null,STOPPED}
2024-02-05T18:21:25,561 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:21:25,563 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,STOPPED}
2024-02-05T18:21:25,574 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:21:25,581 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,STOPPED}
2024-02-05T18:21:25,581 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:21:25,582 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:21:25,583 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,STOPPED}
2024-02-05T18:21:25,586 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/admin,null,STOPPED}
2024-02-05T18:21:25,591 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:21:25,592 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:21:25,593 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:21:25,595 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/,null,STOPPED}
2024-02-05T18:21:25,597 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:21:25,597 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:21:25,598 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:21:25,606 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:21:25,608 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:21:25,615 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:21:25,616 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:21:25,617 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:21:25,617 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:41773
2024-02-05T18:21:25,618 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 39.26%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 39.26%, msgThroughputEMA= 0.00, updatedAt= 1707150085616, reportedAt= 0
2024-02-05T18:21:25,619 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-e516eafb4e] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:21:25,619 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:41773 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:21:25,619 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:21:25,627 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:21:25,627 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-e516eafb4e, ackPos=13:-1, readPos=13:0}
2024-02-05T18:21:25,629 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:48062] Created subscription on topic persistent://public/test/__change_events / reader-e516eafb4e
2024-02-05T18:21:25,630 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-d17b5c1fae] Subscribing to topic on cnx [id: 0xbbf5e0ba, L:/127.0.0.1:37344 - R:localhost/127.0.0.1:39525], consumerId 4
2024-02-05T18:21:25,635 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:41773 registry has been deleted.
2024-02-05T18:21:25,636 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:41773 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:21:25,636 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:41773 was invalidated. state Releasing
2024-02-05T18:21:25,639 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:41773. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:21:25,639 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:41773 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:21:25,639 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-e516eafb4e] Subscribed to topic on localhost/127.0.0.1:39525 -- consumer: 3
2024-02-05T18:21:25,639 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:41773
2024-02-05T18:21:25,639 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x7b90e917, L:/127.0.0.1:39525 - R:/127.0.0.1:37344]] Subscribing on topic persistent://public/test/__change_events / reader-d17b5c1fae. consumerId: 4
2024-02-05T18:21:25,641 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:41773 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:21:25,644 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:41773
2024-02-05T18:21:25,644 - INFO  - [pulsar-io-9-2:ServerCnx@2007] - [/127.0.0.1:48062] Closing consumer: consumerId=3
2024-02-05T18:21:25,644 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-e516eafb4e}, consumerId=3, consumerName=424d2, address=/127.0.0.1:48062}
2024-02-05T18:21:25,645 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-e516eafb4e] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-e516eafb4e, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:21:25,645 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-d17b5c1fae] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:21:25,646 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:21:25,646 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-e516eafb4e] Successfully closed dispatcher for reader
2024-02-05T18:21:25,646 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-d17b5c1fae, ackPos=13:-1, readPos=13:0}
2024-02-05T18:21:25,648 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:37344] Created subscription on topic persistent://public/test/__change_events / reader-d17b5c1fae
2024-02-05T18:21:25,653 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:41773/0x00000000_0xffffffff.
2024-02-05T18:21:25,654 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-d17b5c1fae] Subscribed to topic on localhost/127.0.0.1:39525 -- consumer: 4
2024-02-05T18:21:25,655 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:41773/0x00000000_0xffffffff.
2024-02-05T18:21:25,657 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:41773/0x00000000_0xffffffff.
2024-02-05T18:21:25,657 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.012 seconds
2024-02-05T18:21:25,658 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:21:25,663 - INFO  - [pulsar-io-9-2:ServerCnx@2043] - [/127.0.0.1:48062] Closed consumer, consumerId=3
2024-02-05T18:21:25,665 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x1d1d55e7, L:/127.0.0.1:45304 ! R:localhost/127.0.0.1:44651] Disconnected
2024-02-05T18:21:25,667 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:45304
2024-02-05T18:21:25,667 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xbb819313, L:/127.0.0.1:48062 ! R:localhost/127.0.0.1:39525] Disconnected
2024-02-05T18:21:25,667 - ERROR - [pulsar-io-64-1:ConsumerImpl@2513] - [persistent://public/test/__change_events][reader-e516eafb4e] Failed getLastMessageId command
2024-02-05T18:21:25,668 - ERROR - [pulsar-io-64-1:ConsumerImpl@2387] - [persistent://public/test/__change_events][reader-e516eafb4e] Failed getLastMessageId command
2024-02-05T18:21:25,669 - WARN  - [pulsar-io-9-2:ServerCnx@407] - [/127.0.0.1:48062] Got exception io.netty.channel.unix.Errors$NativeIoException: recvAddress(..) failed: Connection reset by peer
2024-02-05T18:21:25,669 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:41773/__change_events] [reader-2367b1faaf] Closed connection [id: 0x1d1d55e7, L:/127.0.0.1:45304 ! R:localhost/127.0.0.1:44651] -- Will try again in 0.1 s
2024-02-05T18:21:25,668 - ERROR - [pulsar-io-64-1:SystemTopicBasedTopicPoliciesService@398] - [persistent://public/test/__change_events] Failed to check the move events for the system topic
org.apache.pulsar.client.api.PulsarClientException$ConnectException: The subscription reader-e516eafb4e of the topic persistent://public/test/__change_events gets the last message id was failed
Disconnected from server at localhost/127.0.0.1:39525
	at org.apache.pulsar.client.api.PulsarClientException.wrap(PulsarClientException.java:963) ~[pulsar-client-api-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$internalGetLastMessageIdAsync$64(ConsumerImpl.java:2515) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:990) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:974) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ClientCnx.lambda$channelInactive$1(ClientCnx.java:319) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.common.util.collections.ConcurrentLongHashMap$Section.forEach(ConcurrentLongHashMap.java:562) ~[pulsar-common-3.0.2.jar:3.0.2]
	at org.apache.pulsar.common.util.collections.ConcurrentLongHashMap.forEach(ConcurrentLongHashMap.java:242) ~[pulsar-common-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ClientCnx.channelInactive(ClientCnx.java:317) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelInputClosed(ByteToMessageDecoder.java:411) ~[netty-codec-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelInactive(ByteToMessageDecoder.java:376) ~[netty-codec-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:166) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasksFrom(SingleThreadEventExecutor.java:426) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:375) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor.confirmShutdown(SingleThreadEventExecutor.java:763) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:431) ~[netty-transport-classes-epoll-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
2024-02-05T18:21:25,669 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:48062
2024-02-05T18:21:25,670 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:41773/__change_events, name=reader-2367b1faaf}, consumerId=2, consumerName=0f079, address=/127.0.0.1:45304}
2024-02-05T18:21:25,678 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-bc3bd5d46b}, consumerId=0, consumerName=6c2e3, address=/127.0.0.1:48062}
2024-02-05T18:21:25,678 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-bc3bd5d46b] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-bc3bd5d46b, ackPos=3:5, readPos=3:6}]
2024-02-05T18:21:25,678 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:41773/__change_events][reader-2367b1faaf] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:41773/persistent/__change_events, cursor=reader-2367b1faaf, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:21:25,678 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:41773/__change_events][reader-2367b1faaf] Successfully closed dispatcher for reader
2024-02-05T18:21:25,678 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-bc3bd5d46b] Successfully closed dispatcher for reader
2024-02-05T18:21:25,680 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:21:25,680 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:41773/persistent/__change_events] Closing managed ledger
2024-02-05T18:21:25,681 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-dd067019a3}, consumerId=1, consumerName=b1f9b, address=/127.0.0.1:48062}
2024-02-05T18:21:25,684 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:41773/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:21:25,684 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:21:25,686 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:21:25,672 - ERROR - [pulsar-io-64-1:SystemTopicBasedTopicPoliciesService@333] - [public/test] Failed to create reader on __change_events topic
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$ConnectException: The subscription reader-e516eafb4e of the topic persistent://public/test/__change_events gets the last message id was failed
Disconnected from server at localhost/127.0.0.1:39525
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:708) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:400) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$hasMessageAvailableAsync$57(ConsumerImpl.java:2388) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:990) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:974) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$internalGetLastMessageIdAsync$64(ConsumerImpl.java:2514) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:990) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:974) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ClientCnx.lambda$channelInactive$1(ClientCnx.java:319) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.common.util.collections.ConcurrentLongHashMap$Section.forEach(ConcurrentLongHashMap.java:562) ~[pulsar-common-3.0.2.jar:3.0.2]
	at org.apache.pulsar.common.util.collections.ConcurrentLongHashMap.forEach(ConcurrentLongHashMap.java:242) ~[pulsar-common-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ClientCnx.channelInactive(ClientCnx.java:317) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelInputClosed(ByteToMessageDecoder.java:411) ~[netty-codec-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelInactive(ByteToMessageDecoder.java:376) ~[netty-codec-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:166) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasksFrom(SingleThreadEventExecutor.java:426) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:375) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor.confirmShutdown(SingleThreadEventExecutor.java:763) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:431) ~[netty-transport-classes-epoll-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$ConnectException: The subscription reader-e516eafb4e of the topic persistent://public/test/__change_events gets the last message id was failed
Disconnected from server at localhost/127.0.0.1:39525
	at org.apache.pulsar.client.api.PulsarClientException.wrap(PulsarClientException.java:963) ~[pulsar-client-api-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$internalGetLastMessageIdAsync$64(ConsumerImpl.java:2515) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 31 more
2024-02-05T18:21:25,687 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:21:25,688 - INFO  - [pulsar-io-64-1:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-e516eafb4e] Closed consumer
2024-02-05T18:21:25,689 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0xbb819313, L:/127.0.0.1:48062 ! R:localhost/127.0.0.1:39525] -- Will try again in 0.1 s
2024-02-05T18:21:25,690 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0xbb819313, L:/127.0.0.1:48062 ! R:localhost/127.0.0.1:39525] -- Will try again in 0.1 s
2024-02-05T18:21:25,690 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0xbb819313, L:/127.0.0.1:48062 ! R:localhost/127.0.0.1:39525] -- Will try again in 0.1 s
2024-02-05T18:21:25,690 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-bc3bd5d46b] Closed connection [id: 0xbb819313, L:/127.0.0.1:48062 ! R:localhost/127.0.0.1:39525] -- Will try again in 0.1 s
2024-02-05T18:21:25,691 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-dd067019a3] Closed connection [id: 0xbb819313, L:/127.0.0.1:48062 ! R:localhost/127.0.0.1:39525] -- Will try again in 0.1 s
2024-02-05T18:21:25,696 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:44651
2024-02-05T18:21:25,697 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:21:25,699 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:21:25,699 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:21:25,700 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:41773/__change_events] [reader-2367b1faaf] Closed Consumer (not connected)
2024-02-05T18:21:25,701 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:41773/__change_events with subscription name reader-2367b1faaf was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:41773/__change_events with subscription name reader-2367b1faaf was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:21:25,701 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-bc3bd5d46b] Closed Consumer (not connected)
2024-02-05T18:21:25,702 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-dd067019a3] Closed Consumer (not connected)
2024-02-05T18:21:25,703 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-bc3bd5d46b was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-bc3bd5d46b was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:21:25,704 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-dd067019a3 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-dd067019a3 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:21:25,709 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:21:25,709 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:21:25,712 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:21:25,713 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:21:25,719 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:21:25,720 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:21:25,752 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:21:25,752 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:21:26,753 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:21:26,753 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:21:26,996 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:21:26,997 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:21:26,999 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:21:26,999 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:21:27,000 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:21:27,000 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:21:27,754 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:21:27,754 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:21:28,755 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:21:28,755 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:21:29,013 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:21:29,014 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:21:29,015 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:21:29,015 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:21:29,016 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6556471b{/static,null,STOPPED}
2024-02-05T18:21:29,016 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,STOPPED}
2024-02-05T18:21:29,018 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/topics,null,STOPPED}
2024-02-05T18:21:29,020 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,STOPPED}
2024-02-05T18:21:29,022 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,STOPPED}
2024-02-05T18:21:29,024 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,STOPPED}
2024-02-05T18:21:29,025 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/admin,null,STOPPED}
2024-02-05T18:21:29,027 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1978b0d5{/,null,STOPPED}
2024-02-05T18:21:29,029 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:21:29,030 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:21:29,030 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:21:29,032 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:39543
2024-02-05T18:21:29,034 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:39543, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150085525, versionId=6]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:21:34,045 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:39543 in 5011.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:21:34,052 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:39543 was invalidated. state Releasing
2024-02-05T18:21:34,053 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:39543. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:21:34,053 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:39543
2024-02-05T18:21:34,059 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:39543/0x00000000_0xffffffff.
2024-02-05T18:21:34,060 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:39543/0x00000000_0xffffffff.
2024-02-05T18:21:34,062 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:39543/0x00000000_0xffffffff.
2024-02-05T18:21:34,071 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39543 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:39543, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150094064, versionId=7]. totalHandledRequests:10
2024-02-05T18:21:34,073 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:21:34,073 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:21:34,073 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:21:34,074 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-d17b5c1fae}, consumerId=4, consumerName=9459b, address=/127.0.0.1:37344}
2024-02-05T18:21:34,074 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-d17b5c1fae}, consumerId=4, consumerName=9459b, address=/127.0.0.1:37344}
2024-02-05T18:21:34,075 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-d17b5c1fae] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-d17b5c1fae, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:21:34,075 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:39525] Broker notification of Closed consumer: 4
2024-02-05T18:21:34,075 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-d17b5c1fae] Successfully closed dispatcher for reader
2024-02-05T18:21:34,075 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-d17b5c1fae] Closed connection [id: 0xbbf5e0ba, L:/127.0.0.1:37344 - R:localhost/127.0.0.1:39525] -- Will try again in 0.1 s
2024-02-05T18:21:34,076 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-d17b5c1fae] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-d17b5c1fae, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:21:34,076 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-d17b5c1fae] Successfully disconnected and closed subscription
2024-02-05T18:21:34,076 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:21:34,082 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:21:34,083 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:21:34,084 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-d17b5c1fae] Closed Consumer (not connected)
2024-02-05T18:21:34,084 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 12.0 ms
2024-02-05T18:21:34,084 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-d17b5c1fae was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-d17b5c1fae was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:21:34,093 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39543 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:39543, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150094072, versionId=8]. totalHandledRequests:4
2024-02-05T18:21:34,093 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:21:34,093 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.039 seconds
2024-02-05T18:21:34,094 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:21:34,095 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:21:34,095 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:37344
2024-02-05T18:21:34,095 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:21:34,095 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:39543/persistent/__change_events] Closing managed ledger
2024-02-05T18:21:34,095 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0xbbf5e0ba, L:/127.0.0.1:37344 ! R:localhost/127.0.0.1:39525] Disconnected
2024-02-05T18:21:34,095 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-7db7916a68}, consumerId=0, consumerName=d5c57, address=/127.0.0.1:37344}
2024-02-05T18:21:34,095 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0xbbf5e0ba, L:/127.0.0.1:37344 ! R:localhost/127.0.0.1:39525] -- Will try again in 0.1 s
2024-02-05T18:21:34,095 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7db7916a68] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-7db7916a68, ackPos=3:5, readPos=3:8}]
2024-02-05T18:21:34,096 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0xbbf5e0ba, L:/127.0.0.1:37344 ! R:localhost/127.0.0.1:39525] -- Will try again in 0.1 s
2024-02-05T18:21:34,096 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7db7916a68] Successfully closed dispatcher for reader
2024-02-05T18:21:34,096 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0xbbf5e0ba, L:/127.0.0.1:37344 ! R:localhost/127.0.0.1:39525] -- Will try again in 0.1 s
2024-02-05T18:21:34,096 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-7db7916a68] Closed connection [id: 0xbbf5e0ba, L:/127.0.0.1:37344 ! R:localhost/127.0.0.1:39525] -- Will try again in 0.1 s
2024-02-05T18:21:34,096 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-1f44a14de9] Closed connection [id: 0xbbf5e0ba, L:/127.0.0.1:37344 ! R:localhost/127.0.0.1:39525] -- Will try again in 0.1 s
2024-02-05T18:21:34,096 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:39543/__change_events, name=reader-adad2e9ffd}, consumerId=3, consumerName=82f47, address=/127.0.0.1:37344}
2024-02-05T18:21:34,096 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:39543/__change_events] [reader-adad2e9ffd] Closed connection [id: 0xbbf5e0ba, L:/127.0.0.1:37344 ! R:localhost/127.0.0.1:39525] -- Will try again in 0.1 s
2024-02-05T18:21:34,096 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-a2b47ba79b] Closed connection [id: 0xbbf5e0ba, L:/127.0.0.1:37344 ! R:localhost/127.0.0.1:39525] -- Will try again in 0.1 s
2024-02-05T18:21:34,096 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:39543/__change_events][reader-adad2e9ffd] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:39543/persistent/__change_events, cursor=reader-adad2e9ffd, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:21:34,097 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:39543/__change_events][reader-adad2e9ffd] Successfully closed dispatcher for reader
2024-02-05T18:21:34,097 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-a2b47ba79b}, consumerId=2, consumerName=a998b, address=/127.0.0.1:37344}
2024-02-05T18:21:34,097 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-1f44a14de9}, consumerId=1, consumerName=c3d7d, address=/127.0.0.1:37344}
2024-02-05T18:21:34,098 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:21:34,099 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:39543/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:21:34,099 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:21:34,100 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:21:34,100 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:21:34,105 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:39525
2024-02-05T18:21:34,105 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:21:34,105 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:21:34,106 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:21:34,106 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-7db7916a68] Closed Consumer (not connected)
2024-02-05T18:21:34,106 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-1f44a14de9] Closed Consumer (not connected)
2024-02-05T18:21:34,106 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-a2b47ba79b] Closed Consumer (not connected)
2024-02-05T18:21:34,106 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-7db7916a68 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-7db7916a68 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:21:34,106 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:39543/__change_events] [reader-adad2e9ffd] Closed Consumer (not connected)
2024-02-05T18:21:34,107 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-1f44a14de9 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-1f44a14de9 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:21:34,107 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-a2b47ba79b was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-a2b47ba79b was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:21:34,107 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:39543/__change_events with subscription name reader-adad2e9ffd was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:39543/__change_events with subscription name reader-adad2e9ffd was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:21:34,110 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:21:34,110 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:21:34,110 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:21:34,110 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:21:34,110 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:21:34,111 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:21:34,111 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:21:34,112 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:21:35,501 - INFO  - [globalEventExecutor-10-7:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:21:35,501 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:21:35,503 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:21:35,504 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:21:35,504 - INFO  - [GracefulExecutorServicesTerminationHandler:BrokerService@893] - Broker service completely shut down
2024-02-05T18:21:35,504 - INFO  - [GracefulExecutorServicesTerminationHandler:PulsarService@601] - Closed
2024-02-05T18:21:35,512 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:21:35,512 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:21:35,516 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:21:35,516 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:21:35,517 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:21:35,517 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:21:35,517 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:21:35,517 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:21:35,517 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:21:35,517 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:21:35,517 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:21:35,517 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 190 with name 'Thread[globalEventExecutor-10-7,5,main]'
2024-02-05T18:21:35,517 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 8 new threads
2024-02-05T18:21:35,518 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:21:35,518 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@339e62bb
2024-02-05T18:21:35,518 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:21:35,518 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:21:35,518 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 28.968 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  55.158 s
[INFO] Finished at: 2024-02-05T18:21:35+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 5 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:22:06,531 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:22:07,605 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:22:07,607 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:22:08,068 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:22:08,069 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:22:08,070 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:22:08,070 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:22:08,071 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:22:08,071 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:22:08,085 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:22:08,085 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:22:08,086 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:22:08,086 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:22:08,087 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:22:08,087 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:22:08,088 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:22:08,088 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:22:08,088 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:22:08,089 - INFO  - [main:Environment@98] - Client environment:os.memory.free=20MB
2024-02-05T18:22:08,089 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:22:08,090 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:22:09,718 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:22:09,719 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:22:09,719 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:22:09,720 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:22:10,081 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:22:10,082 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:22:10,174 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:22:10,260 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:22:10,263 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:22:10,282 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:22:10,398 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:22:10,445 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:22:10,510 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:22:10,874 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:22:10,875 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:22:10,938 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:22:10,992 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44717, TLS: (none), listener: (none)
2024-02-05T18:22:11,263 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:39497, TLS: OPENSSL, listener: (none)
2024-02-05T18:22:11,284 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:22:11,290 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:22:11,290 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:22:11,324 - INFO  - [main:Log@170] - Logging initialized @7087ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:22:12,109 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:22:12,143 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:22:12,144 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:22:12,146 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:22:13,006 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/,null,AVAILABLE}
2024-02-05T18:22:14,196 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin,null,AVAILABLE}
2024-02-05T18:22:15,309 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,AVAILABLE}
2024-02-05T18:22:15,719 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,AVAILABLE}
2024-02-05T18:22:15,858 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,AVAILABLE}
2024-02-05T18:22:15,987 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/topics,null,AVAILABLE}
2024-02-05T18:22:15,988 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,AVAILABLE}
2024-02-05T18:22:15,991 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@1978b0d5{/static,null,AVAILABLE}
2024-02-05T18:22:16,027 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:43281}
2024-02-05T18:22:16,169 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:43933}
2024-02-05T18:22:16,170 - INFO  - [main:Server@415] - Started @11935ms
2024-02-05T18:22:16,170 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:43281
2024-02-05T18:22:16,172 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:43933
2024-02-05T18:22:16,182 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:22:16,183 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:22:16,365 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:43281
2024-02-05T18:22:16,384 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:22:16,389 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:43281 is changing the role from null to Leader
2024-02-05T18:22:16,392 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:43281).
2024-02-05T18:22:16,727 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:43281 
2024-02-05T18:22:17,227 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:22:17,253 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:22:17,361 - INFO  - [configuration-metadata-store-4-1:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:22:17,365 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:22:17,377 - INFO  - [configuration-metadata-store-4-1:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:22:17,379 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:22:17,409 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:22:17,434 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:22:17,460 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:22:17,510 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:22:17,526 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:22:17,533 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:22:17,535 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:22:17,562 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:22:17,567 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:17 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 493
2024-02-05T18:22:17,746 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0xd9211ced, L:/127.0.0.1:52492 - R:localhost/127.0.0.1:44717]] Connected to server
2024-02-05T18:22:17,782 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:52492] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:22:17,855 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:22:17,865 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xd9211ced, L:/127.0.0.1:52492 - R:localhost/127.0.0.1:44717]
2024-02-05T18:22:17,932 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:22:17,958 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:52492] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:52492, producerName=test-0-0, producerId=0}
2024-02-05T18:22:17,965 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0xd9211ced, L:/127.0.0.1:52492 - R:localhost/127.0.0.1:44717]
2024-02-05T18:22:17,967 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:22:18,028 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:22:18,030 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-af1c114ef0] Subscribing to topic on cnx [id: 0xd9211ced, L:/127.0.0.1:52492 - R:localhost/127.0.0.1:44717], consumerId 0
2024-02-05T18:22:18,041 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x2b11cbe4, L:/127.0.0.1:44717 - R:/127.0.0.1:52492]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-af1c114ef0. consumerId: 0
2024-02-05T18:22:18,072 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-af1c114ef0] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:22:18,074 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:22:18,074 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-af1c114ef0, ackPos=3:-1, readPos=3:0}
2024-02-05T18:22:18,096 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52492] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-af1c114ef0
2024-02-05T18:22:18,102 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-af1c114ef0] Subscribed to topic on localhost/127.0.0.1:44717 -- consumer: 0
2024-02-05T18:22:18,113 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.011 seconds
2024-02-05T18:22:18,114 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:22:18,116 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:22:18,116 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:22:18,159 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:22:18,183 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:22:18,184 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:22:18,186 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:18 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 58
2024-02-05T18:22:18,187 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:22:18,197 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:22:18,210 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:22:18,211 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:22:18,212 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:18 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 21
2024-02-05T18:22:18,213 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:22:18,234 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:22:18,236 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xd9211ced, L:/127.0.0.1:52492 - R:localhost/127.0.0.1:44717]
2024-02-05T18:22:18,246 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:22:18,252 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:52492] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:52492, producerName=test-0-1, producerId=1}
2024-02-05T18:22:18,254 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0xd9211ced, L:/127.0.0.1:52492 - R:localhost/127.0.0.1:44717]
2024-02-05T18:22:18,270 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:22:18,272 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-73cb7fba9e] Subscribing to topic on cnx [id: 0xd9211ced, L:/127.0.0.1:52492 - R:localhost/127.0.0.1:44717], consumerId 1
2024-02-05T18:22:18,274 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x2b11cbe4, L:/127.0.0.1:44717 - R:/127.0.0.1:52492]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-73cb7fba9e. consumerId: 1
2024-02-05T18:22:18,297 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-73cb7fba9e] Created new subscription for 1
2024-02-05T18:22:18,298 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52492] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-73cb7fba9e
2024-02-05T18:22:18,299 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-73cb7fba9e] Subscribed to topic on localhost/127.0.0.1:44717 -- consumer: 1
2024-02-05T18:22:18,316 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:22:18,317 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xd9211ced, L:/127.0.0.1:52492 - R:localhost/127.0.0.1:44717]
2024-02-05T18:22:18,325 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:22:18,333 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:52492] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:52492, producerName=test-0-2, producerId=2}
2024-02-05T18:22:18,334 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0xd9211ced, L:/127.0.0.1:52492 - R:localhost/127.0.0.1:44717]
2024-02-05T18:22:18,346 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:22:18,364 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:22:18,371 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:43281 started the ownership monitor.
2024-02-05T18:22:18,395 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:22:18,397 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-652a0df086] Subscribing to topic on cnx [id: 0xd9211ced, L:/127.0.0.1:52492 - R:localhost/127.0.0.1:44717], consumerId 2
2024-02-05T18:22:18,399 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x2b11cbe4, L:/127.0.0.1:44717 - R:/127.0.0.1:52492]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-652a0df086. consumerId: 2
2024-02-05T18:22:18,403 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:43281/__change_events
2024-02-05T18:22:18,412 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-652a0df086] Created new subscription for 2
2024-02-05T18:22:18,413 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52492] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-652a0df086
2024-02-05T18:22:18,414 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-652a0df086] Subscribed to topic on localhost/127.0.0.1:44717 -- consumer: 2
2024-02-05T18:22:18,415 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:43281 plays the leader now.
2024-02-05T18:22:18,420 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 54.30%, directMemory= 2.73%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 2.73%, weightedMaxEMA= 54.30%, msgThroughputEMA= 0.00, updatedAt= 1707150138419, reportedAt= 0
2024-02-05T18:22:18,438 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:22:18,442 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:22:18,443 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:22:18,498 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:43281/0x00000000_0xffffffff - localhost:43281.
2024-02-05T18:22:18,500 - INFO  - [pulsar-7-4:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:43281/0x00000000_0xffffffff
2024-02-05T18:22:18,501 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:43281
2024-02-05T18:22:18,505 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:43281/__change_events][reader-37ef5c09d4] Subscribing to topic on cnx [id: 0xd9211ced, L:/127.0.0.1:52492 - R:localhost/127.0.0.1:44717], consumerId 3
2024-02-05T18:22:18,506 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:43281/0x00000000_0xffffffff - localhost:43281.
2024-02-05T18:22:18,507 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x2b11cbe4, L:/127.0.0.1:44717 - R:/127.0.0.1:52492]] Subscribing on topic persistent://sla-monitor/test/localhost:43281/__change_events / reader-37ef5c09d4. consumerId: 3
2024-02-05T18:22:18,507 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:43281/0x00000000_0xffffffff
2024-02-05T18:22:18,509 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:43281
2024-02-05T18:22:18,517 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:43281/persistent/__change_events
2024-02-05T18:22:18,519 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:43281/persistent/__change_events'
2024-02-05T18:22:18,521 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:43281 doesn't exist.
2024-02-05T18:22:18,526 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:22:18,527 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:43281/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:22:18,534 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:43281/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:22:18,541 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:43281/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:22:18,545 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:43281/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:43281/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:22:18,546 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:43281/__change_events - dedup is disabled
2024-02-05T18:22:18,559 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:22:18,566 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:43281/__change_events][reader-37ef5c09d4] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:22:18,567 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:43281/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:22:18,567 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:43281/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:43281/persistent/__change_events, cursor=reader-37ef5c09d4, ackPos=7:-1, readPos=7:0}
2024-02-05T18:22:18,570 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:52492] Created subscription on topic persistent://sla-monitor/test/localhost:43281/__change_events / reader-37ef5c09d4
2024-02-05T18:22:18,571 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:43281/__change_events][reader-37ef5c09d4] Subscribed to topic on localhost/127.0.0.1:44717 -- consumer: 3
2024-02-05T18:22:18,536 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 43281, tls-port = Optional[43933], broker url= pulsar://localhost:44717, broker tls url= pulsar+ssl://localhost:39497, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[44717], brokerServicePortTls=Optional[39497], webServicePort=Optional[43281], webServicePortTls=Optional[43933], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:22:19,040 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:22:19,040 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:22:19,040 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:22:19,040 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:22:19,044 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:22:19,044 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:22:19,049 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:22:19,052 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:22:19,057 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:22:19,058 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:22:19,063 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:22:19,066 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:22:19,069 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:22:19,076 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:22:19,076 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:22:19,082 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:22:19,085 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:40359, TLS: (none), listener: (none)
2024-02-05T18:22:19,086 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44551, TLS: OPENSSL, listener: (none)
2024-02-05T18:22:19,090 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:22:19,091 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:22:19,091 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:22:19,105 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:22:19,108 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:22:19,108 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:22:19,109 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:22:19,200 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1de78f97{/,null,AVAILABLE}
2024-02-05T18:22:19,444 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:22:19,445 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:22:19,775 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@4dbcc8ce{/admin,null,AVAILABLE}
2024-02-05T18:22:20,446 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:22:20,446 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:22:20,995 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45dc4d1a{/admin/v2,null,AVAILABLE}
2024-02-05T18:22:21,269 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@44cd3ea9{/admin/v3,null,AVAILABLE}
2024-02-05T18:22:21,349 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@60a98fa6{/lookup,null,AVAILABLE}
2024-02-05T18:22:21,436 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@352df548{/topics,null,AVAILABLE}
2024-02-05T18:22:21,436 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3af4b14e{/metrics,null,AVAILABLE}
2024-02-05T18:22:21,439 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@36b6ce5d{/static,null,AVAILABLE}
2024-02-05T18:22:21,441 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@6a4ec62d{HTTP/1.1, (http/1.1)}{0.0.0.0:42099}
2024-02-05T18:22:21,447 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:22:21,448 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:22:21,451 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@4c902a72{SSL, (ssl, http/1.1)}{0.0.0.0:33897}
2024-02-05T18:22:21,452 - INFO  - [main:Server@415] - Started @17217ms
2024-02-05T18:22:21,452 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:42099
2024-02-05T18:22:21,454 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:33897
2024-02-05T18:22:21,457 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:22:21,458 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:22:21,475 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:42099
2024-02-05T18:22:21,477 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:42099 registry has been created.
2024-02-05T18:22:21,478 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:42099. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:22:21,480 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:42099 is changing the role from null to Follower
2024-02-05T18:22:21,484 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:43281).
2024-02-05T18:22:21,490 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:22:21,505 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:42099 
2024-02-05T18:22:21,631 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:21 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 58
2024-02-05T18:22:21,655 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:22:21,658 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:22:21,659 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:22:21,675 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:21 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 35
2024-02-05T18:22:21,676 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42099/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:22:21,687 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x642d63aa, L:/127.0.0.1:36014 - R:localhost/127.0.0.1:40359]] Connected to server
2024-02-05T18:22:21,692 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:36014] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:22:21,707 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xba0aede5, L:/127.0.0.1:55970 - R:localhost/127.0.0.1:44717]] Connected to server
2024-02-05T18:22:21,710 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:55970] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:22:21,711 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xba0aede5, L:/127.0.0.1:55970 - R:localhost/127.0.0.1:44717]
2024-02-05T18:22:21,721 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:55970] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:55970, producerName=test-0-3, producerId=0}
2024-02-05T18:22:21,722 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0xba0aede5, L:/127.0.0.1:55970 - R:localhost/127.0.0.1:44717]
2024-02-05T18:22:21,733 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c07ee0d7d9] Subscribing to topic on cnx [id: 0xba0aede5, L:/127.0.0.1:55970 - R:localhost/127.0.0.1:44717], consumerId 0
2024-02-05T18:22:21,735 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x12f99752, L:/127.0.0.1:44717 - R:/127.0.0.1:55970]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-c07ee0d7d9. consumerId: 0
2024-02-05T18:22:21,741 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c07ee0d7d9] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:22:21,741 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:22:21,741 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-c07ee0d7d9, ackPos=3:-1, readPos=3:0}
2024-02-05T18:22:21,743 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:55970] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-c07ee0d7d9
2024-02-05T18:22:21,744 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c07ee0d7d9] Subscribed to topic on localhost/127.0.0.1:44717 -- consumer: 0
2024-02-05T18:22:21,748 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:22:21,748 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:22:21,771 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 19
2024-02-05T18:22:21,777 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:22:21,779 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:22:21,779 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:22:21,783 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42099/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:22:21,783 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 10
2024-02-05T18:22:21,792 - INFO  - [pulsar-web-84-7:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 5
2024-02-05T18:22:21,799 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:22:21,801 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:22:21,802 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:22:21,806 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:22:21,807 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42099/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:22:21,825 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xba0aede5, L:/127.0.0.1:55970 - R:localhost/127.0.0.1:44717]
2024-02-05T18:22:21,833 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:55970] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:55970, producerName=test-0-4, producerId=1}
2024-02-05T18:22:21,834 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0xba0aede5, L:/127.0.0.1:55970 - R:localhost/127.0.0.1:44717]
2024-02-05T18:22:21,843 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d703135509] Subscribing to topic on cnx [id: 0xba0aede5, L:/127.0.0.1:55970 - R:localhost/127.0.0.1:44717], consumerId 1
2024-02-05T18:22:21,845 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x12f99752, L:/127.0.0.1:44717 - R:/127.0.0.1:55970]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-d703135509. consumerId: 1
2024-02-05T18:22:21,857 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d703135509] Created new subscription for 1
2024-02-05T18:22:21,857 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:55970] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-d703135509
2024-02-05T18:22:21,858 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d703135509] Subscribed to topic on localhost/127.0.0.1:44717 -- consumer: 1
2024-02-05T18:22:21,874 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xba0aede5, L:/127.0.0.1:55970 - R:localhost/127.0.0.1:44717]
2024-02-05T18:22:21,881 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:55970] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:55970, producerName=test-0-5, producerId=2}
2024-02-05T18:22:21,887 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0xba0aede5, L:/127.0.0.1:55970 - R:localhost/127.0.0.1:44717]
2024-02-05T18:22:21,889 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:22:21,892 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:22:21,896 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:42099 plays a follower now.
2024-02-05T18:22:21,921 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:42099/__change_events
2024-02-05T18:22:21,946 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:42099/0x00000000_0xffffffff - localhost:42099.
2024-02-05T18:22:21,947 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:42099/0x00000000_0xffffffff
2024-02-05T18:22:21,948 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:42099
2024-02-05T18:22:21,949 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:42099/0x00000000_0xffffffff - localhost:42099.
2024-02-05T18:22:21,950 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:42099/0x00000000_0xffffffff
2024-02-05T18:22:21,953 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:42099
2024-02-05T18:22:21,955 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:42099 doesn't exist.
2024-02-05T18:22:21,956 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:42099/__change_events][reader-67ffa0d8f2] Subscribing to topic on cnx [id: 0x642d63aa, L:/127.0.0.1:36014 - R:localhost/127.0.0.1:40359], consumerId 2
2024-02-05T18:22:21,957 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xa2b0d16c, L:/127.0.0.1:40359 - R:/127.0.0.1:36014]] Subscribing on topic persistent://sla-monitor/test/localhost:42099/__change_events / reader-67ffa0d8f2. consumerId: 2
2024-02-05T18:22:21,957 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=2, bootstrap service port = 42099, tls-port = Optional[33897], broker url= pulsar://localhost:40359, broker tls url= pulsar+ssl://localhost:44551, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[40359], brokerServicePortTls=Optional[44551], webServicePort=Optional[42099], webServicePortTls=Optional[33897], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:22:21,965 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:42099/persistent/__change_events
2024-02-05T18:22:21,968 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:42099/persistent/__change_events'
2024-02-05T18:22:21,978 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:22:21,979 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:42099/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:22:21,993 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:42099/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:22:21,997 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:42099/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:22:22,001 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:42099/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:42099/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:22:22,002 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:42099/__change_events - dedup is disabled
2024-02-05T18:22:22,011 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:22:22,020 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:42099/__change_events][reader-67ffa0d8f2] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:22:22,020 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:42099/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:22:22,020 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:42099/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:42099/persistent/__change_events, cursor=reader-67ffa0d8f2, ackPos=9:-1, readPos=9:0}
2024-02-05T18:22:22,022 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:36014] Created subscription on topic persistent://sla-monitor/test/localhost:42099/__change_events / reader-67ffa0d8f2
2024-02-05T18:22:22,024 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:42099/__change_events][reader-67ffa0d8f2] Subscribed to topic on localhost/127.0.0.1:40359 -- consumer: 2
2024-02-05T18:22:22,180 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:22:22,182 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:22 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:22:22,210 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:22:22,211 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:22 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 21
2024-02-05T18:22:22,235 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:22:22,235 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:22:22,240 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:22:22,241 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:22 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:22:22,261 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:22:22,261 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:22:22,262 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:22:22,263 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:22 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 16
2024-02-05T18:22:22,266 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:22:22,266 - INFO  - [pulsar-7-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:22:22,275 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:22:22,275 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:22:22,280 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:22:22,281 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:22 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:22:22,296 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:22:22,296 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:22:22,296 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:22:22,297 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:22 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T18:22:22,303 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:22:22,306 - INFO  - [pulsar-62-5:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:22:22,333 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:22:22,345 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:22:22,345 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:22:22,358 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:22:22,367 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:22:22,383 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:42099 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:22:22,449 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:22:22,449 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:22:22,427 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:42099, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150142385, versionId=1]. totalHandledRequests:1
2024-02-05T18:22:22,456 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:22:22,457 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:42099, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150142427, versionId=2]. totalHandledRequests:1
2024-02-05T18:22:22,466 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:22:22,478 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:22 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 123
2024-02-05T18:22:22,498 - INFO  - [pulsar-web-84-6:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:22:22,498 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-a47c4dfc5e] Subscribing to topic on cnx [id: 0x642d63aa, L:/127.0.0.1:36014 - R:localhost/127.0.0.1:40359], consumerId 3
2024-02-05T18:22:22,509 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xa2b0d16c, L:/127.0.0.1:40359 - R:/127.0.0.1:36014]] Subscribing on topic persistent://public/test/__change_events / reader-a47c4dfc5e. consumerId: 3
2024-02-05T18:22:22,528 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:22:22,533 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:42099, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150142522, versionId=3]. totalHandledRequests:1
2024-02-05T18:22:22,533 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:22:22,536 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:22:22,539 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:22:22,540 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:22:22,548 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:22:22,553 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:22:22,559 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:22:22,561 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:22:22,563 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:22:22,564 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:22:22,565 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:22:22,572 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:22:22,574 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:22:22,580 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:22:22,583 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 49.0 ms
2024-02-05T18:22:22,592 - WARN  - [broker-client-shared-internal-executor-65-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42099. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:22:22,592 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:42099, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150142534, versionId=4]. totalHandledRequests:1
2024-02-05T18:22:22,593 - WARN  - [broker-client-shared-internal-executor-65-1:ServerCnx@1299] - [/127.0.0.1:36014][persistent://public/test/__change_events][reader-a47c4dfc5e] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42099. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:22:22,596 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:22:22,596 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:22:22,596 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x642d63aa, L:/127.0.0.1:36014 - R:localhost/127.0.0.1:40359] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42099. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:22:22,597 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:22 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 109
2024-02-05T18:22:22,598 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:22:22,598 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-a47c4dfc5e] Failed to subscribe to topic on localhost/127.0.0.1:40359
2024-02-05T18:22:22,598 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42099. Please redo the lookup. Request is denied: namespace=public/test","reqId":907719632545837132, "remote":"localhost/127.0.0.1:40359", "local":"/127.0.0.1:36014"}
2024-02-05T18:22:22,599 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:22:22 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 270
2024-02-05T18:22:22,599 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42099. Please redo the lookup. Request is denied: namespace=public/test","reqId":907719632545837132, "remote":"localhost/127.0.0.1:40359", "local":"/127.0.0.1:36014"} -- Will try again in 0.1 s
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8593fb], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@256de8c6] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8593fb, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c68ccfa], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@256de8c6, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7164082c] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8593fb, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c68ccfa, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@56d957b0], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@256de8c6, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7164082c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1c38be75] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8593fb, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c68ccfa, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@56d957b0, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@56fdae14], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@256de8c6, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7164082c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1c38be75, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@789f98f] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8593fb, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c68ccfa, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@56d957b0, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@56fdae14, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1bf15a19], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@256de8c6, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7164082c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1c38be75, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@789f98f, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42e39404] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8593fb, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c68ccfa, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@56d957b0, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@56fdae14, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1bf15a19, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@79551f42], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@256de8c6, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7164082c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1c38be75, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@789f98f, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42e39404, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31d8d466] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8593fb, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c68ccfa, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@56d957b0, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@56fdae14, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1bf15a19, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@79551f42, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@20e871d6], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@256de8c6, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7164082c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1c38be75, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@789f98f, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42e39404, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31d8d466, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7ef5927b] 
2024-02-05T18:22:22,702 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Reconnecting after connection was closed
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:22:22,712 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:42099. Skipping this broker. Phase one
2024-02-05T18:22:22,712 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:43281. Skipping this broker. Phase one
2024-02-05T18:22:22,713 - INFO  - [configuration-metadata-store-59-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:42099 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:22:22,723 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:42099, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150142713, versionId=5]. totalHandledRequests:8
2024-02-05T18:22:22,737 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:42099, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150142725, versionId=6]. totalHandledRequests:6
2024-02-05T18:22:22,741 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:22:22,742 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-a47c4dfc5e] Subscribing to topic on cnx [id: 0x642d63aa, L:/127.0.0.1:36014 - R:localhost/127.0.0.1:40359], consumerId 3
2024-02-05T18:22:22,742 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:22:22,744 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xa2b0d16c, L:/127.0.0.1:40359 - R:/127.0.0.1:36014]] Subscribing on topic persistent://public/test/__change_events / reader-a47c4dfc5e. consumerId: 3
2024-02-05T18:22:22,756 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:22:22,758 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@6a4ec62d{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:22:22,762 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:22:22,763 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:22:22,764 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@4c902a72{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:22:22,764 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:22:22,765 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@36b6ce5d{/static,null,STOPPED}
2024-02-05T18:22:22,766 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3af4b14e{/metrics,null,STOPPED}
2024-02-05T18:22:22,772 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:22:22,773 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:22:22,774 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:22:22,775 - ERROR - [pulsar-io-64-2:ClientCnx@1196] - [id: 0x642d63aa, L:/127.0.0.1:36014 - R:localhost/127.0.0.1:40359] Close connection because received internal-server error {"errorMsg":"Failed due to pulsar service is not ready","reqId":907719632545837135, "remote":"localhost/127.0.0.1:40359", "local":"/127.0.0.1:36014"}
2024-02-05T18:22:22,776 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x642d63aa, L:/127.0.0.1:36014 ! R:localhost/127.0.0.1:40359] Disconnected
2024-02-05T18:22:22,778 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-a47c4dfc5e] Failed to subscribe to topic on localhost/127.0.0.1:40359
2024-02-05T18:22:22,778 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$ConnectException: Disconnected from server at localhost/127.0.0.1:40359
2024-02-05T18:22:22,778 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$ConnectException: Disconnected from server at localhost/127.0.0.1:40359 -- Will try again in 0.186 s
2024-02-05T18:22:22,781 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@352df548{/topics,null,STOPPED}
2024-02-05T18:22:22,781 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:36014
2024-02-05T18:22:22,782 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:42099/__change_events, name=reader-67ffa0d8f2}, consumerId=2, consumerName=2d8a8, address=/127.0.0.1:36014}
2024-02-05T18:22:22,783 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:42099/__change_events][reader-67ffa0d8f2] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:42099/persistent/__change_events, cursor=reader-67ffa0d8f2, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:22:22,783 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@60a98fa6{/lookup,null,STOPPED}
2024-02-05T18:22:22,784 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:42099/__change_events] [reader-67ffa0d8f2] Closed connection [id: 0x642d63aa, L:/127.0.0.1:36014 ! R:localhost/127.0.0.1:40359] -- Will try again in 0.1 s
2024-02-05T18:22:22,786 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@44cd3ea9{/admin/v3,null,STOPPED}
2024-02-05T18:22:22,785 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:42099/__change_events][reader-67ffa0d8f2] Successfully closed dispatcher for reader
2024-02-05T18:22:22,788 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:22:22,788 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:22:22,788 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:22:22,793 - WARN  - [broker-client-shared-internal-executor-65-1:BinaryProtoLookupService@234] - [persistent://public/test/__change_events] failed to get Partitioned metadata : {"errorMsg":"Failed due to pulsar service is not ready","reqId":907719632545837135, "remote":"localhost/127.0.0.1:40359", "local":"/127.0.0.1:36014"}
org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":907719632545837135, "remote":"localhost/127.0.0.1:40359", "local":"/127.0.0.1:36014"}
	at org.apache.pulsar.client.impl.ClientCnx.getPulsarClientException(ClientCnx.java:1282) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ClientCnx.handlePartitionResponse(ClientCnx.java:662) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.common.protocol.PulsarDecoder.channelRead(PulsarDecoder.java:144) ~[pulsar-common-3.0.2.jar:3.0.2]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[netty-codec-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[netty-codec-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.flush.FlushConsolidationHandler.channelRead(FlushConsolidationHandler.java:152) ~[netty-handler-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:800) ~[netty-transport-classes-epoll-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:509) ~[netty-transport-classes-epoll-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:407) ~[netty-transport-classes-epoll-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
2024-02-05T18:22:22,798 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:22:22,801 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45dc4d1a{/admin/v2,null,STOPPED}
2024-02-05T18:22:22,804 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-a47c4dfc5e] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:22:22,804 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:22:22,804 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a47c4dfc5e, ackPos=13:-1, readPos=13:0}
2024-02-05T18:22:22,806 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-a47c4dfc5e}, consumerId=3, consumerName=98d7c, address=/127.0.0.1:36014}
2024-02-05T18:22:22,806 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-a47c4dfc5e] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a47c4dfc5e, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:22:22,806 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-a47c4dfc5e] Successfully closed dispatcher for reader
2024-02-05T18:22:22,807 - ERROR - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@954] - [persistent://public/test/__change_events] Failed to create subscription: reader-a47c4dfc5e
java.util.concurrent.CompletionException: org.apache.pulsar.broker.service.BrokerServiceException: Connection was closed while the opening the cursor 
	at java.util.concurrent.CompletableFuture.encodeRelay(CompletableFuture.java:368) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1189) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.service.persistent.PersistentTopic.lambda$internalSubscribe$20(PersistentTopic.java:896) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.service.persistent.PersistentTopic.lambda$internalSubscribe$22(PersistentTopic.java:891) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.service.persistent.PersistentTopic.internalSubscribe(PersistentTopic.java:812) ~[classes/:?]
	at org.apache.pulsar.broker.service.persistent.PersistentTopic.subscribe(PersistentTopic.java:786) ~[classes/:?]
	at org.apache.pulsar.broker.service.ServerCnx.lambda$handleSubscribe$15(ServerCnx.java:1255) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorage.lambda$closeLedger$42(BookkeeperSchemaStorage.java:621) ~[classes/:?]
	at org.apache.bookkeeper.client.PulsarMockLedgerHandle.lambda$asyncClose$1(PulsarMockLedgerHandle.java:96) ~[testmocks-3.0.2.jar:4.16.3]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:482) ~[?:?]
	at org.apache.bookkeeper.common.util.SingleThreadExecutor.safeRunTask(SingleThreadExecutor.java:137) ~[bookkeeper-common-4.16.3.jar:4.16.3]
	at org.apache.bookkeeper.common.util.SingleThreadExecutor.run(SingleThreadExecutor.java:107) ~[bookkeeper-common-4.16.3.jar:4.16.3]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.service.BrokerServiceException: Connection was closed while the opening the cursor 
	at org.apache.pulsar.broker.service.persistent.PersistentTopic.lambda$internalSubscribe$19(PersistentTopic.java:920) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 22 more
2024-02-05T18:22:22,808 - WARN  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1299] - [/127.0.0.1:36014][persistent://public/test/__change_events][reader-a47c4dfc5e] Failed to create consumer: consumerId=3, Connection was closed while the opening the cursor 
2024-02-05T18:22:22,811 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@4dbcc8ce{/admin,null,STOPPED}
2024-02-05T18:22:22,813 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1de78f97{/,null,STOPPED}
2024-02-05T18:22:22,827 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:22:22,830 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:22:22,831 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:22:22,832 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42099
2024-02-05T18:22:22,835 - WARN  - [ForkJoinPool.commonPool-worker-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:43281. Skipping this broker. Phase one
2024-02-05T18:22:22,835 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:42099, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150142725, versionId=6] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:43281, sourceBroker=localhost:42099, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150142835, versionId=7]
2024-02-05T18:22:22,847 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:43281, sourceBroker=localhost:42099, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150142835, versionId=7]. totalHandledRequests:7
2024-02-05T18:22:22,849 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:43281 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:43281, sourceBroker=localhost:42099, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150142835, versionId=7], next:, totalHandledRequests:7, totalFailedRequests:6
2024-02-05T18:22:22,850 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:22:22,854 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:22:22,854 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:22:22,854 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:22:22,854 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:22:22,856 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:22:22,857 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:22:22,859 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:22:22,860 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:22:22,861 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 8.0 ms
2024-02-05T18:22:22,886 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:22:22,886 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://sla-monitor/test/localhost:42099/__change_events] [reader-67ffa0d8f2] Reconnecting after timeout
2024-02-05T18:22:22,888 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0x13b5245e, L:/127.0.0.1:36020 - R:localhost/127.0.0.1:40359]] Connected to server
2024-02-05T18:22:22,890 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-7ee56e49d0] Subscribing to topic on cnx [id: 0xd9211ced, L:/127.0.0.1:52492 - R:localhost/127.0.0.1:44717], consumerId 4
2024-02-05T18:22:22,892 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:36020
2024-02-05T18:22:22,892 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x2b11cbe4, L:/127.0.0.1:44717 - R:/127.0.0.1:52492]] Subscribing on topic persistent://public/test/__change_events / reader-7ee56e49d0. consumerId: 4
2024-02-05T18:22:22,893 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0x13b5245e, L:/127.0.0.1:36020 - R:localhost/127.0.0.1:40359] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:22:22,893 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0x13b5245e, L:/127.0.0.1:36020 - R:localhost/127.0.0.1:40359] Received unknown request id from server: -1
2024-02-05T18:22:22,894 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0x13b5245e, L:/127.0.0.1:36020 ! R:localhost/127.0.0.1:40359] Disconnected
2024-02-05T18:22:22,894 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0x13b5245e, L:/127.0.0.1:36020 ! R:localhost/127.0.0.1:40359]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:22,895 - WARN  - [pulsar-io-64-3:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:42099/__change_events] [reader-67ffa0d8f2] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:22,896 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 100 ms
2024-02-05T18:22:22,895 - WARN  - [pulsar-io-64-3:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:42099/__change_events] [reader-67ffa0d8f2] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.192 s
2024-02-05T18:22:22,904 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x6d9865f9, L:/127.0.0.1:36022 - R:localhost/127.0.0.1:40359]] Connected to server
2024-02-05T18:22:22,905 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:22:22,906 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x6d9865f9, L:/127.0.0.1:36022 - R:localhost/127.0.0.1:40359] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:22:22,906 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:36022
2024-02-05T18:22:22,906 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0x6d9865f9, L:/127.0.0.1:36022 - R:localhost/127.0.0.1:40359] Received unknown request id from server: -1
2024-02-05T18:22:22,907 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x6d9865f9, L:/127.0.0.1:36022 ! R:localhost/127.0.0.1:40359] Disconnected
2024-02-05T18:22:22,907 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0x6d9865f9, L:/127.0.0.1:36022 ! R:localhost/127.0.0.1:40359]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:22,910 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 14
2024-02-05T18:22:22,911 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 14 after closed null
2024-02-05T18:22:22,915 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=13 rc=0
2024-02-05T18:22:22,920 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:22:22,920 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:22:22,924 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 14:-1
2024-02-05T18:22:22,924 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=14:-1 -- todo=0
2024-02-05T18:22:22,925 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:22:22,930 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:22:22,938 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-7ee56e49d0] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:22:22,938 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=14:0 mark-delete-position=14:-1
2024-02-05T18:22:22,939 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-7ee56e49d0, ackPos=14:-1, readPos=14:0}
2024-02-05T18:22:22,941 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52492] Created subscription on topic persistent://public/test/__change_events / reader-7ee56e49d0
2024-02-05T18:22:22,942 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-7ee56e49d0] Subscribed to topic on localhost/127.0.0.1:44717 -- consumer: 4
2024-02-05T18:22:22,965 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Reconnecting after connection was closed
2024-02-05T18:22:22,967 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x7ae6a0cc, L:/127.0.0.1:36030 - R:localhost/127.0.0.1:40359]] Connected to server
2024-02-05T18:22:22,970 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0x7ae6a0cc, L:/127.0.0.1:36030 - R:localhost/127.0.0.1:40359] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:22:22,970 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:36030
2024-02-05T18:22:22,970 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0x7ae6a0cc, L:/127.0.0.1:36030 - R:localhost/127.0.0.1:40359] Received unknown request id from server: -1
2024-02-05T18:22:22,971 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x7ae6a0cc, L:/127.0.0.1:36030 ! R:localhost/127.0.0.1:40359] Disconnected
2024-02-05T18:22:22,971 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0x7ae6a0cc, L:/127.0.0.1:36030 ! R:localhost/127.0.0.1:40359]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:22,971 - WARN  - [pulsar-io-64-1:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:22,971 - WARN  - [pulsar-io-64-1:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.371 s
2024-02-05T18:22:23,094 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 186 ms
2024-02-05T18:22:23,094 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:42099/__change_events] [reader-67ffa0d8f2] Reconnecting after connection was closed
2024-02-05T18:22:23,095 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0x1a11cf8b, L:/127.0.0.1:36038 - R:localhost/127.0.0.1:40359]] Connected to server
2024-02-05T18:22:23,098 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:36038
2024-02-05T18:22:23,099 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0x1a11cf8b, L:/127.0.0.1:36038 - R:localhost/127.0.0.1:40359] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:22:23,100 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0x1a11cf8b, L:/127.0.0.1:36038 - R:localhost/127.0.0.1:40359] Received unknown request id from server: -1
2024-02-05T18:22:23,101 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0x1a11cf8b, L:/127.0.0.1:36038 ! R:localhost/127.0.0.1:40359] Disconnected
2024-02-05T18:22:23,101 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0x1a11cf8b, L:/127.0.0.1:36038 ! R:localhost/127.0.0.1:40359]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:23,101 - WARN  - [pulsar-io-64-4:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:42099/__change_events] [reader-67ffa0d8f2] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:23,101 - WARN  - [pulsar-io-64-4:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:42099/__change_events] [reader-67ffa0d8f2] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.367 s
2024-02-05T18:22:23,344 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Reconnecting after connection was closed
2024-02-05T18:22:23,346 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0x41b9ef98, L:/127.0.0.1:36040 - R:localhost/127.0.0.1:40359]] Connected to server
2024-02-05T18:22:23,348 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:36040
2024-02-05T18:22:23,348 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0x41b9ef98, L:/127.0.0.1:36040 - R:localhost/127.0.0.1:40359] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:22:23,349 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0x41b9ef98, L:/127.0.0.1:36040 - R:localhost/127.0.0.1:40359] Received unknown request id from server: -1
2024-02-05T18:22:23,349 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0x41b9ef98, L:/127.0.0.1:36040 ! R:localhost/127.0.0.1:40359] Disconnected
2024-02-05T18:22:23,349 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0x41b9ef98, L:/127.0.0.1:36040 ! R:localhost/127.0.0.1:40359]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:23,350 - WARN  - [pulsar-io-64-3:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:23,350 - WARN  - [pulsar-io-64-3:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.779 s
2024-02-05T18:22:23,361 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:22:23,362 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 46.68%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 46.68%, msgThroughputEMA= 0.00, updatedAt= 1707150143361, reportedAt= 0
2024-02-05T18:22:23,450 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:22:23,450 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:22:23,469 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:42099/__change_events] [reader-67ffa0d8f2] Reconnecting after connection was closed
2024-02-05T18:22:23,471 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x62c5d4b0, L:/127.0.0.1:36056 - R:localhost/127.0.0.1:40359]] Connected to server
2024-02-05T18:22:23,474 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x62c5d4b0, L:/127.0.0.1:36056 - R:localhost/127.0.0.1:40359] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:22:23,474 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:36056
2024-02-05T18:22:23,474 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0x62c5d4b0, L:/127.0.0.1:36056 - R:localhost/127.0.0.1:40359] Received unknown request id from server: -1
2024-02-05T18:22:23,475 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x62c5d4b0, L:/127.0.0.1:36056 ! R:localhost/127.0.0.1:40359] Disconnected
2024-02-05T18:22:23,475 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0x62c5d4b0, L:/127.0.0.1:36056 ! R:localhost/127.0.0.1:40359]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:23,475 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:42099/__change_events] [reader-67ffa0d8f2] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:23,475 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:42099/__change_events] [reader-67ffa0d8f2] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.765 s
2024-02-05T18:22:23,495 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 393 ms
2024-02-05T18:22:23,496 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x3e90f3f0, L:/127.0.0.1:36062 - R:localhost/127.0.0.1:40359]] Connected to server
2024-02-05T18:22:23,499 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0x3e90f3f0, L:/127.0.0.1:36062 - R:localhost/127.0.0.1:40359] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:22:23,499 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:36062
2024-02-05T18:22:23,499 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0x3e90f3f0, L:/127.0.0.1:36062 - R:localhost/127.0.0.1:40359] Received unknown request id from server: -1
2024-02-05T18:22:23,499 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x3e90f3f0, L:/127.0.0.1:36062 ! R:localhost/127.0.0.1:40359] Disconnected
2024-02-05T18:22:23,500 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0x3e90f3f0, L:/127.0.0.1:36062 ! R:localhost/127.0.0.1:40359]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:24,129 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Reconnecting after connection was closed
2024-02-05T18:22:24,131 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0xdfa0b1ed, L:/127.0.0.1:36074 - R:localhost/127.0.0.1:40359]] Connected to server
2024-02-05T18:22:24,134 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0xdfa0b1ed, L:/127.0.0.1:36074 - R:localhost/127.0.0.1:40359] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:22:24,134 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:36074
2024-02-05T18:22:24,134 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0xdfa0b1ed, L:/127.0.0.1:36074 - R:localhost/127.0.0.1:40359] Received unknown request id from server: -1
2024-02-05T18:22:24,134 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0xdfa0b1ed, L:/127.0.0.1:36074 ! R:localhost/127.0.0.1:40359] Disconnected
2024-02-05T18:22:24,135 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0xdfa0b1ed, L:/127.0.0.1:36074 ! R:localhost/127.0.0.1:40359]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:24,135 - WARN  - [pulsar-io-64-4:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:24,135 - WARN  - [pulsar-io-64-4:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 1.563 s
2024-02-05T18:22:24,242 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:42099/__change_events] [reader-67ffa0d8f2] Reconnecting after connection was closed
2024-02-05T18:22:24,242 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 742 ms
2024-02-05T18:22:24,244 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0xd855456e, L:/127.0.0.1:36090 - R:localhost/127.0.0.1:40359]] Connected to server
2024-02-05T18:22:24,247 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:36090
2024-02-05T18:22:24,247 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0xd855456e, L:/127.0.0.1:36090 - R:localhost/127.0.0.1:40359] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:22:24,247 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0xd855456e, L:/127.0.0.1:36090 - R:localhost/127.0.0.1:40359] Received unknown request id from server: -1
2024-02-05T18:22:24,248 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0xd855456e, L:/127.0.0.1:36090 ! R:localhost/127.0.0.1:40359] Disconnected
2024-02-05T18:22:24,248 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0xd855456e, L:/127.0.0.1:36090 ! R:localhost/127.0.0.1:40359]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:24,248 - WARN  - [pulsar-io-64-3:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:42099/__change_events] [reader-67ffa0d8f2] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:24,248 - WARN  - [pulsar-io-64-3:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:42099/__change_events] [reader-67ffa0d8f2] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 1.586 s
2024-02-05T18:22:24,451 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:22:24,452 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:22:25,452 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:22:25,453 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:22:25,692 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 1443 ms
2024-02-05T18:22:25,693 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xee03307d, L:/127.0.0.1:36106 - R:localhost/127.0.0.1:40359]] Connected to server
2024-02-05T18:22:25,695 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0xee03307d, L:/127.0.0.1:36106 - R:localhost/127.0.0.1:40359] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:22:25,695 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:36106
2024-02-05T18:22:25,695 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0xee03307d, L:/127.0.0.1:36106 - R:localhost/127.0.0.1:40359] Received unknown request id from server: -1
2024-02-05T18:22:25,696 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xee03307d, L:/127.0.0.1:36106 ! R:localhost/127.0.0.1:40359] Disconnected
2024-02-05T18:22:25,696 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0xee03307d, L:/127.0.0.1:36106 ! R:localhost/127.0.0.1:40359]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:25,700 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Reconnecting after connection was closed
2024-02-05T18:22:25,702 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xe32ecab2, L:/127.0.0.1:36118 - R:localhost/127.0.0.1:40359]] Connected to server
2024-02-05T18:22:25,704 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0xe32ecab2, L:/127.0.0.1:36118 - R:localhost/127.0.0.1:40359] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:22:25,704 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:36118
2024-02-05T18:22:25,704 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0xe32ecab2, L:/127.0.0.1:36118 - R:localhost/127.0.0.1:40359] Received unknown request id from server: -1
2024-02-05T18:22:25,704 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xe32ecab2, L:/127.0.0.1:36118 ! R:localhost/127.0.0.1:40359] Disconnected
2024-02-05T18:22:25,705 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0xe32ecab2, L:/127.0.0.1:36118 ! R:localhost/127.0.0.1:40359]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:25,705 - WARN  - [pulsar-io-64-1:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:25,705 - WARN  - [pulsar-io-64-1:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 3.071 s
2024-02-05T18:22:25,836 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:42099/__change_events] [reader-67ffa0d8f2] Reconnecting after connection was closed
2024-02-05T18:22:25,837 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0xbdb1d6de, L:/127.0.0.1:36120 - R:localhost/127.0.0.1:40359]] Connected to server
2024-02-05T18:22:25,839 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0xbdb1d6de, L:/127.0.0.1:36120 - R:localhost/127.0.0.1:40359] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:22:25,839 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:36120
2024-02-05T18:22:25,839 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0xbdb1d6de, L:/127.0.0.1:36120 - R:localhost/127.0.0.1:40359] Received unknown request id from server: -1
2024-02-05T18:22:25,840 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0xbdb1d6de, L:/127.0.0.1:36120 ! R:localhost/127.0.0.1:40359] Disconnected
2024-02-05T18:22:25,840 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0xbdb1d6de, L:/127.0.0.1:36120 ! R:localhost/127.0.0.1:40359]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:25,840 - WARN  - [pulsar-io-64-4:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:42099/__change_events] [reader-67ffa0d8f2] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:22:25,840 - WARN  - [pulsar-io-64-4:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:42099/__change_events] [reader-67ffa0d8f2] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 2.927 s
2024-02-05T18:22:25,954 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42099 in 3120.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:22:25,960 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:42099 registry has been deleted.
2024-02-05T18:22:25,960 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:42099 was invalidated. state Releasing
2024-02-05T18:22:25,960 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42099 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:22:25,961 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:42099. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:22:25,961 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42099 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:22:25,962 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42099
2024-02-05T18:22:25,962 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:42099
2024-02-05T18:22:25,962 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42099 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:22:25,969 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:42099/0x00000000_0xffffffff.
2024-02-05T18:22:25,970 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:42099/0x00000000_0xffffffff.
2024-02-05T18:22:25,971 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:42099/0x00000000_0xffffffff.
2024-02-05T18:22:25,971 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.009 seconds
2024-02-05T18:22:25,972 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:22:25,974 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:22:25,975 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:42099/persistent/__change_events] Closing managed ledger
2024-02-05T18:22:25,977 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:55970
2024-02-05T18:22:25,977 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xba0aede5, L:/127.0.0.1:55970 ! R:localhost/127.0.0.1:44717] Disconnected
2024-02-05T18:22:25,978 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0xba0aede5, L:/127.0.0.1:55970 ! R:localhost/127.0.0.1:44717] -- Will try again in 0.1 s
2024-02-05T18:22:25,978 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-c07ee0d7d9}, consumerId=0, consumerName=76074, address=/127.0.0.1:55970}
2024-02-05T18:22:25,978 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0xba0aede5, L:/127.0.0.1:55970 ! R:localhost/127.0.0.1:44717] -- Will try again in 0.1 s
2024-02-05T18:22:25,978 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0xba0aede5, L:/127.0.0.1:55970 ! R:localhost/127.0.0.1:44717] -- Will try again in 0.1 s
2024-02-05T18:22:25,978 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c07ee0d7d9] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-c07ee0d7d9, ackPos=3:6, readPos=3:7}]
2024-02-05T18:22:25,978 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c07ee0d7d9] Successfully closed dispatcher for reader
2024-02-05T18:22:25,978 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-c07ee0d7d9] Closed connection [id: 0xba0aede5, L:/127.0.0.1:55970 ! R:localhost/127.0.0.1:44717] -- Will try again in 0.1 s
2024-02-05T18:22:25,978 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:42099/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:22:25,978 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-d703135509] Closed connection [id: 0xba0aede5, L:/127.0.0.1:55970 ! R:localhost/127.0.0.1:44717] -- Will try again in 0.1 s
2024-02-05T18:22:25,979 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:22:25,979 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-d703135509}, consumerId=1, consumerName=0b82d, address=/127.0.0.1:55970}
2024-02-05T18:22:25,980 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:22:25,981 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:22:25,985 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:40359
2024-02-05T18:22:25,986 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:22:25,987 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:22:25,987 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:22:25,988 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:42099/__change_events] [reader-67ffa0d8f2] Closed Consumer (not connected)
2024-02-05T18:22:25,989 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:42099/__change_events with subscription name reader-67ffa0d8f2 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:42099/__change_events with subscription name reader-67ffa0d8f2 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:22:25,989 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-d703135509] Closed Consumer (not connected)
2024-02-05T18:22:25,990 - INFO  - [main:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-a47c4dfc5e] Closed Consumer (not connected)
2024-02-05T18:22:25,990 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-d703135509 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-d703135509 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:22:25,990 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-c07ee0d7d9] Closed Consumer (not connected)
2024-02-05T18:22:25,991 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-c07ee0d7d9 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-c07ee0d7d9 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:22:25,995 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:22:25,995 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:22:25,998 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:22:25,998 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:22:26,003 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:22:26,004 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:22:26,454 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:22:26,455 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42099 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:22:26,455 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42099 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:22:26,456 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:42099]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:22:26,456 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42099
2024-02-05T18:22:26,457 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42099 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:22:27,284 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:22:27,285 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:22:27,286 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:22:27,286 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:22:27,287 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:22:27,287 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:22:27,456 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:22:27,457 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42099 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:22:27,457 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42099 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:22:27,457 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:42099]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:22:27,458 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42099
2024-02-05T18:22:27,458 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42099 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:22:28,362 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 48.05%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 46.82%, msgThroughputEMA= 0.00, updatedAt= 1707150148360, reportedAt= 1707150143365
2024-02-05T18:22:28,458 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:22:28,458 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42099 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:22:28,459 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42099 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:22:28,459 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:42099]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:22:28,459 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42099
2024-02-05T18:22:28,460 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42099 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:22:29,299 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:22:29,301 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:22:29,301 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:22:29,301 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:22:29,302 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@1978b0d5{/static,null,STOPPED}
2024-02-05T18:22:29,302 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,STOPPED}
2024-02-05T18:22:29,304 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/topics,null,STOPPED}
2024-02-05T18:22:29,306 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,STOPPED}
2024-02-05T18:22:29,308 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,STOPPED}
2024-02-05T18:22:29,310 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,STOPPED}
2024-02-05T18:22:29,312 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin,null,STOPPED}
2024-02-05T18:22:29,314 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/,null,STOPPED}
2024-02-05T18:22:29,315 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:22:29,316 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:22:29,316 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:22:29,317 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:43281
2024-02-05T18:22:29,319 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:43281, sourceBroker=localhost:42099, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150142835, versionId=7]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:22:34,331 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:43281 in 5011.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:22:34,340 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:43281 was invalidated. state Releasing
2024-02-05T18:22:34,340 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:43281. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:22:34,341 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:43281
2024-02-05T18:22:34,345 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:43281/0x00000000_0xffffffff.
2024-02-05T18:22:34,352 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:43281, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150154346, versionId=8]. totalHandledRequests:10
2024-02-05T18:22:34,353 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:22:34,353 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:22:34,353 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:22:34,354 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-7ee56e49d0}, consumerId=4, consumerName=96a17, address=/127.0.0.1:52492}
2024-02-05T18:22:34,355 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-7ee56e49d0}, consumerId=4, consumerName=96a17, address=/127.0.0.1:52492}
2024-02-05T18:22:34,355 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-7ee56e49d0] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-7ee56e49d0, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:22:34,355 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:44717] Broker notification of Closed consumer: 4
2024-02-05T18:22:34,355 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-7ee56e49d0] Successfully closed dispatcher for reader
2024-02-05T18:22:34,355 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-7ee56e49d0] Closed connection [id: 0xd9211ced, L:/127.0.0.1:52492 - R:localhost/127.0.0.1:44717] -- Will try again in 0.1 s
2024-02-05T18:22:34,356 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-7ee56e49d0] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-7ee56e49d0, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:22:34,356 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-7ee56e49d0] Successfully disconnected and closed subscription
2024-02-05T18:22:34,356 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:22:34,359 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=14:-1
2024-02-05T18:22:34,360 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:22:34,361 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-7ee56e49d0] Closed Consumer (not connected)
2024-02-05T18:22:34,361 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 9.0 ms
2024-02-05T18:22:34,361 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-7ee56e49d0 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-7ee56e49d0 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:22:34,367 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:43281, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150154352, versionId=9]. totalHandledRequests:4
2024-02-05T18:22:34,368 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:22:34,369 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:22:34,370 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:43281/0x00000000_0xffffffff.
2024-02-05T18:22:34,370 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:22:34,371 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:43281/0x00000000_0xffffffff.
2024-02-05T18:22:34,371 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.03 seconds
2024-02-05T18:22:34,371 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:22:34,372 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:22:34,373 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:22:34,373 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0xd9211ced, L:/127.0.0.1:52492 ! R:localhost/127.0.0.1:44717] Disconnected
2024-02-05T18:22:34,373 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0xd9211ced, L:/127.0.0.1:52492 ! R:localhost/127.0.0.1:44717] -- Will try again in 0.1 s
2024-02-05T18:22:34,373 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:43281/persistent/__change_events] Closing managed ledger
2024-02-05T18:22:34,373 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0xd9211ced, L:/127.0.0.1:52492 ! R:localhost/127.0.0.1:44717] -- Will try again in 0.1 s
2024-02-05T18:22:34,374 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0xd9211ced, L:/127.0.0.1:52492 ! R:localhost/127.0.0.1:44717] -- Will try again in 0.1 s
2024-02-05T18:22:34,374 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-af1c114ef0] Closed connection [id: 0xd9211ced, L:/127.0.0.1:52492 ! R:localhost/127.0.0.1:44717] -- Will try again in 0.1 s
2024-02-05T18:22:34,374 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-73cb7fba9e] Closed connection [id: 0xd9211ced, L:/127.0.0.1:52492 ! R:localhost/127.0.0.1:44717] -- Will try again in 0.1 s
2024-02-05T18:22:34,374 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:43281/__change_events] [reader-37ef5c09d4] Closed connection [id: 0xd9211ced, L:/127.0.0.1:52492 ! R:localhost/127.0.0.1:44717] -- Will try again in 0.1 s
2024-02-05T18:22:34,374 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-652a0df086] Closed connection [id: 0xd9211ced, L:/127.0.0.1:52492 ! R:localhost/127.0.0.1:44717] -- Will try again in 0.1 s
2024-02-05T18:22:34,374 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:52492
2024-02-05T18:22:34,375 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-af1c114ef0}, consumerId=0, consumerName=8a158, address=/127.0.0.1:52492}
2024-02-05T18:22:34,375 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:22:34,375 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-af1c114ef0] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-af1c114ef0, ackPos=3:6, readPos=3:9}]
2024-02-05T18:22:34,375 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-af1c114ef0] Successfully closed dispatcher for reader
2024-02-05T18:22:34,375 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:43281/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:22:34,375 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:43281/__change_events, name=reader-37ef5c09d4}, consumerId=3, consumerName=7ab04, address=/127.0.0.1:52492}
2024-02-05T18:22:34,376 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:22:34,376 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:43281/__change_events][reader-37ef5c09d4] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:43281/persistent/__change_events, cursor=reader-37ef5c09d4, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:22:34,376 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:43281/__change_events][reader-37ef5c09d4] Successfully closed dispatcher for reader
2024-02-05T18:22:34,377 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-652a0df086}, consumerId=2, consumerName=98f66, address=/127.0.0.1:52492}
2024-02-05T18:22:34,377 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-73cb7fba9e}, consumerId=1, consumerName=7d194, address=/127.0.0.1:52492}
2024-02-05T18:22:34,377 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:22:34,378 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:22:34,382 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:44717
2024-02-05T18:22:34,382 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:22:34,382 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:22:34,382 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:22:34,382 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-73cb7fba9e] Closed Consumer (not connected)
2024-02-05T18:22:34,382 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-652a0df086] Closed Consumer (not connected)
2024-02-05T18:22:34,382 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:43281/__change_events] [reader-37ef5c09d4] Closed Consumer (not connected)
2024-02-05T18:22:34,382 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-af1c114ef0] Closed Consumer (not connected)
2024-02-05T18:22:34,382 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-73cb7fba9e was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-73cb7fba9e was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:22:34,383 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-652a0df086 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-652a0df086 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:22:34,383 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:43281/__change_events with subscription name reader-37ef5c09d4 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:43281/__change_events with subscription name reader-37ef5c09d4 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:22:34,384 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-af1c114ef0 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-af1c114ef0 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:22:34,386 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:22:34,387 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:22:34,387 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:22:34,387 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:22:34,387 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:22:34,389 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:22:34,391 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:22:34,391 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:22:35,778 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:22:35,778 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:22:35,780 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:22:35,780 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:22:35,780 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:22:35,780 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:22:35,787 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:22:35,787 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:22:35,791 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:22:35,791 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:22:35,791 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:22:35,791 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:22:35,792 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:22:35,792 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:22:35,792 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:22:35,792 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:22:35,792 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 187 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:22:35,792 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 193 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T18:22:35,792 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 8 new threads
2024-02-05T18:22:35,792 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:22:35,792 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@2a59034e
2024-02-05T18:22:35,792 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:22:35,792 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:22:35,793 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 31.11 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  56.947 s
[INFO] Finished at: 2024-02-05T18:22:36+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 6 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:23:07,105 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:23:08,038 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:23:08,040 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:23:08,511 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:23:08,512 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:23:08,513 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:23:08,514 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:23:08,514 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:23:08,515 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:23:08,530 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:23:08,531 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:23:08,532 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:23:08,532 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:23:08,533 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:23:08,533 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:23:08,534 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:23:08,535 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:23:08,535 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:23:08,536 - INFO  - [main:Environment@98] - Client environment:os.memory.free=42MB
2024-02-05T18:23:08,536 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:23:08,537 - INFO  - [main:Environment@98] - Client environment:os.memory.total=130MB
2024-02-05T18:23:10,125 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:23:10,125 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:23:10,126 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:23:10,126 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:23:10,485 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:23:10,487 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:23:10,577 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:23:10,658 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:23:10,661 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:23:10,677 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:23:10,769 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:23:10,812 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:23:10,850 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:23:11,201 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:23:11,202 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:23:11,231 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:23:11,286 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:39527, TLS: (none), listener: (none)
2024-02-05T18:23:11,598 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:38049, TLS: OPENSSL, listener: (none)
2024-02-05T18:23:11,621 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:23:11,626 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:23:11,626 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:23:11,667 - INFO  - [main:Log@170] - Logging initialized @6679ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:23:12,511 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:23:12,543 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:23:12,544 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:23:12,546 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:23:13,290 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/,null,AVAILABLE}
2024-02-05T18:23:14,389 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin,null,AVAILABLE}
2024-02-05T18:23:15,386 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,AVAILABLE}
2024-02-05T18:23:15,785 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,AVAILABLE}
2024-02-05T18:23:15,903 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,AVAILABLE}
2024-02-05T18:23:16,101 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/topics,null,AVAILABLE}
2024-02-05T18:23:16,103 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,AVAILABLE}
2024-02-05T18:23:16,106 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@1978b0d5{/static,null,AVAILABLE}
2024-02-05T18:23:16,122 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:45337}
2024-02-05T18:23:16,270 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:33179}
2024-02-05T18:23:16,271 - INFO  - [main:Server@415] - Started @11289ms
2024-02-05T18:23:16,271 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:45337
2024-02-05T18:23:16,273 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:33179
2024-02-05T18:23:16,282 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:23:16,283 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:23:16,469 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:45337
2024-02-05T18:23:16,489 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:23:16,492 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:45337 is changing the role from null to Leader
2024-02-05T18:23:16,497 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:45337).
2024-02-05T18:23:16,764 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:45337 
2024-02-05T18:23:17,236 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:23:17,267 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:23:17,384 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:23:17,389 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:23:17,399 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:23:17,403 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:23:17,452 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:23:17,489 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:23:17,525 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:23:17,602 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:23:17,630 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:23:17,643 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:23:17,647 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:23:17,688 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:23:17,692 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:23:17 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 628
2024-02-05T18:23:17,888 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0xa1d4cc35, L:/127.0.0.1:35932 - R:localhost/127.0.0.1:39527]] Connected to server
2024-02-05T18:23:17,929 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:35932] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:23:18,008 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:23:18,020 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xa1d4cc35, L:/127.0.0.1:35932 - R:localhost/127.0.0.1:39527]
2024-02-05T18:23:18,088 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:23:18,128 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:35932] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:35932, producerName=test-0-0, producerId=0}
2024-02-05T18:23:18,139 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0xa1d4cc35, L:/127.0.0.1:35932 - R:localhost/127.0.0.1:39527]
2024-02-05T18:23:18,141 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:23:18,208 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:23:18,211 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-8d679dde6a] Subscribing to topic on cnx [id: 0xa1d4cc35, L:/127.0.0.1:35932 - R:localhost/127.0.0.1:39527], consumerId 0
2024-02-05T18:23:18,223 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x2f925c8e, L:/127.0.0.1:39527 - R:/127.0.0.1:35932]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-8d679dde6a. consumerId: 0
2024-02-05T18:23:18,254 - INFO  - [pulsar-io-9-1:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-8d679dde6a] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:23:18,255 - INFO  - [pulsar-io-9-1:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:23:18,256 - INFO  - [pulsar-io-9-1:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-8d679dde6a, ackPos=3:-1, readPos=3:0}
2024-02-05T18:23:18,282 - INFO  - [pulsar-io-9-1:ServerCnx@1263] - [/127.0.0.1:35932] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-8d679dde6a
2024-02-05T18:23:18,290 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-8d679dde6a] Subscribed to topic on localhost/127.0.0.1:39527 -- consumer: 0
2024-02-05T18:23:18,304 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.012 seconds
2024-02-05T18:23:18,305 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:23:18,307 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:23:18,307 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:23:18,348 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:23:18,364 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:23:18,365 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:23:18,367 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:23:18,370 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:23:18 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 48
2024-02-05T18:23:18,381 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:23:18,392 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:23:18,393 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:23:18,394 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:23:18 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:23:18,395 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:23:18,418 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:23:18,421 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xa1d4cc35, L:/127.0.0.1:35932 - R:localhost/127.0.0.1:39527]
2024-02-05T18:23:18,429 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:23:18,436 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:35932] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:35932, producerName=test-0-1, producerId=1}
2024-02-05T18:23:18,437 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0xa1d4cc35, L:/127.0.0.1:35932 - R:localhost/127.0.0.1:39527]
2024-02-05T18:23:18,452 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:23:18,453 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-6f9200e8f8] Subscribing to topic on cnx [id: 0xa1d4cc35, L:/127.0.0.1:35932 - R:localhost/127.0.0.1:39527], consumerId 1
2024-02-05T18:23:18,456 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x2f925c8e, L:/127.0.0.1:39527 - R:/127.0.0.1:35932]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-6f9200e8f8. consumerId: 1
2024-02-05T18:23:18,481 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-6f9200e8f8] Created new subscription for 1
2024-02-05T18:23:18,482 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:35932] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-6f9200e8f8
2024-02-05T18:23:18,488 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-6f9200e8f8] Subscribed to topic on localhost/127.0.0.1:39527 -- consumer: 1
2024-02-05T18:23:18,511 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:23:18,512 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xa1d4cc35, L:/127.0.0.1:35932 - R:localhost/127.0.0.1:39527]
2024-02-05T18:23:18,519 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:23:18,527 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:35932] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:35932, producerName=test-0-2, producerId=2}
2024-02-05T18:23:18,530 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0xa1d4cc35, L:/127.0.0.1:35932 - R:localhost/127.0.0.1:39527]
2024-02-05T18:23:18,544 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:23:18,572 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:23:18,579 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:45337 started the ownership monitor.
2024-02-05T18:23:18,596 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:23:18,598 - INFO  - [pulsar-load-manager-6-1:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-19b6384eb8] Subscribing to topic on cnx [id: 0xa1d4cc35, L:/127.0.0.1:35932 - R:localhost/127.0.0.1:39527], consumerId 2
2024-02-05T18:23:18,600 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x2f925c8e, L:/127.0.0.1:39527 - R:/127.0.0.1:35932]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-19b6384eb8. consumerId: 2
2024-02-05T18:23:18,616 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:45337/__change_events
2024-02-05T18:23:18,619 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-19b6384eb8] Created new subscription for 2
2024-02-05T18:23:18,619 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:35932] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-19b6384eb8
2024-02-05T18:23:18,620 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-19b6384eb8] Subscribed to topic on localhost/127.0.0.1:39527 -- consumer: 2
2024-02-05T18:23:18,621 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:45337 plays the leader now.
2024-02-05T18:23:18,626 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.91%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 53.91%, msgThroughputEMA= 0.00, updatedAt= 1707150198625, reportedAt= 0
2024-02-05T18:23:18,651 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:23:18,658 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:23:18,663 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:23:18,737 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:45337/0x00000000_0xffffffff - localhost:45337.
2024-02-05T18:23:18,740 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:45337/0x00000000_0xffffffff
2024-02-05T18:23:18,743 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:45337
2024-02-05T18:23:18,744 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:45337/0x00000000_0xffffffff - localhost:45337.
2024-02-05T18:23:18,745 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:45337/__change_events][reader-4d808a001f] Subscribing to topic on cnx [id: 0xa1d4cc35, L:/127.0.0.1:35932 - R:localhost/127.0.0.1:39527], consumerId 3
2024-02-05T18:23:18,746 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:45337/0x00000000_0xffffffff
2024-02-05T18:23:18,747 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x2f925c8e, L:/127.0.0.1:39527 - R:/127.0.0.1:35932]] Subscribing on topic persistent://sla-monitor/test/localhost:45337/__change_events / reader-4d808a001f. consumerId: 3
2024-02-05T18:23:18,747 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:45337
2024-02-05T18:23:18,757 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:45337/persistent/__change_events
2024-02-05T18:23:18,758 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:45337/persistent/__change_events'
2024-02-05T18:23:18,761 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:45337 doesn't exist.
2024-02-05T18:23:18,765 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:23:18,766 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:45337/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:23:18,773 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:45337/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:23:18,779 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:45337/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:23:18,784 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:45337/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:45337/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:23:18,785 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:45337/__change_events - dedup is disabled
2024-02-05T18:23:18,798 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:23:18,806 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:45337/__change_events][reader-4d808a001f] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:23:18,806 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:45337/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:23:18,807 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:45337/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:45337/persistent/__change_events, cursor=reader-4d808a001f, ackPos=7:-1, readPos=7:0}
2024-02-05T18:23:18,809 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:35932] Created subscription on topic persistent://sla-monitor/test/localhost:45337/__change_events / reader-4d808a001f
2024-02-05T18:23:18,811 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:45337/__change_events][reader-4d808a001f] Subscribed to topic on localhost/127.0.0.1:39527 -- consumer: 3
2024-02-05T18:23:18,795 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 45337, tls-port = Optional[33179], broker url= pulsar://localhost:39527, broker tls url= pulsar+ssl://localhost:38049, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[39527], brokerServicePortTls=Optional[38049], webServicePort=Optional[45337], webServicePortTls=Optional[33179], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:23:19,338 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:23:19,338 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:23:19,338 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:23:19,339 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:23:19,345 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:23:19,346 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:23:19,352 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:23:19,356 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:23:19,364 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:23:19,364 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:23:19,371 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:23:19,376 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:23:19,379 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:23:19,393 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:23:19,394 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:23:19,402 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:23:19,404 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:46431, TLS: (none), listener: (none)
2024-02-05T18:23:19,406 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:36185, TLS: OPENSSL, listener: (none)
2024-02-05T18:23:19,410 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:23:19,411 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:23:19,412 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:23:19,425 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:23:19,432 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:23:19,432 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:23:19,432 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:23:19,521 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/,null,AVAILABLE}
2024-02-05T18:23:19,674 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:23:19,674 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:23:20,054 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin,null,AVAILABLE}
2024-02-05T18:23:20,675 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:23:20,676 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:23:21,323 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/admin/v2,null,AVAILABLE}
2024-02-05T18:23:21,532 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@633e4742{/admin/v3,null,AVAILABLE}
2024-02-05T18:23:21,589 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/lookup,null,AVAILABLE}
2024-02-05T18:23:21,668 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/topics,null,AVAILABLE}
2024-02-05T18:23:21,669 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/metrics,null,AVAILABLE}
2024-02-05T18:23:21,669 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@45ec9b22{/static,null,AVAILABLE}
2024-02-05T18:23:21,673 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@352df548{HTTP/1.1, (http/1.1)}{0.0.0.0:44851}
2024-02-05T18:23:21,680 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:23:21,680 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:23:21,692 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@4dbcc8ce{SSL, (ssl, http/1.1)}{0.0.0.0:39357}
2024-02-05T18:23:21,697 - INFO  - [main:Server@415] - Started @16712ms
2024-02-05T18:23:21,697 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:44851
2024-02-05T18:23:21,699 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:39357
2024-02-05T18:23:21,703 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:23:21,703 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:23:21,716 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:44851
2024-02-05T18:23:21,717 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:44851 registry has been created.
2024-02-05T18:23:21,717 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:44851. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:23:21,722 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:44851 is changing the role from null to Follower
2024-02-05T18:23:21,726 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:45337).
2024-02-05T18:23:21,729 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:23:21,750 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:44851 
2024-02-05T18:23:21,885 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:23:21 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 64
2024-02-05T18:23:21,909 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:23:21,912 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:23:21,914 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:23:21,927 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:23:21 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 37
2024-02-05T18:23:21,933 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:44851/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:23:21,943 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x2d22444b, L:/127.0.0.1:36700 - R:localhost/127.0.0.1:46431]] Connected to server
2024-02-05T18:23:21,949 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:36700] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:23:21,971 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x1210fa91, L:/127.0.0.1:53974 - R:localhost/127.0.0.1:39527]] Connected to server
2024-02-05T18:23:21,975 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:53974] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:23:21,976 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x1210fa91, L:/127.0.0.1:53974 - R:localhost/127.0.0.1:39527]
2024-02-05T18:23:21,990 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:53974] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:53974, producerName=test-0-3, producerId=0}
2024-02-05T18:23:21,992 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x1210fa91, L:/127.0.0.1:53974 - R:localhost/127.0.0.1:39527]
2024-02-05T18:23:22,007 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-e03e2c7983] Subscribing to topic on cnx [id: 0x1210fa91, L:/127.0.0.1:53974 - R:localhost/127.0.0.1:39527], consumerId 0
2024-02-05T18:23:22,010 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x6ea955a6, L:/127.0.0.1:39527 - R:/127.0.0.1:53974]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-e03e2c7983. consumerId: 0
2024-02-05T18:23:22,016 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-e03e2c7983] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:23:22,016 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:23:22,017 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-e03e2c7983, ackPos=3:-1, readPos=3:0}
2024-02-05T18:23:22,020 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:53974] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-e03e2c7983
2024-02-05T18:23:22,021 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-e03e2c7983] Subscribed to topic on localhost/127.0.0.1:39527 -- consumer: 0
2024-02-05T18:23:22,025 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.003 seconds
2024-02-05T18:23:22,026 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:23:22,044 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:23:22 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:23:22,053 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:23:22,056 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:23:22,056 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:23:22,060 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:44851/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:23:22,063 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:23:22 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T18:23:22,078 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:23:22 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:23:22,085 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:23:22,088 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:23:22,089 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:23:22,093 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:44851/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:23:22,094 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:23:22 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:23:22,110 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x1210fa91, L:/127.0.0.1:53974 - R:localhost/127.0.0.1:39527]
2024-02-05T18:23:22,118 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:53974] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:53974, producerName=test-0-4, producerId=1}
2024-02-05T18:23:22,120 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x1210fa91, L:/127.0.0.1:53974 - R:localhost/127.0.0.1:39527]
2024-02-05T18:23:22,134 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-b0635726c4] Subscribing to topic on cnx [id: 0x1210fa91, L:/127.0.0.1:53974 - R:localhost/127.0.0.1:39527], consumerId 1
2024-02-05T18:23:22,136 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x6ea955a6, L:/127.0.0.1:39527 - R:/127.0.0.1:53974]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-b0635726c4. consumerId: 1
2024-02-05T18:23:22,147 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-b0635726c4] Created new subscription for 1
2024-02-05T18:23:22,147 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:53974] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-b0635726c4
2024-02-05T18:23:22,148 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-b0635726c4] Subscribed to topic on localhost/127.0.0.1:39527 -- consumer: 1
2024-02-05T18:23:22,166 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x1210fa91, L:/127.0.0.1:53974 - R:localhost/127.0.0.1:39527]
2024-02-05T18:23:22,173 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:53974] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:53974, producerName=test-0-5, producerId=2}
2024-02-05T18:23:22,174 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x1210fa91, L:/127.0.0.1:53974 - R:localhost/127.0.0.1:39527]
2024-02-05T18:23:22,176 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:23:22,178 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:23:22,180 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:44851 plays a follower now.
2024-02-05T18:23:22,210 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:44851/__change_events
2024-02-05T18:23:22,245 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:44851/0x00000000_0xffffffff - localhost:44851.
2024-02-05T18:23:22,246 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:44851/0x00000000_0xffffffff
2024-02-05T18:23:22,247 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:44851
2024-02-05T18:23:22,247 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:44851/0x00000000_0xffffffff - localhost:44851.
2024-02-05T18:23:22,249 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:44851/0x00000000_0xffffffff
2024-02-05T18:23:22,251 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:44851
2024-02-05T18:23:22,253 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:44851 doesn't exist.
2024-02-05T18:23:22,254 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:44851/__change_events][reader-a9eb1e747e] Subscribing to topic on cnx [id: 0x2d22444b, L:/127.0.0.1:36700 - R:localhost/127.0.0.1:46431], consumerId 2
2024-02-05T18:23:22,256 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x37af1523, L:/127.0.0.1:46431 - R:/127.0.0.1:36700]] Subscribing on topic persistent://sla-monitor/test/localhost:44851/__change_events / reader-a9eb1e747e. consumerId: 2
2024-02-05T18:23:22,255 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=2, bootstrap service port = 44851, tls-port = Optional[39357], broker url= pulsar://localhost:46431, broker tls url= pulsar+ssl://localhost:36185, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[46431], brokerServicePortTls=Optional[36185], webServicePort=Optional[44851], webServicePortTls=Optional[39357], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:23:22,267 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:44851/persistent/__change_events
2024-02-05T18:23:22,270 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:44851/persistent/__change_events'
2024-02-05T18:23:22,280 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:23:22,281 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:44851/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:23:22,290 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:44851/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:23:22,296 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:44851/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:23:22,301 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:44851/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:44851/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:23:22,303 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:44851/__change_events - dedup is disabled
2024-02-05T18:23:22,310 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:23:22,317 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:44851/__change_events][reader-a9eb1e747e] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:23:22,317 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:44851/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:23:22,318 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:44851/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:44851/persistent/__change_events, cursor=reader-a9eb1e747e, ackPos=9:-1, readPos=9:0}
2024-02-05T18:23:22,320 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:36700] Created subscription on topic persistent://sla-monitor/test/localhost:44851/__change_events / reader-a9eb1e747e
2024-02-05T18:23:22,322 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:44851/__change_events][reader-a9eb1e747e] Subscribed to topic on localhost/127.0.0.1:46431 -- consumer: 2
2024-02-05T18:23:22,474 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:23:22,475 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:23:22 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:23:22,508 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:23:22,510 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:23:22 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T18:23:22,533 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:23:22,533 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:23:22,539 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:23:22,540 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:23:22 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:23:22,564 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:23:22,564 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:23:22,565 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:23:22,566 - INFO  - [pulsar-62-2:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:23:22,566 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:23:22 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 20
2024-02-05T18:23:22,569 - INFO  - [pulsar-7-2:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:23:22,578 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:23:22,579 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:23:22,584 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:23:22,585 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:23:22 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:23:22,599 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:23:22,599 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:23:22,599 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:23:22,600 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:23:22,605 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:23:22 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 16
2024-02-05T18:23:22,608 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:23:22,647 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:23:22,660 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:23:22,661 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:23:22,675 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:23:22,681 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:23:22,681 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:23:22,687 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:23:22,706 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:45337 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:23:22,755 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45337 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:45337, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150202708, versionId=1]. totalHandledRequests:1
2024-02-05T18:23:22,783 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45337 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:45337, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150202772, versionId=2]. totalHandledRequests:1
2024-02-05T18:23:22,786 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:23:22,811 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:23:22,813 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:23:22,821 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:23:22,846 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45337 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:45337, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150202798, versionId=3]. totalHandledRequests:1
2024-02-05T18:23:22,854 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 7.0 ms
2024-02-05T18:23:22,859 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:23:22,869 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45337 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:45337, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150202847, versionId=4]. totalHandledRequests:1
2024-02-05T18:23:22,872 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:23:22,872 - INFO  - [broker-client-shared-internal-executor-11-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:23:22,872 - WARN  - [ForkJoinPool.commonPool-worker-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:45337. Skipping this broker. Phase one
2024-02-05T18:23:22,873 - WARN  - [ForkJoinPool.commonPool-worker-1:LeastResourceUsageWithWeight@126] - There is no broker load data for broker:localhost:45337. Skipping this broker. Phase two
2024-02-05T18:23:22,873 - INFO  - [ForkJoinPool.commonPool-worker-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:45337 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:23:22,873 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:23:22 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 202
2024-02-05T18:23:22,875 - INFO  - [AsyncHttpClient-37-1:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:23:22,877 - INFO  - [AsyncHttpClient-37-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:23:22 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 235
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:23:22,889 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45337 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:45337, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150202873, versionId=5]. totalHandledRequests:2
2024-02-05T18:23:22,901 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45337 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:45337, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150202890, versionId=6]. totalHandledRequests:2
2024-02-05T18:23:22,903 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:23:22,905 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-fb1539332c] Subscribing to topic on cnx [id: 0xa1d4cc35, L:/127.0.0.1:35932 - R:localhost/127.0.0.1:39527], consumerId 4
2024-02-05T18:23:22,907 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x2f925c8e, L:/127.0.0.1:39527 - R:/127.0.0.1:35932]] Subscribing on topic persistent://public/test/__change_events / reader-fb1539332c. consumerId: 4
2024-02-05T18:23:22,963 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:23:22,964 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:23:22,972 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:23:22,973 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:23:22,980 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:23:22,982 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:23:22,982 - INFO  - [broker-client-shared-internal-executor-11-1:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-1fb62f89a6] Subscribing to topic on cnx [id: 0xa1d4cc35, L:/127.0.0.1:35932 - R:localhost/127.0.0.1:39527], consumerId 5
2024-02-05T18:23:22,984 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x2f925c8e, L:/127.0.0.1:39527 - R:/127.0.0.1:35932]] Subscribing on topic persistent://public/test/__change_events / reader-1fb62f89a6. consumerId: 5
2024-02-05T18:23:22,986 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bd656a7], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@dd62935] 
2024-02-05T18:23:22,989 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bd656a7, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@44412aab], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@dd62935, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7489ea3d] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bd656a7, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@44412aab, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@d13f965], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@dd62935, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7489ea3d, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3130e673] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bd656a7, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@44412aab, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@d13f965, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7ce9968c], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@dd62935, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7489ea3d, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3130e673, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@478a432e] 
2024-02-05T18:23:22,992 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bd656a7, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@44412aab, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@d13f965, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7ce9968c, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55c0526b], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@dd62935, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7489ea3d, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3130e673, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@478a432e, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@63f525de] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bd656a7, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@44412aab, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@d13f965, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7ce9968c, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55c0526b, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@539882da], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@dd62935, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7489ea3d, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3130e673, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@478a432e, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@63f525de, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@469e28b4] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bd656a7, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@44412aab, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@d13f965, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7ce9968c, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55c0526b, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@539882da, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@119a6906], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@dd62935, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7489ea3d, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3130e673, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@478a432e, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@63f525de, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@469e28b4, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5b8b753e] 
2024-02-05T18:23:23,000 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:23:23,003 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:23:23,006 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-fb1539332c] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:23:23,006 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:23:23,007 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-fb1539332c, ackPos=11:-1, readPos=11:0}
2024-02-05T18:23:23,010 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:35932] Created subscription on topic persistent://public/test/__change_events / reader-fb1539332c
2024-02-05T18:23:23,014 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-fb1539332c] Subscribed to topic on localhost/127.0.0.1:39527 -- consumer: 4
2024-02-05T18:23:23,020 - INFO  - [pulsar-io-9-1:ServerCnx@2007] - [/127.0.0.1:35932] Closing consumer: consumerId=4
2024-02-05T18:23:23,021 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-fb1539332c}, consumerId=4, consumerName=ae710, address=/127.0.0.1:35932}
2024-02-05T18:23:23,022 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-fb1539332c] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-fb1539332c, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:23:23,023 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-fb1539332c] Successfully closed dispatcher for reader
2024-02-05T18:23:23,026 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:23:23,031 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-1fb62f89a6] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:23:23,032 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:23:23,032 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-1fb62f89a6, ackPos=11:-1, readPos=11:0}
2024-02-05T18:23:23,034 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:35932] Created subscription on topic persistent://public/test/__change_events / reader-1fb62f89a6
2024-02-05T18:23:23,035 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@352df548{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:23:23,036 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@4dbcc8ce{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:23:23,036 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:23:23,039 - INFO  - [pulsar-io-9-1:ServerCnx@2043] - [/127.0.0.1:35932] Closed consumer, consumerId=4
2024-02-05T18:23:23,040 - INFO  - [pulsar-io-9-4:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-fb1539332c] Closed consumer
2024-02-05T18:23:23,041 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-1fb62f89a6] Subscribed to topic on localhost/127.0.0.1:39527 -- consumer: 5
2024-02-05T18:23:23,041 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:23:23,043 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@45ec9b22{/static,null,STOPPED}
2024-02-05T18:23:23,045 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/metrics,null,STOPPED}
2024-02-05T18:23:23,045 - INFO  - [pulsar-io-9-1:ServerCnx@2007] - [/127.0.0.1:35932] Closing consumer: consumerId=5
2024-02-05T18:23:23,045 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-1fb62f89a6}, consumerId=5, consumerName=ad602, address=/127.0.0.1:35932}
2024-02-05T18:23:23,047 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-1fb62f89a6] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-1fb62f89a6, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:23:23,048 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-1fb62f89a6] Successfully closed dispatcher for reader
2024-02-05T18:23:23,050 - INFO  - [pulsar-io-9-1:ServerCnx@2043] - [/127.0.0.1:35932] Closed consumer, consumerId=5
2024-02-05T18:23:23,051 - INFO  - [pulsar-io-9-4:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-1fb62f89a6] Closed consumer
2024-02-05T18:23:23,052 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/topics,null,STOPPED}
2024-02-05T18:23:23,052 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:23:23,054 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/lookup,null,STOPPED}
2024-02-05T18:23:23,057 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@633e4742{/admin/v3,null,STOPPED}
2024-02-05T18:23:23,064 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/admin/v2,null,STOPPED}
2024-02-05T18:23:23,066 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin,null,STOPPED}
2024-02-05T18:23:23,070 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/,null,STOPPED}
2024-02-05T18:23:23,074 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:23:23,078 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:23:23,078 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:23:23,080 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:44851
2024-02-05T18:23:23,084 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:44851 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:23:23,092 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:44851 was invalidated. state Releasing
2024-02-05T18:23:23,094 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:44851. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:23:23,098 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:44851 registry has been deleted.
2024-02-05T18:23:23,098 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:44851 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:23:23,101 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:44851 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:23:23,102 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:44851
2024-02-05T18:23:23,103 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:44851 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:23:23,105 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:44851
2024-02-05T18:23:23,121 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:44851/0x00000000_0xffffffff.
2024-02-05T18:23:23,124 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:44851/0x00000000_0xffffffff.
2024-02-05T18:23:23,127 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:44851/0x00000000_0xffffffff.
2024-02-05T18:23:23,128 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.022 seconds
2024-02-05T18:23:23,130 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:23:23,135 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x1210fa91, L:/127.0.0.1:53974 ! R:localhost/127.0.0.1:39527] Disconnected
2024-02-05T18:23:23,139 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:53974
2024-02-05T18:23:23,142 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-e03e2c7983}, consumerId=0, consumerName=1ea18, address=/127.0.0.1:53974}
2024-02-05T18:23:23,142 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-e03e2c7983] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-e03e2c7983, ackPos=3:5, readPos=3:6}]
2024-02-05T18:23:23,142 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-e03e2c7983] Successfully closed dispatcher for reader
2024-02-05T18:23:23,144 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x1210fa91, L:/127.0.0.1:53974 ! R:localhost/127.0.0.1:39527] -- Will try again in 0.1 s
2024-02-05T18:23:23,147 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x1210fa91, L:/127.0.0.1:53974 ! R:localhost/127.0.0.1:39527] -- Will try again in 0.1 s
2024-02-05T18:23:23,147 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x1210fa91, L:/127.0.0.1:53974 ! R:localhost/127.0.0.1:39527] -- Will try again in 0.1 s
2024-02-05T18:23:23,146 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-b0635726c4}, consumerId=1, consumerName=6ec95, address=/127.0.0.1:53974}
2024-02-05T18:23:23,149 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-e03e2c7983] Closed connection [id: 0x1210fa91, L:/127.0.0.1:53974 ! R:localhost/127.0.0.1:39527] -- Will try again in 0.1 s
2024-02-05T18:23:23,149 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-b0635726c4] Closed connection [id: 0x1210fa91, L:/127.0.0.1:53974 ! R:localhost/127.0.0.1:39527] -- Will try again in 0.1 s
2024-02-05T18:23:23,153 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x2d22444b, L:/127.0.0.1:36700 ! R:localhost/127.0.0.1:46431] Disconnected
2024-02-05T18:23:23,153 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:44851/__change_events] [reader-a9eb1e747e] Closed connection [id: 0x2d22444b, L:/127.0.0.1:36700 ! R:localhost/127.0.0.1:46431] -- Will try again in 0.1 s
2024-02-05T18:23:23,154 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:36700
2024-02-05T18:23:23,154 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:44851/__change_events, name=reader-a9eb1e747e}, consumerId=2, consumerName=c8791, address=/127.0.0.1:36700}
2024-02-05T18:23:23,155 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:44851/__change_events][reader-a9eb1e747e] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:44851/persistent/__change_events, cursor=reader-a9eb1e747e, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:23:23,155 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:44851/__change_events][reader-a9eb1e747e] Successfully closed dispatcher for reader
2024-02-05T18:23:23,166 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:23:23,167 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:44851/persistent/__change_events] Closing managed ledger
2024-02-05T18:23:23,173 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:44851/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:23:23,174 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:23:23,176 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:23:23,177 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:23:23,184 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:46431
2024-02-05T18:23:23,185 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:23:23,187 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:23:23,188 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:23:23,189 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-b0635726c4] Closed Consumer (not connected)
2024-02-05T18:23:23,190 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-b0635726c4 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-b0635726c4 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:23:23,192 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:44851/__change_events] [reader-a9eb1e747e] Closed Consumer (not connected)
2024-02-05T18:23:23,193 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:44851/__change_events with subscription name reader-a9eb1e747e was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:44851/__change_events with subscription name reader-a9eb1e747e was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:23:23,194 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-e03e2c7983] Closed Consumer (not connected)
2024-02-05T18:23:23,195 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-e03e2c7983 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-e03e2c7983 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:23:23,202 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:23:23,202 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:23:23,206 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:23:23,207 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:23:23,216 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:23:23,216 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:23:23,566 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:23:23,567 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 47.07%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 47.07%, msgThroughputEMA= 0.00, updatedAt= 1707150203566, reportedAt= 0
2024-02-05T18:23:23,684 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:23:23,684 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:23:24,468 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:23:24,469 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:23:24,471 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:23:24,471 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:23:24,472 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:23:24,472 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:23:24,685 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:23:24,686 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:23:25,686 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:23:25,687 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:23:26,486 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:23:26,487 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:23:26,488 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:23:26,488 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:23:26,489 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@1978b0d5{/static,null,STOPPED}
2024-02-05T18:23:26,489 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,STOPPED}
2024-02-05T18:23:26,491 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/topics,null,STOPPED}
2024-02-05T18:23:26,493 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,STOPPED}
2024-02-05T18:23:26,495 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,STOPPED}
2024-02-05T18:23:26,497 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,STOPPED}
2024-02-05T18:23:26,499 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin,null,STOPPED}
2024-02-05T18:23:26,501 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/,null,STOPPED}
2024-02-05T18:23:26,501 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:23:26,502 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:23:26,503 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:23:26,504 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:45337
2024-02-05T18:23:26,506 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:45337, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150202890, versionId=6]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:23:31,517 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:45337 in 5011.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:23:31,524 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:45337 was invalidated. state Releasing
2024-02-05T18:23:31,524 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:45337. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:23:31,524 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:45337
2024-02-05T18:23:31,529 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:45337/0x00000000_0xffffffff.
2024-02-05T18:23:31,536 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45337 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:45337, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150211530, versionId=7]. totalHandledRequests:10
2024-02-05T18:23:31,537 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:23:31,539 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:23:31,539 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:23:31,541 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:23:31,544 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:23:31,548 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:23:31,548 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 12.0 ms
2024-02-05T18:23:31,556 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45337 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:45337, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150211536, versionId=8]. totalHandledRequests:4
2024-02-05T18:23:31,556 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:23:31,558 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:45337/0x00000000_0xffffffff.
2024-02-05T18:23:31,559 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:45337/0x00000000_0xffffffff.
2024-02-05T18:23:31,559 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.034 seconds
2024-02-05T18:23:31,559 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:23:31,560 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:35932
2024-02-05T18:23:31,560 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0xa1d4cc35, L:/127.0.0.1:35932 ! R:localhost/127.0.0.1:39527] Disconnected
2024-02-05T18:23:31,560 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0xa1d4cc35, L:/127.0.0.1:35932 ! R:localhost/127.0.0.1:39527] -- Will try again in 0.1 s
2024-02-05T18:23:31,560 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-8d679dde6a}, consumerId=0, consumerName=ddeef, address=/127.0.0.1:35932}
2024-02-05T18:23:31,561 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0xa1d4cc35, L:/127.0.0.1:35932 ! R:localhost/127.0.0.1:39527] -- Will try again in 0.1 s
2024-02-05T18:23:31,561 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-8d679dde6a] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-8d679dde6a, ackPos=3:5, readPos=3:8}]
2024-02-05T18:23:31,561 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0xa1d4cc35, L:/127.0.0.1:35932 ! R:localhost/127.0.0.1:39527] -- Will try again in 0.1 s
2024-02-05T18:23:31,561 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-8d679dde6a] Successfully closed dispatcher for reader
2024-02-05T18:23:31,561 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-8d679dde6a] Closed connection [id: 0xa1d4cc35, L:/127.0.0.1:35932 ! R:localhost/127.0.0.1:39527] -- Will try again in 0.1 s
2024-02-05T18:23:31,562 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-6f9200e8f8] Closed connection [id: 0xa1d4cc35, L:/127.0.0.1:35932 ! R:localhost/127.0.0.1:39527] -- Will try again in 0.1 s
2024-02-05T18:23:31,562 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:45337/__change_events, name=reader-4d808a001f}, consumerId=3, consumerName=79417, address=/127.0.0.1:35932}
2024-02-05T18:23:31,562 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:45337/__change_events] [reader-4d808a001f] Closed connection [id: 0xa1d4cc35, L:/127.0.0.1:35932 ! R:localhost/127.0.0.1:39527] -- Will try again in 0.1 s
2024-02-05T18:23:31,562 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-19b6384eb8] Closed connection [id: 0xa1d4cc35, L:/127.0.0.1:35932 ! R:localhost/127.0.0.1:39527] -- Will try again in 0.1 s
2024-02-05T18:23:31,562 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:45337/__change_events][reader-4d808a001f] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:45337/persistent/__change_events, cursor=reader-4d808a001f, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:23:31,562 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:45337/__change_events][reader-4d808a001f] Successfully closed dispatcher for reader
2024-02-05T18:23:31,563 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-19b6384eb8}, consumerId=2, consumerName=b56ab, address=/127.0.0.1:35932}
2024-02-05T18:23:31,563 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-6f9200e8f8}, consumerId=1, consumerName=0e2ba, address=/127.0.0.1:35932}
2024-02-05T18:23:31,565 - WARN  - [pulsar-io-9-1:ServerCnx@407] - [/127.0.0.1:35932] Got exception java.util.concurrent.RejectedExecutionException: event executor terminated
	at io.netty.util.concurrent.SingleThreadEventExecutor.reject(SingleThreadEventExecutor.java:934)
	at io.netty.util.concurrent.SingleThreadEventExecutor.offerTask(SingleThreadEventExecutor.java:351)
	at io.netty.util.concurrent.SingleThreadEventExecutor.addTask(SingleThreadEventExecutor.java:344)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:836)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute0(SingleThreadEventExecutor.java:827)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:817)
	at io.netty.util.concurrent.AbstractEventExecutorGroup.execute(AbstractEventExecutorGroup.java:115)
	at java.base/java.util.concurrent.CompletableFuture.asyncRunStage(CompletableFuture.java:1818)
	at java.base/java.util.concurrent.CompletableFuture.runAsync(CompletableFuture.java:2033)
	at org.apache.pulsar.broker.service.nonpersistent.NonPersistentTopic.unsubscribe(NonPersistentTopic.java:1151)
	at org.apache.pulsar.broker.service.nonpersistent.NonPersistentSubscription.removeConsumer(NonPersistentSubscription.java:189)
	at org.apache.pulsar.broker.service.Consumer.close(Consumer.java:400)
	at org.apache.pulsar.broker.service.Consumer.close(Consumer.java:396)
	at org.apache.pulsar.broker.service.ServerCnx.lambda$channelInactive$1(ServerCnx.java:378)
	at org.apache.pulsar.common.util.collections.ConcurrentLongHashMap$Section.forEach(ConcurrentLongHashMap.java:562)
	at org.apache.pulsar.common.util.collections.ConcurrentLongHashMap.forEach(ConcurrentLongHashMap.java:242)
	at org.apache.pulsar.broker.service.ServerCnx.channelInactive(ServerCnx.java:369)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.handler.flow.FlowControlHandler.channelInactive(FlowControlHandler.java:134)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.handler.codec.ByteToMessageDecoder.channelInputClosed(ByteToMessageDecoder.java:411)
	at io.netty.handler.codec.ByteToMessageDecoder.channelInactive(ByteToMessageDecoder.java:376)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasksFrom(SingleThreadEventExecutor.java:426)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:375)
	at io.netty.util.concurrent.SingleThreadEventExecutor.confirmShutdown(SingleThreadEventExecutor.java:763)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:431)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:840)

2024-02-05T18:23:31,566 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:23:31,567 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:23:31,567 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:45337/persistent/__change_events] Closing managed ledger
2024-02-05T18:23:31,569 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:23:31,574 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:45337/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:23:31,574 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:23:31,574 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:23:31,575 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:23:31,579 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:39527
2024-02-05T18:23:31,579 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:23:31,579 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:23:31,580 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:23:31,580 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:45337/__change_events] [reader-4d808a001f] Closed Consumer (not connected)
2024-02-05T18:23:31,580 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-8d679dde6a] Closed Consumer (not connected)
2024-02-05T18:23:31,580 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-6f9200e8f8] Closed Consumer (not connected)
2024-02-05T18:23:31,580 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-19b6384eb8] Closed Consumer (not connected)
2024-02-05T18:23:31,580 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:45337/__change_events with subscription name reader-4d808a001f was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:45337/__change_events with subscription name reader-4d808a001f was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:23:31,581 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-8d679dde6a was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-8d679dde6a was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:23:31,581 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-6f9200e8f8 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-6f9200e8f8 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:23:31,582 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-19b6384eb8 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-19b6384eb8 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:23:31,585 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:23:31,585 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:23:31,585 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:23:31,585 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:23:31,586 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:23:31,586 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:23:31,588 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:23:31,588 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:23:32,870 - INFO  - [globalEventExecutor-10-7:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:23:32,870 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:23:32,872 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:23:32,872 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:23:32,872 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:23:32,872 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:23:32,881 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:23:32,881 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:23:32,885 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:23:32,885 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:23:32,886 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:23:32,886 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-2,5,main]'
2024-02-05T18:23:32,886 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:23:32,886 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:23:32,886 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:23:32,886 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:23:32,886 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:23:32,886 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:23:32,886 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 190 with name 'Thread[globalEventExecutor-10-7,5,main]'
2024-02-05T18:23:32,886 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:23:32,886 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:23:32,887 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@339e62bb
2024-02-05T18:23:32,887 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:23:32,887 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:23:32,887 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 27.484 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  53.816 s
[INFO] Finished at: 2024-02-05T18:23:33+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 7 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:24:03,768 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:24:04,699 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:24:04,701 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:24:05,156 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:24:05,157 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:24:05,158 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:24:05,164 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:24:05,165 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:24:05,166 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:24:05,199 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:24:05,201 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:24:05,202 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:24:05,202 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:24:05,202 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:24:05,203 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:24:05,203 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:24:05,204 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:24:05,204 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:24:05,204 - INFO  - [main:Environment@98] - Client environment:os.memory.free=24MB
2024-02-05T18:24:05,205 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:24:05,205 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:24:06,797 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:24:06,797 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:24:06,798 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:24:06,798 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:24:07,138 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:24:07,139 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:24:07,234 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:24:07,315 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:24:07,319 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:24:07,337 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:24:07,443 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:24:07,495 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:24:07,533 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:24:07,869 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:24:07,870 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:24:07,904 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:24:07,974 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:36439, TLS: (none), listener: (none)
2024-02-05T18:24:08,237 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:45111, TLS: OPENSSL, listener: (none)
2024-02-05T18:24:08,260 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:24:08,265 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:24:08,266 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:24:08,302 - INFO  - [main:Log@170] - Logging initialized @6759ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:24:09,054 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:24:09,083 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:24:09,084 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:24:09,086 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:24:09,940 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1978b0d5{/,null,AVAILABLE}
2024-02-05T18:24:11,117 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/admin,null,AVAILABLE}
2024-02-05T18:24:12,319 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,AVAILABLE}
2024-02-05T18:24:12,733 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,AVAILABLE}
2024-02-05T18:24:12,867 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,AVAILABLE}
2024-02-05T18:24:12,999 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/topics,null,AVAILABLE}
2024-02-05T18:24:13,001 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,AVAILABLE}
2024-02-05T18:24:13,006 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6556471b{/static,null,AVAILABLE}
2024-02-05T18:24:13,034 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:44813}
2024-02-05T18:24:13,171 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:35267}
2024-02-05T18:24:13,172 - INFO  - [main:Server@415] - Started @11631ms
2024-02-05T18:24:13,172 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:44813
2024-02-05T18:24:13,173 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:35267
2024-02-05T18:24:13,181 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:24:13,182 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:24:13,381 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:44813
2024-02-05T18:24:13,401 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:24:13,404 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:44813 is changing the role from null to Leader
2024-02-05T18:24:13,408 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:44813).
2024-02-05T18:24:13,673 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:44813 
2024-02-05T18:24:14,168 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:24:14,189 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:24:14,285 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:24:14,290 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:24:14,298 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:24:14,300 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:24:14,335 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:24:14,364 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:24:14,391 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:24:14,451 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:24:14,471 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:24:14,481 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:24:14,484 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:24:14,512 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:24:14,524 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:14 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 522
2024-02-05T18:24:14,687 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0xbd22137f, L:/127.0.0.1:46064 - R:localhost/127.0.0.1:36439]] Connected to server
2024-02-05T18:24:14,720 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:46064] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:24:14,785 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:24:14,794 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xbd22137f, L:/127.0.0.1:46064 - R:localhost/127.0.0.1:36439]
2024-02-05T18:24:14,844 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:24:14,873 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:46064] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:46064, producerName=test-0-0, producerId=0}
2024-02-05T18:24:14,881 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0xbd22137f, L:/127.0.0.1:46064 - R:localhost/127.0.0.1:36439]
2024-02-05T18:24:14,884 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:24:14,925 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:24:14,927 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-5037d6007a] Subscribing to topic on cnx [id: 0xbd22137f, L:/127.0.0.1:46064 - R:localhost/127.0.0.1:36439], consumerId 0
2024-02-05T18:24:14,937 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x90ddad09, L:/127.0.0.1:36439 - R:/127.0.0.1:46064]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-5037d6007a. consumerId: 0
2024-02-05T18:24:14,972 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-5037d6007a] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:24:14,973 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:24:14,974 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-5037d6007a, ackPos=3:-1, readPos=3:0}
2024-02-05T18:24:14,997 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46064] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-5037d6007a
2024-02-05T18:24:15,003 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-5037d6007a] Subscribed to topic on localhost/127.0.0.1:36439 -- consumer: 0
2024-02-05T18:24:15,018 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.012 seconds
2024-02-05T18:24:15,019 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:24:15,020 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:24:15,021 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:24:15,058 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:24:15,082 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:24:15,084 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:24:15,086 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:24:15,088 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:15 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 52
2024-02-05T18:24:15,101 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:24:15,112 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:24:15,113 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:24:15,114 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:15 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:24:15,115 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:24:15,138 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:24:15,140 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xbd22137f, L:/127.0.0.1:46064 - R:localhost/127.0.0.1:36439]
2024-02-05T18:24:15,152 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:24:15,158 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:46064] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:46064, producerName=test-0-1, producerId=1}
2024-02-05T18:24:15,160 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0xbd22137f, L:/127.0.0.1:46064 - R:localhost/127.0.0.1:36439]
2024-02-05T18:24:15,175 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:24:15,177 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-73c9275c29] Subscribing to topic on cnx [id: 0xbd22137f, L:/127.0.0.1:46064 - R:localhost/127.0.0.1:36439], consumerId 1
2024-02-05T18:24:15,180 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x90ddad09, L:/127.0.0.1:36439 - R:/127.0.0.1:46064]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-73c9275c29. consumerId: 1
2024-02-05T18:24:15,209 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-73c9275c29] Created new subscription for 1
2024-02-05T18:24:15,210 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46064] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-73c9275c29
2024-02-05T18:24:15,211 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-73c9275c29] Subscribed to topic on localhost/127.0.0.1:36439 -- consumer: 1
2024-02-05T18:24:15,231 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:24:15,233 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xbd22137f, L:/127.0.0.1:46064 - R:localhost/127.0.0.1:36439]
2024-02-05T18:24:15,241 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:24:15,248 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:46064] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:46064, producerName=test-0-2, producerId=2}
2024-02-05T18:24:15,250 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0xbd22137f, L:/127.0.0.1:46064 - R:localhost/127.0.0.1:36439]
2024-02-05T18:24:15,267 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:24:15,297 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:24:15,306 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:44813 started the ownership monitor.
2024-02-05T18:24:15,326 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:24:15,328 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-01e42d6906] Subscribing to topic on cnx [id: 0xbd22137f, L:/127.0.0.1:46064 - R:localhost/127.0.0.1:36439], consumerId 2
2024-02-05T18:24:15,330 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x90ddad09, L:/127.0.0.1:36439 - R:/127.0.0.1:46064]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-01e42d6906. consumerId: 2
2024-02-05T18:24:15,340 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:44813/__change_events
2024-02-05T18:24:15,344 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-01e42d6906] Created new subscription for 2
2024-02-05T18:24:15,345 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46064] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-01e42d6906
2024-02-05T18:24:15,346 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-01e42d6906] Subscribed to topic on localhost/127.0.0.1:36439 -- consumer: 2
2024-02-05T18:24:15,347 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:44813 plays the leader now.
2024-02-05T18:24:15,352 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 54.88%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 54.88%, msgThroughputEMA= 0.00, updatedAt= 1707150255351, reportedAt= 0
2024-02-05T18:24:15,391 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:24:15,397 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:24:15,398 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:24:15,448 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:44813/0x00000000_0xffffffff - localhost:44813.
2024-02-05T18:24:15,450 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:44813
2024-02-05T18:24:15,450 - INFO  - [pulsar-7-4:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:44813/0x00000000_0xffffffff
2024-02-05T18:24:15,451 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:44813/0x00000000_0xffffffff - localhost:44813.
2024-02-05T18:24:15,452 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:44813
2024-02-05T18:24:15,452 - INFO  - [pulsar-7-3:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:44813/0x00000000_0xffffffff
2024-02-05T18:24:15,454 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:44813/__change_events][reader-0d47b1a873] Subscribing to topic on cnx [id: 0xbd22137f, L:/127.0.0.1:46064 - R:localhost/127.0.0.1:36439], consumerId 3
2024-02-05T18:24:15,456 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x90ddad09, L:/127.0.0.1:36439 - R:/127.0.0.1:46064]] Subscribing on topic persistent://sla-monitor/test/localhost:44813/__change_events / reader-0d47b1a873. consumerId: 3
2024-02-05T18:24:15,465 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:44813 doesn't exist.
2024-02-05T18:24:15,467 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:44813/persistent/__change_events
2024-02-05T18:24:15,470 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:44813/persistent/__change_events'
2024-02-05T18:24:15,478 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:24:15,479 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:44813/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:24:15,485 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:44813/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:24:15,491 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:44813/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:24:15,496 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:44813/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:44813/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:24:15,498 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:44813/__change_events - dedup is disabled
2024-02-05T18:24:15,509 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:24:15,517 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:44813/__change_events][reader-0d47b1a873] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:24:15,517 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:44813/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:24:15,518 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:44813/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:44813/persistent/__change_events, cursor=reader-0d47b1a873, ackPos=7:-1, readPos=7:0}
2024-02-05T18:24:15,520 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:46064] Created subscription on topic persistent://sla-monitor/test/localhost:44813/__change_events / reader-0d47b1a873
2024-02-05T18:24:15,521 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:44813/__change_events][reader-0d47b1a873] Subscribed to topic on localhost/127.0.0.1:36439 -- consumer: 3
2024-02-05T18:24:15,481 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 44813, tls-port = Optional[35267], broker url= pulsar://localhost:36439, broker tls url= pulsar+ssl://localhost:45111, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[36439], brokerServicePortTls=Optional[45111], webServicePort=Optional[44813], webServicePortTls=Optional[35267], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:24:15,980 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:24:15,980 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:24:15,980 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:24:15,981 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:24:15,985 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:24:15,985 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:24:15,990 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:24:15,995 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:24:16,001 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:24:16,001 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:24:16,007 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:24:16,013 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:24:16,015 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:24:16,024 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:24:16,024 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:24:16,029 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:24:16,034 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:40343, TLS: (none), listener: (none)
2024-02-05T18:24:16,036 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44297, TLS: OPENSSL, listener: (none)
2024-02-05T18:24:16,042 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:24:16,043 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:24:16,044 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:24:16,057 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:24:16,060 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:24:16,060 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:24:16,061 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:24:16,172 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/,null,AVAILABLE}
2024-02-05T18:24:16,399 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:24:16,399 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:24:16,840 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/admin,null,AVAILABLE}
2024-02-05T18:24:17,400 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:24:17,401 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:24:17,992 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,AVAILABLE}
2024-02-05T18:24:18,224 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,AVAILABLE}
2024-02-05T18:24:18,296 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,AVAILABLE}
2024-02-05T18:24:18,386 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/topics,null,AVAILABLE}
2024-02-05T18:24:18,387 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,AVAILABLE}
2024-02-05T18:24:18,388 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@554f6e30{/static,null,AVAILABLE}
2024-02-05T18:24:18,390 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:38121}
2024-02-05T18:24:18,402 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:24:18,403 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:24:18,407 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:41223}
2024-02-05T18:24:18,408 - INFO  - [main:Server@415] - Started @16867ms
2024-02-05T18:24:18,412 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:38121
2024-02-05T18:24:18,415 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:41223
2024-02-05T18:24:18,422 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:24:18,422 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:24:18,444 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:38121
2024-02-05T18:24:18,444 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:38121 registry has been created.
2024-02-05T18:24:18,445 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:38121. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:24:18,448 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:38121 is changing the role from null to Follower
2024-02-05T18:24:18,453 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:44813).
2024-02-05T18:24:18,459 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:24:18,474 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:38121 
2024-02-05T18:24:18,604 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:18 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 62
2024-02-05T18:24:18,626 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:24:18,629 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:24:18,631 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:24:18,648 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:38121/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:24:18,653 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:18 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 43
2024-02-05T18:24:18,659 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x0934a180, L:/127.0.0.1:36672 - R:localhost/127.0.0.1:40343]] Connected to server
2024-02-05T18:24:18,665 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:36672] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:24:18,683 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x3363228a, L:/127.0.0.1:46070 - R:localhost/127.0.0.1:36439]] Connected to server
2024-02-05T18:24:18,687 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:46070] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:24:18,688 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x3363228a, L:/127.0.0.1:46070 - R:localhost/127.0.0.1:36439]
2024-02-05T18:24:18,701 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:46070] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:46070, producerName=test-0-3, producerId=0}
2024-02-05T18:24:18,703 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x3363228a, L:/127.0.0.1:46070 - R:localhost/127.0.0.1:36439]
2024-02-05T18:24:18,716 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-80e339bc2e] Subscribing to topic on cnx [id: 0x3363228a, L:/127.0.0.1:46070 - R:localhost/127.0.0.1:36439], consumerId 0
2024-02-05T18:24:18,718 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x8e14d237, L:/127.0.0.1:36439 - R:/127.0.0.1:46070]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-80e339bc2e. consumerId: 0
2024-02-05T18:24:18,723 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-80e339bc2e] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:24:18,724 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:24:18,724 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-80e339bc2e, ackPos=3:-1, readPos=3:0}
2024-02-05T18:24:18,726 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46070] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-80e339bc2e
2024-02-05T18:24:18,727 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-80e339bc2e] Subscribed to topic on localhost/127.0.0.1:36439 -- consumer: 0
2024-02-05T18:24:18,730 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:24:18,731 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:24:18,750 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:18 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:24:18,759 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:24:18,761 - ERROR - [pulsar-web-30-6:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:24:18,762 - ERROR - [pulsar-web-30-6:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:24:18,767 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:38121/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:24:18,768 - INFO  - [pulsar-web-30-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:18 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:24:18,785 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:18 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T18:24:18,786 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:24:18,790 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:24:18,790 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:24:18,794 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:18 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:24:18,795 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:38121/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:24:18,809 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x3363228a, L:/127.0.0.1:46070 - R:localhost/127.0.0.1:36439]
2024-02-05T18:24:18,817 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:46070] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:46070, producerName=test-0-4, producerId=1}
2024-02-05T18:24:18,818 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x3363228a, L:/127.0.0.1:46070 - R:localhost/127.0.0.1:36439]
2024-02-05T18:24:18,832 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-184e1fb0a7] Subscribing to topic on cnx [id: 0x3363228a, L:/127.0.0.1:46070 - R:localhost/127.0.0.1:36439], consumerId 1
2024-02-05T18:24:18,833 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x8e14d237, L:/127.0.0.1:36439 - R:/127.0.0.1:46070]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-184e1fb0a7. consumerId: 1
2024-02-05T18:24:18,846 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-184e1fb0a7] Created new subscription for 1
2024-02-05T18:24:18,846 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46070] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-184e1fb0a7
2024-02-05T18:24:18,847 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-184e1fb0a7] Subscribed to topic on localhost/127.0.0.1:36439 -- consumer: 1
2024-02-05T18:24:18,867 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x3363228a, L:/127.0.0.1:46070 - R:localhost/127.0.0.1:36439]
2024-02-05T18:24:18,874 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:46070] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:46070, producerName=test-0-5, producerId=2}
2024-02-05T18:24:18,875 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x3363228a, L:/127.0.0.1:46070 - R:localhost/127.0.0.1:36439]
2024-02-05T18:24:18,876 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:24:18,879 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:24:18,880 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:38121 plays a follower now.
2024-02-05T18:24:18,910 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:38121/__change_events
2024-02-05T18:24:18,939 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:38121/0x00000000_0xffffffff - localhost:38121.
2024-02-05T18:24:18,941 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:38121/0x00000000_0xffffffff
2024-02-05T18:24:18,942 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:38121
2024-02-05T18:24:18,943 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:38121/0x00000000_0xffffffff - localhost:38121.
2024-02-05T18:24:18,944 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:38121/0x00000000_0xffffffff
2024-02-05T18:24:18,945 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:38121
2024-02-05T18:24:18,950 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:38121/__change_events][reader-990780d405] Subscribing to topic on cnx [id: 0x0934a180, L:/127.0.0.1:36672 - R:localhost/127.0.0.1:40343], consumerId 2
2024-02-05T18:24:18,953 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x7bf28a41, L:/127.0.0.1:40343 - R:/127.0.0.1:36672]] Subscribing on topic persistent://sla-monitor/test/localhost:38121/__change_events / reader-990780d405. consumerId: 2
2024-02-05T18:24:18,953 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:38121 doesn't exist.
2024-02-05T18:24:18,955 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=2, bootstrap service port = 38121, tls-port = Optional[41223], broker url= pulsar://localhost:40343, broker tls url= pulsar+ssl://localhost:44297, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[40343], brokerServicePortTls=Optional[44297], webServicePort=Optional[38121], webServicePortTls=Optional[41223], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:24:18,965 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:38121/persistent/__change_events
2024-02-05T18:24:18,967 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:38121/persistent/__change_events'
2024-02-05T18:24:18,978 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:24:18,980 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:38121/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:24:18,987 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:38121/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:24:18,991 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:38121/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:24:18,995 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:38121/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:38121/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:24:18,996 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:38121/__change_events - dedup is disabled
2024-02-05T18:24:19,003 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:24:19,013 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:38121/__change_events][reader-990780d405] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:24:19,014 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:38121/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:24:19,014 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:38121/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38121/persistent/__change_events, cursor=reader-990780d405, ackPos=9:-1, readPos=9:0}
2024-02-05T18:24:19,016 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:36672] Created subscription on topic persistent://sla-monitor/test/localhost:38121/__change_events / reader-990780d405
2024-02-05T18:24:19,017 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:38121/__change_events][reader-990780d405] Subscribed to topic on localhost/127.0.0.1:40343 -- consumer: 2
2024-02-05T18:24:19,146 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:24:19,148 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:19 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:24:19,176 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:24:19,177 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:19 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:24:19,202 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:24:19,203 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:24:19,207 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:24:19,208 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:19 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:24:19,237 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:24:19,238 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:24:19,238 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:24:19,239 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:19 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:24:19,239 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:24:19,242 - INFO  - [pulsar-7-2:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:24:19,251 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:24:19,252 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:24:19,257 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:24:19,258 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:19 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:24:19,267 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:24:19,267 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:24:19,267 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:24:19,269 - INFO  - [pulsar-62-3:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:24:19,270 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:19 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 8
2024-02-05T18:24:19,273 - INFO  - [pulsar-7-3:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:24:19,309 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:24:19,321 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:24:19,321 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:24:19,334 - INFO  - [pulsar-web-30-6:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:24:19,344 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:24:19,364 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:38121 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:24:19,403 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:24:19,404 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:24:19,423 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:24:19,405 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44813 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:38121, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150259366, versionId=1]. totalHandledRequests:1
2024-02-05T18:24:19,428 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44813 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:38121, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150259405, versionId=2]. totalHandledRequests:1
2024-02-05T18:24:19,431 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:24:19,445 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:19 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 112
2024-02-05T18:24:19,458 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:24:19,470 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-e8f22b83ac] Subscribing to topic on cnx [id: 0x0934a180, L:/127.0.0.1:36672 - R:localhost/127.0.0.1:40343], consumerId 3
2024-02-05T18:24:19,472 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x7bf28a41, L:/127.0.0.1:40343 - R:/127.0.0.1:36672]] Subscribing on topic persistent://public/test/__change_events / reader-e8f22b83ac. consumerId: 3
2024-02-05T18:24:19,488 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44813 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:38121, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150259479, versionId=3]. totalHandledRequests:1
2024-02-05T18:24:19,491 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:24:19,491 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:24:19,492 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:24:19,499 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:24:19,500 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:24:19,507 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:24:19,512 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:24:19,519 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:24:19,521 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:24:19,526 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:24:19,527 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:24:19,528 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:24:19,541 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:24:19,542 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:24:19,548 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:24:19,552 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 62.0 ms
2024-02-05T18:24:19,561 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44813 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:38121, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150259489, versionId=4]. totalHandledRequests:1
2024-02-05T18:24:19,562 - WARN  - [broker-client-shared-internal-executor-65-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:38121. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:24:19,563 - WARN  - [broker-client-shared-internal-executor-65-1:ServerCnx@1299] - [/127.0.0.1:36672][persistent://public/test/__change_events][reader-e8f22b83ac] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:38121. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:24:19,566 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:24:19,566 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x0934a180, L:/127.0.0.1:36672 - R:localhost/127.0.0.1:40343] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:38121. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:24:19,566 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:24:19,567 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:19 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 117
2024-02-05T18:24:19,568 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-e8f22b83ac] Failed to subscribe to topic on localhost/127.0.0.1:40343
2024-02-05T18:24:19,568 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-e8f22b83ac] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:38121. Please redo the lookup. Request is denied: namespace=public/test","reqId":2023518297859741757, "remote":"localhost/127.0.0.1:40343", "local":"/127.0.0.1:36672"}
2024-02-05T18:24:19,569 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-e8f22b83ac] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:38121. Please redo the lookup. Request is denied: namespace=public/test","reqId":2023518297859741757, "remote":"localhost/127.0.0.1:40343", "local":"/127.0.0.1:36672"} -- Will try again in 0.1 s
2024-02-05T18:24:19,570 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:24:19,572 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:24:19 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 266
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5f9a5068], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d24c65b] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5f9a5068, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1e97aac0], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d24c65b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7915bad8] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5f9a5068, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1e97aac0, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7481ac82], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d24c65b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7915bad8, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@fecaa57] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5f9a5068, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1e97aac0, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7481ac82, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2c0ec0c0], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d24c65b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7915bad8, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@fecaa57, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@78997ce3] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5f9a5068, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1e97aac0, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7481ac82, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2c0ec0c0, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1052ace], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d24c65b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7915bad8, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@fecaa57, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@78997ce3, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6bd186ab] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5f9a5068, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1e97aac0, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7481ac82, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2c0ec0c0, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1052ace, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@318343d1], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d24c65b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7915bad8, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@fecaa57, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@78997ce3, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6bd186ab, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@24e5f66] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5f9a5068, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1e97aac0, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7481ac82, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2c0ec0c0, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1052ace, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@318343d1, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a3546bb], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d24c65b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7915bad8, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@fecaa57, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@78997ce3, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6bd186ab, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@24e5f66, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4d366988] 
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:24:19,686 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:24:19,687 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-e8f22b83ac] Reconnecting after connection was closed
2024-02-05T18:24:19,689 - ERROR - [pulsar-io-64-2:ClientCnx@1196] - [id: 0x0934a180, L:/127.0.0.1:36672 - R:localhost/127.0.0.1:40343] Close connection because received internal-server error Failed due to pulsar service is not ready
2024-02-05T18:24:19,691 - WARN  - [pulsar-io-64-2:BinaryProtoLookupService@158] - [persistent://public/test/__change_events] failed to send lookup request : {"errorMsg":"Failed due to pulsar service is not ready","reqId":2023518297859741758, "remote":"localhost/127.0.0.1:40343", "local":"/127.0.0.1:36672"}
2024-02-05T18:24:19,691 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-e8f22b83ac] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":2023518297859741758, "remote":"localhost/127.0.0.1:40343", "local":"/127.0.0.1:36672"}
2024-02-05T18:24:19,691 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-e8f22b83ac] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":2023518297859741758, "remote":"localhost/127.0.0.1:40343", "local":"/127.0.0.1:36672"} -- Will try again in 0.189 s
2024-02-05T18:24:19,692 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x0934a180, L:/127.0.0.1:36672 ! R:localhost/127.0.0.1:40343] Disconnected
2024-02-05T18:24:19,694 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:38121/__change_events] [reader-990780d405] Closed connection [id: 0x0934a180, L:/127.0.0.1:36672 ! R:localhost/127.0.0.1:40343] -- Will try again in 0.1 s
2024-02-05T18:24:19,695 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:36672
2024-02-05T18:24:19,696 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:38121/__change_events, name=reader-990780d405}, consumerId=2, consumerName=04071, address=/127.0.0.1:36672}
2024-02-05T18:24:19,696 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:38121/__change_events][reader-990780d405] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38121/persistent/__change_events, cursor=reader-990780d405, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:24:19,697 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:38121/__change_events][reader-990780d405] Successfully closed dispatcher for reader
2024-02-05T18:24:19,699 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:24:19,700 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:24:19,701 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:24:19,709 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@554f6e30{/static,null,STOPPED}
2024-02-05T18:24:19,711 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,STOPPED}
2024-02-05T18:24:19,720 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/topics,null,STOPPED}
2024-02-05T18:24:19,724 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,STOPPED}
2024-02-05T18:24:19,727 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,STOPPED}
2024-02-05T18:24:19,730 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,STOPPED}
2024-02-05T18:24:19,733 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/admin,null,STOPPED}
2024-02-05T18:24:19,735 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/,null,STOPPED}
2024-02-05T18:24:19,739 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:24:19,742 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:24:19,742 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:24:19,746 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38121
2024-02-05T18:24:19,748 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38121 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:24:19,754 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:38121 was invalidated. state Releasing
2024-02-05T18:24:19,756 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:38121 registry has been deleted.
2024-02-05T18:24:19,756 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38121 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:24:19,757 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:38121. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:24:19,759 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:38121
2024-02-05T18:24:19,759 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38121 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:24:19,760 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38121
2024-02-05T18:24:19,762 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38121 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:24:19,770 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:38121/0x00000000_0xffffffff.
2024-02-05T18:24:19,772 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:38121/0x00000000_0xffffffff.
2024-02-05T18:24:19,774 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:38121/0x00000000_0xffffffff.
2024-02-05T18:24:19,774 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.014 seconds
2024-02-05T18:24:19,775 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:24:19,779 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x3363228a, L:/127.0.0.1:46070 ! R:localhost/127.0.0.1:36439] Disconnected
2024-02-05T18:24:19,779 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x3363228a, L:/127.0.0.1:46070 ! R:localhost/127.0.0.1:36439] -- Will try again in 0.1 s
2024-02-05T18:24:19,780 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:46070
2024-02-05T18:24:19,780 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x3363228a, L:/127.0.0.1:46070 ! R:localhost/127.0.0.1:36439] -- Will try again in 0.1 s
2024-02-05T18:24:19,780 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x3363228a, L:/127.0.0.1:46070 ! R:localhost/127.0.0.1:36439] -- Will try again in 0.1 s
2024-02-05T18:24:19,780 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-80e339bc2e] Closed connection [id: 0x3363228a, L:/127.0.0.1:46070 ! R:localhost/127.0.0.1:36439] -- Will try again in 0.1 s
2024-02-05T18:24:19,780 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-184e1fb0a7] Closed connection [id: 0x3363228a, L:/127.0.0.1:46070 ! R:localhost/127.0.0.1:36439] -- Will try again in 0.1 s
2024-02-05T18:24:19,781 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-80e339bc2e}, consumerId=0, consumerName=e4a38, address=/127.0.0.1:46070}
2024-02-05T18:24:19,781 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-80e339bc2e] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-80e339bc2e, ackPos=3:3, readPos=3:4}]
2024-02-05T18:24:19,781 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-80e339bc2e] Successfully closed dispatcher for reader
2024-02-05T18:24:19,782 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-184e1fb0a7}, consumerId=1, consumerName=cd89f, address=/127.0.0.1:46070}
2024-02-05T18:24:19,785 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:24:19,786 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:38121/persistent/__change_events] Closing managed ledger
2024-02-05T18:24:19,793 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:38121/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:24:19,793 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:24:19,795 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:24:19,796 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://sla-monitor/test/localhost:38121/__change_events] [reader-990780d405] Reconnecting after timeout
2024-02-05T18:24:19,797 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:24:19,824 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:40343
2024-02-05T18:24:19,826 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:24:19,828 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:24:19,828 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:24:19,829 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-184e1fb0a7] Closed Consumer (not connected)
2024-02-05T18:24:19,831 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-184e1fb0a7 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-184e1fb0a7 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:24:19,832 - INFO  - [main:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-e8f22b83ac] Closed Consumer (not connected)
2024-02-05T18:24:19,833 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:38121/__change_events] [reader-990780d405] Closed Consumer (not connected)
2024-02-05T18:24:19,833 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38121/__change_events with subscription name reader-990780d405 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38121/__change_events with subscription name reader-990780d405 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:24:19,834 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-80e339bc2e] Closed Consumer (not connected)
2024-02-05T18:24:19,835 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-80e339bc2e was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-80e339bc2e was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:24:19,842 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:24:19,842 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:24:19,845 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:24:19,846 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:24:19,854 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:24:19,855 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:24:19,983 - WARN  - [pulsar-io-64-2:ConnectionPool@304] - Failed to open connection to localhost/<unresolved>:40343 : java.nio.channels.ClosedChannelException
2024-02-05T18:24:19,983 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:38121/__change_events] [reader-990780d405] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: java.util.concurrent.CompletionException: java.nio.channels.ClosedChannelException
2024-02-05T18:24:19,983 - INFO  - [pulsar-io-64-2:ConnectionHandler@132] - [persistent://sla-monitor/test/localhost:38121/__change_events] [reader-990780d405] Ignoring reconnection request (state: Closed)
2024-02-05T18:24:20,291 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 44.73%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 53.87%, msgThroughputEMA= 0.00, updatedAt= 1707150260290, reportedAt= 1707150255428
2024-02-05T18:24:20,405 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:24:20,406 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:24:21,287 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:24:21,288 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:24:21,290 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:24:21,290 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:24:21,290 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:24:21,291 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:24:21,407 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:24:21,407 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:24:22,408 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:24:22,408 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:24:23,305 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:24:23,306 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:24:23,307 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:24:23,307 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:24:23,307 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6556471b{/static,null,STOPPED}
2024-02-05T18:24:23,307 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,STOPPED}
2024-02-05T18:24:23,309 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/topics,null,STOPPED}
2024-02-05T18:24:23,310 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,STOPPED}
2024-02-05T18:24:23,312 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,STOPPED}
2024-02-05T18:24:23,313 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,STOPPED}
2024-02-05T18:24:23,315 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/admin,null,STOPPED}
2024-02-05T18:24:23,316 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1978b0d5{/,null,STOPPED}
2024-02-05T18:24:23,317 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:24:23,318 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:24:23,318 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:24:23,319 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:44813
2024-02-05T18:24:23,322 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:44813 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:24:23,330 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:44813 was invalidated. state Releasing
2024-02-05T18:24:23,331 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:44813. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:24:23,331 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:44813
2024-02-05T18:24:23,335 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:44813/0x00000000_0xffffffff.
2024-02-05T18:24:23,336 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:44813/0x00000000_0xffffffff.
2024-02-05T18:24:23,337 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:44813/0x00000000_0xffffffff.
2024-02-05T18:24:23,337 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.005 seconds
2024-02-05T18:24:23,337 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:24:23,340 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0xbd22137f, L:/127.0.0.1:46064 ! R:localhost/127.0.0.1:36439] Disconnected
2024-02-05T18:24:23,340 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:24:23,340 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:24:23,341 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:44813/persistent/__change_events] Closing managed ledger
2024-02-05T18:24:23,341 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:46064
2024-02-05T18:24:23,341 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-5037d6007a}, consumerId=0, consumerName=61878, address=/127.0.0.1:46064}
2024-02-05T18:24:23,342 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-5037d6007a] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-5037d6007a, ackPos=3:3, readPos=3:4}]
2024-02-05T18:24:23,342 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-5037d6007a] Successfully closed dispatcher for reader
2024-02-05T18:24:23,342 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:44813/__change_events, name=reader-0d47b1a873}, consumerId=3, consumerName=6201c, address=/127.0.0.1:46064}
2024-02-05T18:24:23,343 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:44813/__change_events][reader-0d47b1a873] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:44813/persistent/__change_events, cursor=reader-0d47b1a873, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:24:23,343 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:44813/__change_events][reader-0d47b1a873] Successfully closed dispatcher for reader
2024-02-05T18:24:23,344 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-01e42d6906}, consumerId=2, consumerName=463c0, address=/127.0.0.1:46064}
2024-02-05T18:24:23,340 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0xbd22137f, L:/127.0.0.1:46064 ! R:localhost/127.0.0.1:36439] -- Will try again in 0.1 s
2024-02-05T18:24:23,345 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0xbd22137f, L:/127.0.0.1:46064 ! R:localhost/127.0.0.1:36439] -- Will try again in 0.1 s
2024-02-05T18:24:23,345 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0xbd22137f, L:/127.0.0.1:46064 ! R:localhost/127.0.0.1:36439] -- Will try again in 0.1 s
2024-02-05T18:24:23,345 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-5037d6007a] Closed connection [id: 0xbd22137f, L:/127.0.0.1:46064 ! R:localhost/127.0.0.1:36439] -- Will try again in 0.1 s
2024-02-05T18:24:23,346 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-73c9275c29] Closed connection [id: 0xbd22137f, L:/127.0.0.1:46064 ! R:localhost/127.0.0.1:36439] -- Will try again in 0.1 s
2024-02-05T18:24:23,346 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:24:23,346 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:44813/__change_events] [reader-0d47b1a873] Closed connection [id: 0xbd22137f, L:/127.0.0.1:46064 ! R:localhost/127.0.0.1:36439] -- Will try again in 0.1 s
2024-02-05T18:24:23,346 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:44813/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:24:23,346 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-01e42d6906] Closed connection [id: 0xbd22137f, L:/127.0.0.1:46064 ! R:localhost/127.0.0.1:36439] -- Will try again in 0.1 s
2024-02-05T18:24:23,346 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-73c9275c29}, consumerId=1, consumerName=4fe25, address=/127.0.0.1:46064}
2024-02-05T18:24:23,346 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:24:23,347 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:24:23,348 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:24:23,356 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:36439
2024-02-05T18:24:23,356 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:24:23,356 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:24:23,357 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:24:23,357 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-73c9275c29] Closed Consumer (not connected)
2024-02-05T18:24:23,357 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-5037d6007a] Closed Consumer (not connected)
2024-02-05T18:24:23,357 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-73c9275c29 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-73c9275c29 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:24:23,358 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-5037d6007a was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-5037d6007a was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:24:23,359 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-01e42d6906] Closed Consumer (not connected)
2024-02-05T18:24:23,359 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-01e42d6906 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-01e42d6906 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:24:23,360 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:44813/__change_events] [reader-0d47b1a873] Closed Consumer (not connected)
2024-02-05T18:24:23,360 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:44813/__change_events with subscription name reader-0d47b1a873 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:44813/__change_events with subscription name reader-0d47b1a873 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:24:23,363 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:24:23,364 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:24:23,364 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:24:23,364 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:24:23,365 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:24:23,365 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:24:23,366 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:24:23,366 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:24:24,650 - INFO  - [globalEventExecutor-10-5:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:24:24,651 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:24:24,652 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:24:24,653 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:24:24,653 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:24:24,653 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:24:24,661 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:24:24,661 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:24:24,665 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:24:24,665 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:24:24,665 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 67 with name 'Thread[AsyncHttpClient-37-1,5,main]'
2024-02-05T18:24:24,666 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:24:24,666 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:24:24,666 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:24:24,666 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:24:24,666 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:24:24,666 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:24:24,666 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:24:24,666 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 188 with name 'Thread[globalEventExecutor-10-5,5,main]'
2024-02-05T18:24:24,666 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:24:24,666 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:24:24,666 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@465d9cce
2024-02-05T18:24:24,667 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:24:24,667 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:24:24,667 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 22.655 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  48.537 s
[INFO] Finished at: 2024-02-05T18:24:24+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 8 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:24:56,326 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:24:57,340 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:24:57,342 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:24:57,769 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:24:57,770 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:24:57,771 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:24:57,772 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:24:57,772 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:24:57,773 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:24:57,788 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:24:57,789 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:24:57,790 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:24:57,790 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:24:57,791 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:24:57,792 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:24:57,792 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:24:57,793 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:24:57,794 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:24:57,794 - INFO  - [main:Environment@98] - Client environment:os.memory.free=26MB
2024-02-05T18:24:57,795 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:24:57,795 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:24:59,395 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:24:59,396 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:24:59,396 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:24:59,397 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:24:59,707 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:24:59,708 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:24:59,788 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:24:59,875 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:24:59,879 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:24:59,896 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:25:00,008 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:25:00,055 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:25:00,119 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:25:00,419 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:25:00,420 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:25:00,450 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:25:00,515 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:35437, TLS: (none), listener: (none)
2024-02-05T18:25:00,780 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44125, TLS: OPENSSL, listener: (none)
2024-02-05T18:25:00,799 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:25:00,805 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:25:00,805 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:25:00,840 - INFO  - [main:Log@170] - Logging initialized @6733ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:25:01,737 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:25:01,767 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:25:01,768 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:25:01,769 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:25:02,570 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1978b0d5{/,null,AVAILABLE}
2024-02-05T18:25:03,679 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/admin,null,AVAILABLE}
2024-02-05T18:25:04,810 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,AVAILABLE}
2024-02-05T18:25:05,115 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,AVAILABLE}
2024-02-05T18:25:05,246 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,AVAILABLE}
2024-02-05T18:25:05,382 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/topics,null,AVAILABLE}
2024-02-05T18:25:05,383 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,AVAILABLE}
2024-02-05T18:25:05,385 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6556471b{/static,null,AVAILABLE}
2024-02-05T18:25:05,398 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:44571}
2024-02-05T18:25:05,554 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:45461}
2024-02-05T18:25:05,554 - INFO  - [main:Server@415] - Started @11450ms
2024-02-05T18:25:05,555 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:44571
2024-02-05T18:25:05,556 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:45461
2024-02-05T18:25:05,563 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:25:05,564 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:25:05,718 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:44571
2024-02-05T18:25:05,732 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:25:05,736 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:44571 is changing the role from null to Leader
2024-02-05T18:25:05,741 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:44571).
2024-02-05T18:25:05,994 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:44571 
2024-02-05T18:25:06,434 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:25:06,466 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:25:06,583 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:25:06,588 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:25:06,600 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:25:06,602 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:25:06,648 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:25:06,687 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:25:06,724 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:25:06,805 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:25:06,829 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:25:06,842 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:25:06,845 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:25:06,881 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:25:06 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 601
2024-02-05T18:25:06,886 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:25:07,029 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0xc8a50831, L:/127.0.0.1:50612 - R:localhost/127.0.0.1:35437]] Connected to server
2024-02-05T18:25:07,064 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:50612] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:25:07,129 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:25:07,140 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xc8a50831, L:/127.0.0.1:50612 - R:localhost/127.0.0.1:35437]
2024-02-05T18:25:07,202 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:25:07,229 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:50612] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:50612, producerName=test-0-0, producerId=0}
2024-02-05T18:25:07,237 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0xc8a50831, L:/127.0.0.1:50612 - R:localhost/127.0.0.1:35437]
2024-02-05T18:25:07,239 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:25:07,292 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:25:07,294 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-2f92cd98fd] Subscribing to topic on cnx [id: 0xc8a50831, L:/127.0.0.1:50612 - R:localhost/127.0.0.1:35437], consumerId 0
2024-02-05T18:25:07,306 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xd4aa5bf1, L:/127.0.0.1:35437 - R:/127.0.0.1:50612]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-2f92cd98fd. consumerId: 0
2024-02-05T18:25:07,348 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-2f92cd98fd] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:25:07,349 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:25:07,350 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-2f92cd98fd, ackPos=3:-1, readPos=3:0}
2024-02-05T18:25:07,369 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50612] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-2f92cd98fd
2024-02-05T18:25:07,375 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-2f92cd98fd] Subscribed to topic on localhost/127.0.0.1:35437 -- consumer: 0
2024-02-05T18:25:07,391 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.014 seconds
2024-02-05T18:25:07,392 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:25:07,394 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:25:07,394 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:25:07,434 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:25:07,450 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:25:07,451 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:25:07,452 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:25:07 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 42
2024-02-05T18:25:07,453 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:25:07,465 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:25:07,476 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:25:07,477 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:25:07,479 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:25:07,480 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:25:07 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:25:07,501 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:25:07,503 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xc8a50831, L:/127.0.0.1:50612 - R:localhost/127.0.0.1:35437]
2024-02-05T18:25:07,513 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:25:07,520 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:50612] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:50612, producerName=test-0-1, producerId=1}
2024-02-05T18:25:07,522 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0xc8a50831, L:/127.0.0.1:50612 - R:localhost/127.0.0.1:35437]
2024-02-05T18:25:07,542 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:25:07,544 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-c459c9527e] Subscribing to topic on cnx [id: 0xc8a50831, L:/127.0.0.1:50612 - R:localhost/127.0.0.1:35437], consumerId 1
2024-02-05T18:25:07,546 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xd4aa5bf1, L:/127.0.0.1:35437 - R:/127.0.0.1:50612]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-c459c9527e. consumerId: 1
2024-02-05T18:25:07,573 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-c459c9527e] Created new subscription for 1
2024-02-05T18:25:07,574 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50612] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-c459c9527e
2024-02-05T18:25:07,575 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-c459c9527e] Subscribed to topic on localhost/127.0.0.1:35437 -- consumer: 1
2024-02-05T18:25:07,601 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:25:07,603 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xc8a50831, L:/127.0.0.1:50612 - R:localhost/127.0.0.1:35437]
2024-02-05T18:25:07,612 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:25:07,620 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:50612] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:50612, producerName=test-0-2, producerId=2}
2024-02-05T18:25:07,622 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0xc8a50831, L:/127.0.0.1:50612 - R:localhost/127.0.0.1:35437]
2024-02-05T18:25:07,635 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:25:07,657 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:25:07,662 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:44571 started the ownership monitor.
2024-02-05T18:25:07,678 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:25:07,680 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-c4f29189b1] Subscribing to topic on cnx [id: 0xc8a50831, L:/127.0.0.1:50612 - R:localhost/127.0.0.1:35437], consumerId 2
2024-02-05T18:25:07,687 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xd4aa5bf1, L:/127.0.0.1:35437 - R:/127.0.0.1:50612]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-c4f29189b1. consumerId: 2
2024-02-05T18:25:07,700 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-c4f29189b1] Created new subscription for 2
2024-02-05T18:25:07,701 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50612] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-c4f29189b1
2024-02-05T18:25:07,702 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:44571/__change_events
2024-02-05T18:25:07,702 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-c4f29189b1] Subscribed to topic on localhost/127.0.0.1:35437 -- consumer: 2
2024-02-05T18:25:07,703 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:44571 plays the leader now.
2024-02-05T18:25:07,709 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.91%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 53.91%, msgThroughputEMA= 0.00, updatedAt= 1707150307708, reportedAt= 0
2024-02-05T18:25:07,744 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:25:07,759 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:25:07,762 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 1.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:25:07,817 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:44571/0x00000000_0xffffffff - localhost:44571.
2024-02-05T18:25:07,821 - INFO  - [pulsar-7-4:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:44571/0x00000000_0xffffffff
2024-02-05T18:25:07,821 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:44571
2024-02-05T18:25:07,822 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:44571/0x00000000_0xffffffff - localhost:44571.
2024-02-05T18:25:07,823 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:44571
2024-02-05T18:25:07,823 - INFO  - [pulsar-7-3:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:44571/0x00000000_0xffffffff
2024-02-05T18:25:07,828 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:44571/__change_events][reader-7e88943a8c] Subscribing to topic on cnx [id: 0xc8a50831, L:/127.0.0.1:50612 - R:localhost/127.0.0.1:35437], consumerId 3
2024-02-05T18:25:07,830 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xd4aa5bf1, L:/127.0.0.1:35437 - R:/127.0.0.1:50612]] Subscribing on topic persistent://sla-monitor/test/localhost:44571/__change_events / reader-7e88943a8c. consumerId: 3
2024-02-05T18:25:07,838 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:44571 doesn't exist.
2024-02-05T18:25:07,839 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:44571/persistent/__change_events
2024-02-05T18:25:07,842 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:44571/persistent/__change_events'
2024-02-05T18:25:07,852 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:25:07,854 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:44571/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:25:07,862 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:44571/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:25:07,868 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:44571/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:25:07,873 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:44571/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:44571/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:25:07,874 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:44571/__change_events - dedup is disabled
2024-02-05T18:25:07,883 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:25:07,889 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:44571/__change_events][reader-7e88943a8c] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:25:07,890 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:44571/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:25:07,890 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:44571/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:44571/persistent/__change_events, cursor=reader-7e88943a8c, ackPos=7:-1, readPos=7:0}
2024-02-05T18:25:07,893 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:50612] Created subscription on topic persistent://sla-monitor/test/localhost:44571/__change_events / reader-7e88943a8c
2024-02-05T18:25:07,894 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:44571/__change_events][reader-7e88943a8c] Subscribed to topic on localhost/127.0.0.1:35437 -- consumer: 3
2024-02-05T18:25:07,853 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 44571, tls-port = Optional[45461], broker url= pulsar://localhost:35437, broker tls url= pulsar+ssl://localhost:44125, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[35437], brokerServicePortTls=Optional[44125], webServicePort=Optional[44571], webServicePortTls=Optional[45461], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:25:08,450 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:25:08,450 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:25:08,450 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:25:08,451 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:25:08,455 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:25:08,456 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:25:08,461 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:25:08,465 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:25:08,472 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:25:08,473 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:25:08,479 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:25:08,485 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:25:08,490 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:25:08,503 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:25:08,503 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:25:08,511 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:25:08,514 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:32773, TLS: (none), listener: (none)
2024-02-05T18:25:08,516 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44277, TLS: OPENSSL, listener: (none)
2024-02-05T18:25:08,522 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:25:08,524 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:25:08,524 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:25:08,538 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:25:08,546 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:25:08,546 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:25:08,547 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:25:08,665 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/,null,AVAILABLE}
2024-02-05T18:25:08,763 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:25:08,764 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:25:09,307 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/admin,null,AVAILABLE}
2024-02-05T18:25:09,764 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:25:09,765 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:25:10,573 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,AVAILABLE}
2024-02-05T18:25:10,766 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:25:10,766 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:25:10,771 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,AVAILABLE}
2024-02-05T18:25:10,829 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,AVAILABLE}
2024-02-05T18:25:10,887 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/topics,null,AVAILABLE}
2024-02-05T18:25:10,888 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,AVAILABLE}
2024-02-05T18:25:10,888 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@554f6e30{/static,null,AVAILABLE}
2024-02-05T18:25:10,890 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:40805}
2024-02-05T18:25:10,897 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:34357}
2024-02-05T18:25:10,897 - INFO  - [main:Server@415] - Started @16792ms
2024-02-05T18:25:10,897 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:40805
2024-02-05T18:25:10,899 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:34357
2024-02-05T18:25:10,901 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:25:10,902 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:25:10,930 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:40805
2024-02-05T18:25:10,933 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:40805 registry has been created.
2024-02-05T18:25:10,934 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:40805. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:25:10,939 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:44571).
2024-02-05T18:25:10,939 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:40805 is changing the role from null to Follower
2024-02-05T18:25:10,945 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:25:10,959 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:40805 
2024-02-05T18:25:11,071 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:25:11 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 59
2024-02-05T18:25:11,092 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:25:11,095 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:25:11,096 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:25:11,109 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:25:11 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 32
2024-02-05T18:25:11,112 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:40805/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:25:11,122 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xe2de2bf0, L:/127.0.0.1:37352 - R:localhost/127.0.0.1:32773]] Connected to server
2024-02-05T18:25:11,127 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:37352] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:25:11,147 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x577b207c, L:/127.0.0.1:44192 - R:localhost/127.0.0.1:35437]] Connected to server
2024-02-05T18:25:11,151 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:44192] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:25:11,152 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x577b207c, L:/127.0.0.1:44192 - R:localhost/127.0.0.1:35437]
2024-02-05T18:25:11,163 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:44192] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:44192, producerName=test-0-3, producerId=0}
2024-02-05T18:25:11,164 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x577b207c, L:/127.0.0.1:44192 - R:localhost/127.0.0.1:35437]
2024-02-05T18:25:11,178 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7a1d8f1940] Subscribing to topic on cnx [id: 0x577b207c, L:/127.0.0.1:44192 - R:localhost/127.0.0.1:35437], consumerId 0
2024-02-05T18:25:11,180 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x01f481ed, L:/127.0.0.1:35437 - R:/127.0.0.1:44192]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-7a1d8f1940. consumerId: 0
2024-02-05T18:25:11,185 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7a1d8f1940] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:25:11,186 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:25:11,186 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-7a1d8f1940, ackPos=3:-1, readPos=3:0}
2024-02-05T18:25:11,188 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:44192] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-7a1d8f1940
2024-02-05T18:25:11,189 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7a1d8f1940] Subscribed to topic on localhost/127.0.0.1:35437 -- consumer: 0
2024-02-05T18:25:11,196 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.006 seconds
2024-02-05T18:25:11,197 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:25:11,227 - INFO  - [pulsar-web-84-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:25:11 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:25:11,234 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:25:11,237 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:25:11,238 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:25:11,242 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:40805/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:25:11,244 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:25:11 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T18:25:11,256 - INFO  - [pulsar-web-84-7:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:25:11 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 9
2024-02-05T18:25:11,263 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:25:11,266 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:25:11,267 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:25:11,271 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:40805/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:25:11,272 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:25:11 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:25:11,286 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x577b207c, L:/127.0.0.1:44192 - R:localhost/127.0.0.1:35437]
2024-02-05T18:25:11,294 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:44192] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:44192, producerName=test-0-4, producerId=1}
2024-02-05T18:25:11,295 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x577b207c, L:/127.0.0.1:44192 - R:localhost/127.0.0.1:35437]
2024-02-05T18:25:11,309 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-1c461e868a] Subscribing to topic on cnx [id: 0x577b207c, L:/127.0.0.1:44192 - R:localhost/127.0.0.1:35437], consumerId 1
2024-02-05T18:25:11,310 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x01f481ed, L:/127.0.0.1:35437 - R:/127.0.0.1:44192]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-1c461e868a. consumerId: 1
2024-02-05T18:25:11,322 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-1c461e868a] Created new subscription for 1
2024-02-05T18:25:11,322 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:44192] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-1c461e868a
2024-02-05T18:25:11,323 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-1c461e868a] Subscribed to topic on localhost/127.0.0.1:35437 -- consumer: 1
2024-02-05T18:25:11,341 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x577b207c, L:/127.0.0.1:44192 - R:localhost/127.0.0.1:35437]
2024-02-05T18:25:11,348 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:44192] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:44192, producerName=test-0-5, producerId=2}
2024-02-05T18:25:11,350 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x577b207c, L:/127.0.0.1:44192 - R:localhost/127.0.0.1:35437]
2024-02-05T18:25:11,351 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:25:11,355 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:25:11,357 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:40805 plays a follower now.
2024-02-05T18:25:11,386 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:40805/__change_events
2024-02-05T18:25:11,423 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:40805/0x00000000_0xffffffff - localhost:40805.
2024-02-05T18:25:11,425 - INFO  - [pulsar-62-3:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:40805/0x00000000_0xffffffff
2024-02-05T18:25:11,430 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:40805/__change_events][reader-59b150cc80] Subscribing to topic on cnx [id: 0xe2de2bf0, L:/127.0.0.1:37352 - R:localhost/127.0.0.1:32773], consumerId 2
2024-02-05T18:25:11,424 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:40805
2024-02-05T18:25:11,432 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xf29d3de9, L:/127.0.0.1:32773 - R:/127.0.0.1:37352]] Subscribing on topic persistent://sla-monitor/test/localhost:40805/__change_events / reader-59b150cc80. consumerId: 2
2024-02-05T18:25:11,433 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:40805/0x00000000_0xffffffff - localhost:40805.
2024-02-05T18:25:11,435 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:40805/0x00000000_0xffffffff
2024-02-05T18:25:11,436 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:40805
2024-02-05T18:25:11,438 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:40805 doesn't exist.
2024-02-05T18:25:11,440 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:40805/persistent/__change_events
2024-02-05T18:25:11,440 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=2, bootstrap service port = 40805, tls-port = Optional[34357], broker url= pulsar://localhost:32773, broker tls url= pulsar+ssl://localhost:44277, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[32773], brokerServicePortTls=Optional[44277], webServicePort=Optional[40805], webServicePortTls=Optional[34357], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:25:11,443 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:40805/persistent/__change_events'
2024-02-05T18:25:11,454 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:25:11,456 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:40805/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:25:11,463 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:40805/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:25:11,468 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:40805/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:25:11,471 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:40805/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:40805/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:25:11,472 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:40805/__change_events - dedup is disabled
2024-02-05T18:25:11,479 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:25:11,485 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:40805/__change_events][reader-59b150cc80] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:25:11,486 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:40805/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:25:11,486 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:40805/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:40805/persistent/__change_events, cursor=reader-59b150cc80, ackPos=9:-1, readPos=9:0}
2024-02-05T18:25:11,488 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:37352] Created subscription on topic persistent://sla-monitor/test/localhost:40805/__change_events / reader-59b150cc80
2024-02-05T18:25:11,489 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:40805/__change_events][reader-59b150cc80] Subscribed to topic on localhost/127.0.0.1:32773 -- consumer: 2
2024-02-05T18:25:11,663 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:25:11,664 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:25:11 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:25:11,693 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:25:11,694 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:25:11 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:25:11,718 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:25:11,718 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:25:11,724 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:25:11,728 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:25:11 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 28
2024-02-05T18:25:11,751 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:25:11,752 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:25:11,753 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:25:11 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 20
2024-02-05T18:25:11,754 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:25:11,756 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:25:11,758 - INFO  - [pulsar-7-2:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:25:11,763 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:25:11,764 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:25:11,767 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:25:11,767 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:25:11,768 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:25:11,770 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:25:11 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:25:11,784 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:25:11,784 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:25:11,784 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:25:11,785 - INFO  - [pulsar-62-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:25:11,785 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:25:11 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:25:11,789 - INFO  - [pulsar-7-3:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:25:11,823 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:25:11,833 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:25:11,833 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:25:11,849 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:25:11,860 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:25:11,881 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:44571 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:25:11,925 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44571 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:44571, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150311883, versionId=1]. totalHandledRequests:1
2024-02-05T18:25:11,954 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44571 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:44571, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150311943, versionId=2]. totalHandledRequests:1
2024-02-05T18:25:11,958 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:25:11,980 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:25:11,990 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:25:11,991 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:25:12,000 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44571 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:44571, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150311970, versionId=3]. totalHandledRequests:1
2024-02-05T18:25:12,009 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:25:12,010 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 9.0 ms
2024-02-05T18:25:12,021 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44571 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:44571, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150312001, versionId=4]. totalHandledRequests:1
2024-02-05T18:25:12,023 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:25:12,023 - INFO  - [broker-client-shared-internal-executor-11-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:25:12,024 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:25:11 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 179
2024-02-05T18:25:12,025 - WARN  - [ForkJoinPool.commonPool-worker-2:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:44571. Skipping this broker. Phase one
2024-02-05T18:25:12,025 - WARN  - [ForkJoinPool.commonPool-worker-2:LeastResourceUsageWithWeight@126] - There is no broker load data for broker:localhost:44571. Skipping this broker. Phase two
2024-02-05T18:25:12,025 - INFO  - [ForkJoinPool.commonPool-worker-2:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:40805 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:25:12,025 - INFO  - [AsyncHttpClient-37-1:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:25:12,026 - INFO  - [AsyncHttpClient-37-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:25:11 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 207
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:25:12,039 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44571 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:40805, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150312025, versionId=5]. totalHandledRequests:2
2024-02-05T18:25:12,048 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:25:12,049 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44571 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:40805, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150312033, versionId=6]. totalHandledRequests:2
2024-02-05T18:25:12,055 - INFO  - [pulsar-io-9-1:ConnectionPool@265] - [[id: 0x65731b33, L:/127.0.0.1:37354 - R:localhost/127.0.0.1:32773]] Connected to server
2024-02-05T18:25:12,059 - INFO  - [pulsar-io-64-2:ServerCnx@724] - [/127.0.0.1:37354] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:25:12,059 - INFO  - [pulsar-io-9-1:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-83c6f9e85a] Subscribing to topic on cnx [id: 0x65731b33, L:/127.0.0.1:37354 - R:localhost/127.0.0.1:32773], consumerId 4
2024-02-05T18:25:12,061 - INFO  - [pulsar-io-64-2:ServerCnx@1173] - [[id: 0x087e833b, L:/127.0.0.1:32773 - R:/127.0.0.1:37354]] Subscribing on topic persistent://public/test/__change_events / reader-83c6f9e85a. consumerId: 4
2024-02-05T18:25:12,131 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:25:12,133 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:25:12,140 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:25:12,141 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:25:12,148 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:25:12,153 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@36583474], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2b533872] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@36583474, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c57b053], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2b533872, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13dac63] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@36583474, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c57b053, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7631c3a4], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2b533872, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13dac63, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4413e5b8] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@36583474, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c57b053, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7631c3a4, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@75771041], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2b533872, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13dac63, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4413e5b8, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19c5e438] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@36583474, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c57b053, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7631c3a4, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@75771041, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@61912847], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2b533872, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13dac63, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4413e5b8, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19c5e438, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a743fe8] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@36583474, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c57b053, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7631c3a4, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@75771041, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@61912847, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@77ccc5ff], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2b533872, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13dac63, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4413e5b8, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19c5e438, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a743fe8, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@411e1b1a] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@36583474, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c57b053, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7631c3a4, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@75771041, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@61912847, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@77ccc5ff, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2925c06e], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2b533872, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13dac63, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4413e5b8, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19c5e438, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a743fe8, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@411e1b1a, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@32b531dd] 
2024-02-05T18:25:12,160 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-4bbd416a08] Subscribing to topic on cnx [id: 0xe2de2bf0, L:/127.0.0.1:37352 - R:localhost/127.0.0.1:32773], consumerId 3
2024-02-05T18:25:12,171 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:25:12,174 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xf29d3de9, L:/127.0.0.1:32773 - R:/127.0.0.1:37352]] Subscribing on topic persistent://public/test/__change_events / reader-4bbd416a08. consumerId: 3
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:25:12,180 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:25:12,192 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:25:12,196 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:25:12,199 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:25:12,205 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-4bbd416a08] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:25:12,206 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:25:12,206 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-4bbd416a08, ackPos=11:-1, readPos=11:0}
2024-02-05T18:25:12,208 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:37352] Created subscription on topic persistent://public/test/__change_events / reader-4bbd416a08
2024-02-05T18:25:12,209 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-4bbd416a08] Subscribed to topic on localhost/127.0.0.1:32773 -- consumer: 3
2024-02-05T18:25:12,222 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:25:12,223 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:25:12,223 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:25:12,228 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@554f6e30{/static,null,STOPPED}
2024-02-05T18:25:12,229 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-83c6f9e85a] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:25:12,229 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,STOPPED}
2024-02-05T18:25:12,229 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:25:12,229 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-83c6f9e85a, ackPos=11:-1, readPos=11:0}
2024-02-05T18:25:12,231 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:37354] Created subscription on topic persistent://public/test/__change_events / reader-83c6f9e85a
2024-02-05T18:25:12,233 - INFO  - [pulsar-io-9-1:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-83c6f9e85a] Subscribed to topic on localhost/127.0.0.1:32773 -- consumer: 4
2024-02-05T18:25:12,238 - INFO  - [pulsar-io-64-2:ServerCnx@2007] - [/127.0.0.1:37354] Closing consumer: consumerId=4
2024-02-05T18:25:12,238 - INFO  - [pulsar-io-64-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-83c6f9e85a}, consumerId=4, consumerName=c52eb, address=/127.0.0.1:37354}
2024-02-05T18:25:12,239 - INFO  - [pulsar-io-64-2:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-83c6f9e85a] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-83c6f9e85a, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:25:12,240 - INFO  - [pulsar-io-64-2:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-83c6f9e85a] Successfully closed dispatcher for reader
2024-02-05T18:25:12,241 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/topics,null,STOPPED}
2024-02-05T18:25:12,246 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,STOPPED}
2024-02-05T18:25:12,248 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,STOPPED}
2024-02-05T18:25:12,249 - INFO  - [pulsar-io-64-2:ServerCnx@2043] - [/127.0.0.1:37354] Closed consumer, consumerId=4
2024-02-05T18:25:12,250 - INFO  - [pulsar-io-9-1:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-83c6f9e85a] Closed consumer
2024-02-05T18:25:12,252 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:25:12,253 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,STOPPED}
2024-02-05T18:25:12,255 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/admin,null,STOPPED}
2024-02-05T18:25:12,257 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/,null,STOPPED}
2024-02-05T18:25:12,260 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:25:12,262 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:25:12,262 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:25:12,264 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:40805
2024-02-05T18:25:12,270 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:44571. Skipping this broker. Phase one
2024-02-05T18:25:12,270 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:40805, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150312033, versionId=6] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:44571, sourceBroker=localhost:40805, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150312270, versionId=7]
2024-02-05T18:25:12,279 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44571 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:44571, sourceBroker=localhost:40805, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150312270, versionId=7]. totalHandledRequests:6
2024-02-05T18:25:12,280 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:44571 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:44571, sourceBroker=localhost:40805, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150312270, versionId=7], next:, totalHandledRequests:6, totalFailedRequests:6
2024-02-05T18:25:12,281 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:25:12,281 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:25:12,284 - INFO  - [broker-client-shared-internal-executor-65-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-4bbd416a08}, consumerId=3, consumerName=82003, address=/127.0.0.1:37352}
2024-02-05T18:25:12,285 - INFO  - [pulsar-io-64-2:ClientCnx@816] - [localhost/127.0.0.1:32773] Broker notification of Closed consumer: 3
2024-02-05T18:25:12,286 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-4bbd416a08] Closed connection [id: 0xe2de2bf0, L:/127.0.0.1:37352 - R:localhost/127.0.0.1:32773] -- Will try again in 0.1 s
2024-02-05T18:25:12,287 - INFO  - [broker-client-shared-internal-executor-65-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-4bbd416a08}, consumerId=3, consumerName=82003, address=/127.0.0.1:37352}
2024-02-05T18:25:12,287 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-4bbd416a08] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-4bbd416a08, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:25:12,288 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-4bbd416a08] Successfully closed dispatcher for reader
2024-02-05T18:25:12,289 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-4bbd416a08] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-4bbd416a08, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:25:12,290 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-4bbd416a08] Successfully disconnected and closed subscription
2024-02-05T18:25:12,291 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:25:12,291 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:25:12,294 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:25:12,304 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:25:12,310 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:25:12,311 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:25:12,312 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-4bbd416a08] Closed Consumer (not connected)
2024-02-05T18:25:12,313 - INFO  - [broker-client-shared-internal-executor-11-1:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-7862f6f818] Subscribing to topic on cnx [id: 0xc8a50831, L:/127.0.0.1:50612 - R:localhost/127.0.0.1:35437], consumerId 5
2024-02-05T18:25:12,312 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-4bbd416a08 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-4bbd416a08 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:25:12,313 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 32.0 ms
2024-02-05T18:25:12,315 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xd4aa5bf1, L:/127.0.0.1:35437 - R:/127.0.0.1:50612]] Subscribing on topic persistent://public/test/__change_events / reader-7862f6f818. consumerId: 5
2024-02-05T18:25:12,324 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:25:12,343 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 14
2024-02-05T18:25:12,344 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 14 after closed null
2024-02-05T18:25:12,351 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:25:12,357 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:25:12,358 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:25:12,362 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 14:-1
2024-02-05T18:25:12,362 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=14:-1 -- todo=0
2024-02-05T18:25:12,363 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:25:12,367 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:25:12,376 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-7862f6f818] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:25:12,376 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=14:0 mark-delete-position=14:-1
2024-02-05T18:25:12,376 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-7862f6f818, ackPos=14:-1, readPos=14:0}
2024-02-05T18:25:12,378 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50612] Created subscription on topic persistent://public/test/__change_events / reader-7862f6f818
2024-02-05T18:25:12,379 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-7862f6f818] Subscribed to topic on localhost/127.0.0.1:35437 -- consumer: 5
2024-02-05T18:25:12,387 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://public/test/__change_events] [reader-4bbd416a08] Reconnecting after timeout
2024-02-05T18:25:12,387 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [persistent://public/test/__change_events] [reader-4bbd416a08] Ignoring reconnection request (state: Closed)
2024-02-05T18:25:12,654 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:25:12,655 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 42.58%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 42.58%, msgThroughputEMA= 0.00, updatedAt= 1707150312654, reportedAt= 0
2024-02-05T18:25:12,768 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:25:12,768 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:25:13,769 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:25:13,770 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:25:14,770 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:25:14,771 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:25:15,381 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:40805 in 3114.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:25:15,386 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:40805 registry has been deleted.
2024-02-05T18:25:15,387 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:40805 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:25:15,387 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:40805 was invalidated. state Releasing
2024-02-05T18:25:15,389 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:40805. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:25:15,389 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:40805 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:25:15,389 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:40805
2024-02-05T18:25:15,390 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:40805
2024-02-05T18:25:15,391 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:40805 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:25:15,401 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:40805/0x00000000_0xffffffff.
2024-02-05T18:25:15,402 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:40805/0x00000000_0xffffffff.
2024-02-05T18:25:15,404 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:40805/0x00000000_0xffffffff.
2024-02-05T18:25:15,405 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.014 seconds
2024-02-05T18:25:15,406 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:25:15,409 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:25:15,410 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xe2de2bf0, L:/127.0.0.1:37352 ! R:localhost/127.0.0.1:32773] Disconnected
2024-02-05T18:25:15,411 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:40805/persistent/__change_events] Closing managed ledger
2024-02-05T18:25:15,411 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:37352
2024-02-05T18:25:15,412 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:40805/__change_events] [reader-59b150cc80] Closed connection [id: 0xe2de2bf0, L:/127.0.0.1:37352 ! R:localhost/127.0.0.1:32773] -- Will try again in 0.1 s
2024-02-05T18:25:15,412 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:40805/__change_events, name=reader-59b150cc80}, consumerId=2, consumerName=34f5c, address=/127.0.0.1:37352}
2024-02-05T18:25:15,413 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:40805/__change_events][reader-59b150cc80] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:40805/persistent/__change_events, cursor=reader-59b150cc80, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:25:15,413 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:40805/__change_events][reader-59b150cc80] Successfully closed dispatcher for reader
2024-02-05T18:25:15,413 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:44192
2024-02-05T18:25:15,414 - INFO  - [pulsar-io-9-1:ClientCnx@308] - [id: 0x65731b33, L:/127.0.0.1:37354 ! R:localhost/127.0.0.1:32773] Disconnected
2024-02-05T18:25:15,415 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x577b207c, L:/127.0.0.1:44192 ! R:localhost/127.0.0.1:35437] Disconnected
2024-02-05T18:25:15,415 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x577b207c, L:/127.0.0.1:44192 ! R:localhost/127.0.0.1:35437] -- Will try again in 0.1 s
2024-02-05T18:25:15,415 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x577b207c, L:/127.0.0.1:44192 ! R:localhost/127.0.0.1:35437] -- Will try again in 0.1 s
2024-02-05T18:25:15,415 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x577b207c, L:/127.0.0.1:44192 ! R:localhost/127.0.0.1:35437] -- Will try again in 0.1 s
2024-02-05T18:25:15,416 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-7a1d8f1940] Closed connection [id: 0x577b207c, L:/127.0.0.1:44192 ! R:localhost/127.0.0.1:35437] -- Will try again in 0.1 s
2024-02-05T18:25:15,416 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-1c461e868a] Closed connection [id: 0x577b207c, L:/127.0.0.1:44192 ! R:localhost/127.0.0.1:35437] -- Will try again in 0.1 s
2024-02-05T18:25:15,416 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:40805/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:25:15,416 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:25:15,416 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-7a1d8f1940}, consumerId=0, consumerName=c17f6, address=/127.0.0.1:44192}
2024-02-05T18:25:15,417 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7a1d8f1940] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-7a1d8f1940, ackPos=3:6, readPos=3:7}]
2024-02-05T18:25:15,417 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:37354
2024-02-05T18:25:15,417 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7a1d8f1940] Successfully closed dispatcher for reader
2024-02-05T18:25:15,418 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-1c461e868a}, consumerId=1, consumerName=13d50, address=/127.0.0.1:44192}
2024-02-05T18:25:15,419 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:25:15,420 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:25:15,428 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:32773
2024-02-05T18:25:15,429 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:25:15,430 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:25:15,431 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:25:15,432 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:40805/__change_events] [reader-59b150cc80] Closed Consumer (not connected)
2024-02-05T18:25:15,432 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:40805/__change_events with subscription name reader-59b150cc80 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:40805/__change_events with subscription name reader-59b150cc80 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:25:15,433 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-7a1d8f1940] Closed Consumer (not connected)
2024-02-05T18:25:15,434 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-1c461e868a] Closed Consumer (not connected)
2024-02-05T18:25:15,435 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-7a1d8f1940 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-7a1d8f1940 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:25:15,435 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-1c461e868a was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-1c461e868a was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:25:15,441 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:25:15,442 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:25:15,444 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:25:15,445 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:25:15,450 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:25:15,451 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:25:15,777 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:25:15,777 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:40805 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:25:15,778 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:40805 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:25:15,778 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:40805]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:25:15,778 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:40805
2024-02-05T18:25:15,780 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:40805 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:25:16,721 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:25:16,722 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:25:16,723 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:25:16,724 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:25:16,724 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:25:16,725 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:25:16,779 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:25:16,780 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:40805 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:25:16,781 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:40805 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:25:16,781 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 1.0 ms. Scheduled cleanups for inactive brokers:[localhost:40805]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:25:16,781 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:40805
2024-02-05T18:25:16,782 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:40805 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:25:17,654 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 43.75%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 42.70%, msgThroughputEMA= 0.00, updatedAt= 1707150317653, reportedAt= 1707150312660
2024-02-05T18:25:17,782 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:25:17,782 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:40805 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:25:17,782 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:40805 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:25:17,783 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:40805]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:25:17,783 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:40805
2024-02-05T18:25:17,784 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:40805 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:25:18,738 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:25:18,739 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:25:18,740 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:25:18,740 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:25:18,740 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6556471b{/static,null,STOPPED}
2024-02-05T18:25:18,741 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,STOPPED}
2024-02-05T18:25:18,742 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/topics,null,STOPPED}
2024-02-05T18:25:18,743 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,STOPPED}
2024-02-05T18:25:18,745 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,STOPPED}
2024-02-05T18:25:18,746 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,STOPPED}
2024-02-05T18:25:18,747 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/admin,null,STOPPED}
2024-02-05T18:25:18,748 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1978b0d5{/,null,STOPPED}
2024-02-05T18:25:18,750 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:25:18,751 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:25:18,751 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:25:18,751 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:44571
2024-02-05T18:25:18,753 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:44571, sourceBroker=localhost:40805, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150312270, versionId=7]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:25:23,764 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:44571 in 5010.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:25:23,772 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:44571 was invalidated. state Releasing
2024-02-05T18:25:23,773 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:44571. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:25:23,773 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:44571
2024-02-05T18:25:23,776 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:44571/0x00000000_0xffffffff.
2024-02-05T18:25:23,777 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:44571/0x00000000_0xffffffff.
2024-02-05T18:25:23,777 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:44571/0x00000000_0xffffffff.
2024-02-05T18:25:23,784 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44571 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:44571, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150323778, versionId=8]. totalHandledRequests:10
2024-02-05T18:25:23,785 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:25:23,785 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:25:23,785 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:25:23,785 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-7862f6f818}, consumerId=5, consumerName=d4146, address=/127.0.0.1:50612}
2024-02-05T18:25:23,785 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-7862f6f818}, consumerId=5, consumerName=d4146, address=/127.0.0.1:50612}
2024-02-05T18:25:23,785 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-7862f6f818] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-7862f6f818, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:25:23,786 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-7862f6f818] Successfully closed dispatcher for reader
2024-02-05T18:25:23,786 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:35437] Broker notification of Closed consumer: 5
2024-02-05T18:25:23,786 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-7862f6f818] Closed connection [id: 0xc8a50831, L:/127.0.0.1:50612 - R:localhost/127.0.0.1:35437] -- Will try again in 0.1 s
2024-02-05T18:25:23,786 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-7862f6f818] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-7862f6f818, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:25:23,786 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-7862f6f818] Successfully disconnected and closed subscription
2024-02-05T18:25:23,786 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:25:23,792 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=14:-1
2024-02-05T18:25:23,793 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:25:23,794 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-7862f6f818] Closed Consumer (not connected)
2024-02-05T18:25:23,794 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 10.0 ms
2024-02-05T18:25:23,794 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-7862f6f818 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-7862f6f818 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:25:23,801 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:44571 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:44571, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150323784, versionId=9]. totalHandledRequests:4
2024-02-05T18:25:23,802 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:25:23,802 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.028 seconds
2024-02-05T18:25:23,802 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:25:23,802 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:25:23,803 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:25:23,804 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:25:23,804 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0xc8a50831, L:/127.0.0.1:50612 ! R:localhost/127.0.0.1:35437] Disconnected
2024-02-05T18:25:23,804 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:50612
2024-02-05T18:25:23,804 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0xc8a50831, L:/127.0.0.1:50612 ! R:localhost/127.0.0.1:35437] -- Will try again in 0.1 s
2024-02-05T18:25:23,804 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-2f92cd98fd}, consumerId=0, consumerName=16eff, address=/127.0.0.1:50612}
2024-02-05T18:25:23,804 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0xc8a50831, L:/127.0.0.1:50612 ! R:localhost/127.0.0.1:35437] -- Will try again in 0.1 s
2024-02-05T18:25:23,804 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0xc8a50831, L:/127.0.0.1:50612 ! R:localhost/127.0.0.1:35437] -- Will try again in 0.1 s
2024-02-05T18:25:23,804 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:44571/persistent/__change_events] Closing managed ledger
2024-02-05T18:25:23,804 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-2f92cd98fd] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-2f92cd98fd, ackPos=3:6, readPos=3:9}]
2024-02-05T18:25:23,804 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-2f92cd98fd] Closed connection [id: 0xc8a50831, L:/127.0.0.1:50612 ! R:localhost/127.0.0.1:35437] -- Will try again in 0.1 s
2024-02-05T18:25:23,804 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-2f92cd98fd] Successfully closed dispatcher for reader
2024-02-05T18:25:23,804 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-c459c9527e] Closed connection [id: 0xc8a50831, L:/127.0.0.1:50612 ! R:localhost/127.0.0.1:35437] -- Will try again in 0.1 s
2024-02-05T18:25:23,805 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:44571/__change_events] [reader-7e88943a8c] Closed connection [id: 0xc8a50831, L:/127.0.0.1:50612 ! R:localhost/127.0.0.1:35437] -- Will try again in 0.1 s
2024-02-05T18:25:23,805 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-c4f29189b1] Closed connection [id: 0xc8a50831, L:/127.0.0.1:50612 ! R:localhost/127.0.0.1:35437] -- Will try again in 0.1 s
2024-02-05T18:25:23,805 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:44571/__change_events, name=reader-7e88943a8c}, consumerId=3, consumerName=6b1c5, address=/127.0.0.1:50612}
2024-02-05T18:25:23,805 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:44571/__change_events][reader-7e88943a8c] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:44571/persistent/__change_events, cursor=reader-7e88943a8c, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:25:23,805 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:44571/__change_events][reader-7e88943a8c] Successfully closed dispatcher for reader
2024-02-05T18:25:23,806 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-c4f29189b1}, consumerId=2, consumerName=286d2, address=/127.0.0.1:50612}
2024-02-05T18:25:23,806 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-c459c9527e}, consumerId=1, consumerName=b7cc2, address=/127.0.0.1:50612}
2024-02-05T18:25:23,807 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:44571/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:25:23,807 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:25:23,807 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:25:23,808 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:25:23,809 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:25:23,812 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:35437
2024-02-05T18:25:23,813 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:25:23,813 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:25:23,813 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:25:23,813 - ERROR - [main:TopBundleLoadDataReporter@112] - Failed to clean broker load data.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The producer test-0-2 of the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was already closed when closing the producers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:708) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ProducerImpl$1.sendComplete(ProducerImpl.java:362) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl$OpSendMsg.sendComplete(ProducerImpl.java:1517) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.lambda$failPendingMessages$18(ProducerImpl.java:2061) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.ArrayDeque.forEach(ArrayDeque.java:888) ~[?:?]
	at org.apache.pulsar.client.impl.ProducerImpl$OpSendMsgQueue.forEach(ProducerImpl.java:1608) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.failPendingMessages(ProducerImpl.java:2051) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.closeAndClearPendingMessages(ProducerImpl.java:1104) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.closeAsync(ProducerImpl.java:1071) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.PulsarClientImpl.lambda$closeAsync$18(PulsarClientImpl.java:744) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ConcurrentHashMap$KeySetView.forEach(ConcurrentHashMap.java:4706) ~[?:?]
	at java.util.Collections$SetFromMap.forEach(Collections.java:5700) ~[?:?]
	at org.apache.pulsar.client.impl.PulsarClientImpl.closeAsync(PulsarClientImpl.java:744) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.PulsarClientImpl.close(PulsarClientImpl.java:720) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.PulsarService.closeAsync(PulsarService.java:532) ~[classes/:?]
	at java.lang.invoke.MethodHandle.invokeWithArguments(MethodHandle.java:732) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor$Dispatcher$ByteBuddy$qkV6yWbn.invokeWithArguments(Unknown Source) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor.invoke(InstrumentationMemberAccessor.java:239) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.util.reflection.ModuleMemberAccessor.invoke(ModuleMemberAccessor.java:55) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.tryInvoke(MockMethodAdvice.java:333) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.access$500(MockMethodAdvice.java:60) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice$RealMethodCall.invoke(MockMethodAdvice.java:253) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.invocation.InterceptedInvocation.callRealMethod(InterceptedInvocation.java:142) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.stubbing.answers.CallsRealMethods.answer(CallsRealMethods.java:45) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.Answers.answer(Answers.java:99) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.MockHandlerImpl.handle(MockHandlerImpl.java:110) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.NullResultGuardian.handle(NullResultGuardian.java:29) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.InvocationNotifierHandler.handle(InvocationNotifierHandler.java:34) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodInterceptor.doIntercept(MockMethodInterceptor.java:82) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.handle(MockMethodAdvice.java:151) ~[mockito-core-3.12.4.jar:?]
	at org.apache.pulsar.broker.PulsarService.closeAsync(PulsarService.java:419) ~[classes/:?]
	at org.apache.pulsar.broker.PulsarService.close(PulsarService.java:398) ~[classes/:?]
	at java.lang.invoke.MethodHandle.invokeWithArguments(MethodHandle.java:732) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor$Dispatcher$ByteBuddy$qkV6yWbn.invokeWithArguments(Unknown Source) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor.invoke(InstrumentationMemberAccessor.java:239) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.util.reflection.ModuleMemberAccessor.invoke(ModuleMemberAccessor.java:55) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.tryInvoke(MockMethodAdvice.java:333) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.access$500(MockMethodAdvice.java:60) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice$RealMethodCall.invoke(MockMethodAdvice.java:253) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.invocation.InterceptedInvocation.callRealMethod(InterceptedInvocation.java:142) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.stubbing.answers.CallsRealMethods.answer(CallsRealMethods.java:45) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.Answers.answer(Answers.java:99) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.MockHandlerImpl.handle(MockHandlerImpl.java:110) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.NullResultGuardian.handle(NullResultGuardian.java:29) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.InvocationNotifierHandler.handle(InvocationNotifierHandler.java:34) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodInterceptor.doIntercept(MockMethodInterceptor.java:82) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.handle(MockMethodAdvice.java:151) ~[mockito-core-3.12.4.jar:?]
	at org.apache.pulsar.broker.PulsarService.close(PulsarService.java:398) ~[classes/:?]
	at org.apache.pulsar.broker.testcontext.PulsarTestContext$StartableCustomBuilder.lambda$initializePulsarServices$0(PulsarTestContext.java:664) ~[test-classes/:?]
	at org.apache.pulsar.broker.testcontext.PulsarTestContext.close(PulsarTestContext.java:194) ~[test-classes/:?]
	at org.apache.pulsar.broker.auth.MockedPulsarServiceBaseTest.internalCleanup(MockedPulsarServiceBaseTest.java:247) ~[test-classes/:?]
	at org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.cleanup(ExtensibleLoadManagerImplTest.java:197) ~[test-classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.testng.internal.invokers.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:139) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.MethodInvocationHelper.invokeMethodConsideringTimeout(MethodInvocationHelper.java:69) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.ConfigInvoker.invokeConfigurationMethod(ConfigInvoker.java:361) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.ConfigInvoker.invokeConfigurations(ConfigInvoker.java:296) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.TestMethodWorker.invokeAfterClassMethods(TestMethodWorker.java:222) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.TestMethodWorker.run(TestMethodWorker.java:131) ~[testng-7.7.1.jar:7.7.1]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at org.testng.TestRunner.privateRun(TestRunner.java:829) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestRunner.run(TestRunner.java:602) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.runTest(SuiteRunner.java:437) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:431) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.privateRun(SuiteRunner.java:391) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.run(SuiteRunner.java:330) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:95) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.runSuitesSequentially(TestNG.java:1256) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.runSuitesLocally(TestNG.java:1176) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.runSuites(TestNG.java:1099) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.run(TestNG.java:1067) ~[testng-7.7.1.jar:7.7.1]
	at org.apache.maven.surefire.testng.TestNGExecutor.run(TestNGExecutor.java:155) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.executeSingleClass(TestNGDirectoryTestSuite.java:102) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.executeLazy(TestNGDirectoryTestSuite.java:117) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.execute(TestNGDirectoryTestSuite.java:86) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGProvider.invoke(TestNGProvider.java:137) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385) ~[surefire-booter-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162) ~[surefire-booter-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507) ~[surefire-booter-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495) ~[surefire-booter-3.1.0.jar:3.1.0]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The producer test-0-2 of the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was already closed when closing the producers
	at org.apache.pulsar.client.impl.ProducerImpl.closeAndClearPendingMessages(ProducerImpl.java:1101) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 76 more
2024-02-05T18:25:23,816 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-c459c9527e] Closed Consumer (not connected)
2024-02-05T18:25:23,816 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-c459c9527e was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-c459c9527e was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:25:23,817 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:44571/__change_events] [reader-7e88943a8c] Closed Consumer (not connected)
2024-02-05T18:25:23,817 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-2f92cd98fd] Closed Consumer (not connected)
2024-02-05T18:25:23,817 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-c4f29189b1] Closed Consumer (not connected)
2024-02-05T18:25:23,817 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:44571/__change_events with subscription name reader-7e88943a8c was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:44571/__change_events with subscription name reader-7e88943a8c was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:25:23,817 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-2f92cd98fd was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-2f92cd98fd was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:25:23,818 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-c4f29189b1 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-c4f29189b1 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:25:23,821 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:25:23,821 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:25:23,821 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:25:23,821 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:25:23,822 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:25:23,822 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:25:23,823 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:25:23,823 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:25:25,209 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:25:25,210 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:25:25,211 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:25:25,211 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:25:25,211 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:25:25,211 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:25:25,220 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:25:25,220 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:25:25,225 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:25:25,226 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:25:25,226 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:25:25,226 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-2,5,main]'
2024-02-05T18:25:25,226 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:25:25,226 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:25:25,226 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:25:25,226 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:25:25,226 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:25:25,227 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:25:25,227 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 191 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T18:25:25,227 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:25:25,227 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:25:25,227 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@6379f341
2024-02-05T18:25:25,228 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:25:25,228 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:25:25,228 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 30.729 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  57.303 s
[INFO] Finished at: 2024-02-05T18:25:25+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 9 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:25:56,759 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:25:57,682 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:25:57,684 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:25:58,181 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:25:58,182 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:25:58,183 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:25:58,183 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:25:58,184 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:25:58,184 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:25:58,197 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:25:58,197 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:25:58,198 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:25:58,199 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:25:58,199 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:25:58,200 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:25:58,200 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:25:58,201 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:25:58,201 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:25:58,202 - INFO  - [main:Environment@98] - Client environment:os.memory.free=28MB
2024-02-05T18:25:58,202 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:25:58,202 - INFO  - [main:Environment@98] - Client environment:os.memory.total=126MB
2024-02-05T18:25:59,790 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:25:59,792 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:25:59,793 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:25:59,793 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:26:00,152 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:26:00,153 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:26:00,247 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:26:00,336 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:26:00,340 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:26:00,356 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:26:00,456 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:26:00,495 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:26:00,536 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:26:00,836 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:26:00,837 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:26:00,868 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:26:00,947 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:39333, TLS: (none), listener: (none)
2024-02-05T18:26:01,228 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44979, TLS: OPENSSL, listener: (none)
2024-02-05T18:26:01,250 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:26:01,255 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:26:01,256 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:26:01,293 - INFO  - [main:Log@170] - Logging initialized @6798ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:26:02,256 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:26:02,285 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:26:02,286 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:26:02,288 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:26:03,161 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/,null,AVAILABLE}
2024-02-05T18:26:04,342 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,AVAILABLE}
2024-02-05T18:26:05,438 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,AVAILABLE}
2024-02-05T18:26:05,782 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,AVAILABLE}
2024-02-05T18:26:05,902 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,AVAILABLE}
2024-02-05T18:26:06,065 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,AVAILABLE}
2024-02-05T18:26:06,067 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,AVAILABLE}
2024-02-05T18:26:06,069 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@7c200e57{/static,null,AVAILABLE}
2024-02-05T18:26:06,087 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:38049}
2024-02-05T18:26:06,253 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:37379}
2024-02-05T18:26:06,253 - INFO  - [main:Server@415] - Started @11761ms
2024-02-05T18:26:06,254 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:38049
2024-02-05T18:26:06,255 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:37379
2024-02-05T18:26:06,263 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:26:06,263 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:26:06,451 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:38049
2024-02-05T18:26:06,472 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:26:06,477 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:38049 is changing the role from null to Leader
2024-02-05T18:26:06,478 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:38049).
2024-02-05T18:26:06,806 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:38049 
2024-02-05T18:26:07,268 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:26:07,304 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:26:07,430 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:26:07,436 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:26:07,448 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:26:07,450 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:26:07,496 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:26:07,535 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:26:07,567 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:26:07,627 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:26:07,647 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:26:07,659 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:26:07,662 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:26:07,695 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:26:07,696 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:26:07 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 581
2024-02-05T18:26:07,873 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x8f9666bd, L:/127.0.0.1:55308 - R:localhost/127.0.0.1:39333]] Connected to server
2024-02-05T18:26:07,911 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:55308] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:26:07,996 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:26:08,008 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x8f9666bd, L:/127.0.0.1:55308 - R:localhost/127.0.0.1:39333]
2024-02-05T18:26:08,078 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:26:08,121 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:55308] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:55308, producerName=test-0-0, producerId=0}
2024-02-05T18:26:08,136 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x8f9666bd, L:/127.0.0.1:55308 - R:localhost/127.0.0.1:39333]
2024-02-05T18:26:08,138 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:26:08,186 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:26:08,188 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0239a16e72] Subscribing to topic on cnx [id: 0x8f9666bd, L:/127.0.0.1:55308 - R:localhost/127.0.0.1:39333], consumerId 0
2024-02-05T18:26:08,199 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xe79261f7, L:/127.0.0.1:39333 - R:/127.0.0.1:55308]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-0239a16e72. consumerId: 0
2024-02-05T18:26:08,236 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0239a16e72] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:26:08,238 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:26:08,239 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-0239a16e72, ackPos=3:-1, readPos=3:0}
2024-02-05T18:26:08,265 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:55308] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-0239a16e72
2024-02-05T18:26:08,270 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0239a16e72] Subscribed to topic on localhost/127.0.0.1:39333 -- consumer: 0
2024-02-05T18:26:08,281 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.01 seconds
2024-02-05T18:26:08,283 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:26:08,284 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:26:08,285 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:26:08,332 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:26:08,352 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:26:08,354 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:26:08,356 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:26:08 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 56
2024-02-05T18:26:08,356 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:26:08,370 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:26:08,381 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:26:08,382 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:26:08,384 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:26:08 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:26:08,385 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:26:08,404 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:26:08,405 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x8f9666bd, L:/127.0.0.1:55308 - R:localhost/127.0.0.1:39333]
2024-02-05T18:26:08,411 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:26:08,418 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:55308] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:55308, producerName=test-0-1, producerId=1}
2024-02-05T18:26:08,420 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x8f9666bd, L:/127.0.0.1:55308 - R:localhost/127.0.0.1:39333]
2024-02-05T18:26:08,436 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:26:08,438 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-877768784a] Subscribing to topic on cnx [id: 0x8f9666bd, L:/127.0.0.1:55308 - R:localhost/127.0.0.1:39333], consumerId 1
2024-02-05T18:26:08,440 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xe79261f7, L:/127.0.0.1:39333 - R:/127.0.0.1:55308]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-877768784a. consumerId: 1
2024-02-05T18:26:08,465 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-877768784a] Created new subscription for 1
2024-02-05T18:26:08,466 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:55308] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-877768784a
2024-02-05T18:26:08,468 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-877768784a] Subscribed to topic on localhost/127.0.0.1:39333 -- consumer: 1
2024-02-05T18:26:08,489 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:26:08,492 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x8f9666bd, L:/127.0.0.1:55308 - R:localhost/127.0.0.1:39333]
2024-02-05T18:26:08,502 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:26:08,508 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:55308] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:55308, producerName=test-0-2, producerId=2}
2024-02-05T18:26:08,509 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x8f9666bd, L:/127.0.0.1:55308 - R:localhost/127.0.0.1:39333]
2024-02-05T18:26:08,525 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:26:08,553 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:26:08,558 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:38049 started the ownership monitor.
2024-02-05T18:26:08,581 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:26:08,583 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-79ac86fdb1] Subscribing to topic on cnx [id: 0x8f9666bd, L:/127.0.0.1:55308 - R:localhost/127.0.0.1:39333], consumerId 2
2024-02-05T18:26:08,585 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xe79261f7, L:/127.0.0.1:39333 - R:/127.0.0.1:55308]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-79ac86fdb1. consumerId: 2
2024-02-05T18:26:08,599 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-79ac86fdb1] Created new subscription for 2
2024-02-05T18:26:08,599 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:55308] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-79ac86fdb1
2024-02-05T18:26:08,600 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-79ac86fdb1] Subscribed to topic on localhost/127.0.0.1:39333 -- consumer: 2
2024-02-05T18:26:08,601 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:38049 plays the leader now.
2024-02-05T18:26:08,607 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 54.10%, directMemory= 2.73%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 2.73%, weightedMaxEMA= 54.10%, msgThroughputEMA= 0.00, updatedAt= 1707150368606, reportedAt= 0
2024-02-05T18:26:08,616 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:38049/__change_events
2024-02-05T18:26:08,629 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:26:08,641 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:26:08,642 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:26:08,727 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:38049/0x00000000_0xffffffff - localhost:38049.
2024-02-05T18:26:08,731 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:38049
2024-02-05T18:26:08,732 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:38049/0x00000000_0xffffffff - localhost:38049.
2024-02-05T18:26:08,733 - INFO  - [pulsar-7-4:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:38049/0x00000000_0xffffffff
2024-02-05T18:26:08,739 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:38049/__change_events][reader-36fddd7057] Subscribing to topic on cnx [id: 0x8f9666bd, L:/127.0.0.1:55308 - R:localhost/127.0.0.1:39333], consumerId 3
2024-02-05T18:26:08,739 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:38049/0x00000000_0xffffffff
2024-02-05T18:26:08,739 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:38049
2024-02-05T18:26:08,741 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xe79261f7, L:/127.0.0.1:39333 - R:/127.0.0.1:55308]] Subscribing on topic persistent://sla-monitor/test/localhost:38049/__change_events / reader-36fddd7057. consumerId: 3
2024-02-05T18:26:08,754 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:38049/persistent/__change_events
2024-02-05T18:26:08,755 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:38049 doesn't exist.
2024-02-05T18:26:08,760 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:38049/persistent/__change_events'
2024-02-05T18:26:08,767 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:26:08,768 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:38049/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:26:08,775 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:38049/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:26:08,785 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:38049/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:26:08,792 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:38049/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:38049/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:26:08,793 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:38049/__change_events - dedup is disabled
2024-02-05T18:26:08,802 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:26:08,812 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:38049/__change_events][reader-36fddd7057] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:26:08,813 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:38049/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:26:08,813 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:38049/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38049/persistent/__change_events, cursor=reader-36fddd7057, ackPos=7:-1, readPos=7:0}
2024-02-05T18:26:08,816 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:55308] Created subscription on topic persistent://sla-monitor/test/localhost:38049/__change_events / reader-36fddd7057
2024-02-05T18:26:08,817 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:38049/__change_events][reader-36fddd7057] Subscribed to topic on localhost/127.0.0.1:39333 -- consumer: 3
2024-02-05T18:26:08,779 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 38049, tls-port = Optional[37379], broker url= pulsar://localhost:39333, broker tls url= pulsar+ssl://localhost:44979, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[39333], brokerServicePortTls=Optional[44979], webServicePort=Optional[38049], webServicePortTls=Optional[37379], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:26:09,474 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:26:09,475 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:26:09,475 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:26:09,475 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:26:09,481 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:26:09,481 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:26:09,490 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:26:09,495 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:26:09,503 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:26:09,504 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:26:09,511 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:26:09,519 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:26:09,523 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:26:09,534 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:26:09,534 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:26:09,538 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:26:09,542 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:37985, TLS: (none), listener: (none)
2024-02-05T18:26:09,544 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:32945, TLS: OPENSSL, listener: (none)
2024-02-05T18:26:09,549 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:26:09,550 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:26:09,550 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:26:09,564 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:26:09,568 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:26:09,568 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:26:09,569 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:26:09,643 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:26:09,644 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:26:09,654 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/,null,AVAILABLE}
2024-02-05T18:26:10,228 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@633e4742{/admin,null,AVAILABLE}
2024-02-05T18:26:10,645 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:26:10,646 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:26:11,292 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,AVAILABLE}
2024-02-05T18:26:11,541 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,AVAILABLE}
2024-02-05T18:26:11,631 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,AVAILABLE}
2024-02-05T18:26:11,647 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:26:11,647 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:26:11,737 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@12039ae0{/topics,null,AVAILABLE}
2024-02-05T18:26:11,741 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,AVAILABLE}
2024-02-05T18:26:11,741 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@328446e1{/static,null,AVAILABLE}
2024-02-05T18:26:11,743 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:41091}
2024-02-05T18:26:11,756 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:41463}
2024-02-05T18:26:11,757 - INFO  - [main:Server@415] - Started @17264ms
2024-02-05T18:26:11,757 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:41091
2024-02-05T18:26:11,759 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:41463
2024-02-05T18:26:11,761 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:26:11,762 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:26:11,773 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:41091
2024-02-05T18:26:11,774 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:41091 registry has been created.
2024-02-05T18:26:11,775 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:41091. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:26:11,779 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:41091 is changing the role from null to Follower
2024-02-05T18:26:11,783 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:38049).
2024-02-05T18:26:11,789 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:26:11,807 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:41091 
2024-02-05T18:26:11,936 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:26:11 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 62
2024-02-05T18:26:11,955 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:26:11,957 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:26:11,958 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:26:11,971 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:26:11 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 31
2024-02-05T18:26:11,973 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:41091/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:26:11,983 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x513c9289, L:/127.0.0.1:37580 - R:localhost/127.0.0.1:37985]] Connected to server
2024-02-05T18:26:11,988 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:37580] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:26:12,008 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x419b006c, L:/127.0.0.1:34610 - R:localhost/127.0.0.1:39333]] Connected to server
2024-02-05T18:26:12,012 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:34610] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:26:12,013 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x419b006c, L:/127.0.0.1:34610 - R:localhost/127.0.0.1:39333]
2024-02-05T18:26:12,026 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:34610] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:34610, producerName=test-0-3, producerId=0}
2024-02-05T18:26:12,027 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x419b006c, L:/127.0.0.1:34610 - R:localhost/127.0.0.1:39333]
2024-02-05T18:26:12,041 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7454eb6e7c] Subscribing to topic on cnx [id: 0x419b006c, L:/127.0.0.1:34610 - R:localhost/127.0.0.1:39333], consumerId 0
2024-02-05T18:26:12,043 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xad1160e9, L:/127.0.0.1:39333 - R:/127.0.0.1:34610]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-7454eb6e7c. consumerId: 0
2024-02-05T18:26:12,048 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7454eb6e7c] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:26:12,049 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:26:12,049 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-7454eb6e7c, ackPos=3:-1, readPos=3:0}
2024-02-05T18:26:12,051 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:34610] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-7454eb6e7c
2024-02-05T18:26:12,052 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7454eb6e7c] Subscribed to topic on localhost/127.0.0.1:39333 -- consumer: 0
2024-02-05T18:26:12,055 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:26:12,056 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:26:12,087 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:26:12 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:26:12,096 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:26:12,100 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:26:12,101 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:26:12,106 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:26:12 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 18
2024-02-05T18:26:12,106 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:41091/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:26:12,120 - INFO  - [pulsar-web-84-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:26:12 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 9
2024-02-05T18:26:12,127 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:26:12,130 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:26:12,131 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:26:12,134 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:26:12 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:26:12,135 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:41091/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:26:12,157 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x419b006c, L:/127.0.0.1:34610 - R:localhost/127.0.0.1:39333]
2024-02-05T18:26:12,167 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:34610] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:34610, producerName=test-0-4, producerId=1}
2024-02-05T18:26:12,169 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x419b006c, L:/127.0.0.1:34610 - R:localhost/127.0.0.1:39333]
2024-02-05T18:26:12,182 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-ce2c092a76] Subscribing to topic on cnx [id: 0x419b006c, L:/127.0.0.1:34610 - R:localhost/127.0.0.1:39333], consumerId 1
2024-02-05T18:26:12,184 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xad1160e9, L:/127.0.0.1:39333 - R:/127.0.0.1:34610]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-ce2c092a76. consumerId: 1
2024-02-05T18:26:12,197 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-ce2c092a76] Created new subscription for 1
2024-02-05T18:26:12,197 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:34610] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-ce2c092a76
2024-02-05T18:26:12,199 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-ce2c092a76] Subscribed to topic on localhost/127.0.0.1:39333 -- consumer: 1
2024-02-05T18:26:12,214 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x419b006c, L:/127.0.0.1:34610 - R:localhost/127.0.0.1:39333]
2024-02-05T18:26:12,222 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:34610] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:34610, producerName=test-0-5, producerId=2}
2024-02-05T18:26:12,223 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x419b006c, L:/127.0.0.1:34610 - R:localhost/127.0.0.1:39333]
2024-02-05T18:26:12,225 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:26:12,230 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:26:12,231 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:41091 plays a follower now.
2024-02-05T18:26:12,254 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:41091/__change_events
2024-02-05T18:26:12,297 - INFO  - [main:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:41091/__change_events][reader-3dd695bbd2] Subscribing to topic on cnx [id: 0x513c9289, L:/127.0.0.1:37580 - R:localhost/127.0.0.1:37985], consumerId 2
2024-02-05T18:26:12,300 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xe45fc561, L:/127.0.0.1:37985 - R:/127.0.0.1:37580]] Subscribing on topic persistent://sla-monitor/test/localhost:41091/__change_events / reader-3dd695bbd2. consumerId: 2
2024-02-05T18:26:12,303 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:41091/0x00000000_0xffffffff - localhost:41091.
2024-02-05T18:26:12,305 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:41091
2024-02-05T18:26:12,305 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:41091/0x00000000_0xffffffff
2024-02-05T18:26:12,310 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:41091/0x00000000_0xffffffff - localhost:41091.
2024-02-05T18:26:12,312 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:41091/0x00000000_0xffffffff
2024-02-05T18:26:12,317 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:41091
2024-02-05T18:26:12,319 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:41091 doesn't exist.
2024-02-05T18:26:12,321 - INFO  - [pulsar-io-64-3:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:41091/persistent/__change_events
2024-02-05T18:26:12,322 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:41091/persistent/__change_events'
2024-02-05T18:26:12,322 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=2, bootstrap service port = 41091, tls-port = Optional[41463], broker url= pulsar://localhost:37985, broker tls url= pulsar+ssl://localhost:32945, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[37985], brokerServicePortTls=Optional[32945], webServicePort=Optional[41091], webServicePortTls=Optional[41463], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:26:12,331 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:26:12,333 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:41091/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:26:12,337 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:41091/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:26:12,343 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:41091/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:26:12,349 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:41091/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:41091/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:26:12,350 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:41091/__change_events - dedup is disabled
2024-02-05T18:26:12,356 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:26:12,363 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:41091/__change_events][reader-3dd695bbd2] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:26:12,364 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:41091/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:26:12,364 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:41091/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:41091/persistent/__change_events, cursor=reader-3dd695bbd2, ackPos=9:-1, readPos=9:0}
2024-02-05T18:26:12,366 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:37580] Created subscription on topic persistent://sla-monitor/test/localhost:41091/__change_events / reader-3dd695bbd2
2024-02-05T18:26:12,368 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:41091/__change_events][reader-3dd695bbd2] Subscribed to topic on localhost/127.0.0.1:37985 -- consumer: 2
2024-02-05T18:26:12,568 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:26:12,569 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:26:12 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 29
2024-02-05T18:26:12,602 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:26:12,603 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:26:12 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:26:12,638 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:26:12,639 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:26:12,643 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:26:12,644 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:26:12 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 35
2024-02-05T18:26:12,648 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:26:12,648 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:26:12,672 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:26:12,672 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:26:12,673 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:26:12 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 18
2024-02-05T18:26:12,675 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:26:12,676 - INFO  - [pulsar-62-3:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:26:12,677 - INFO  - [pulsar-7-5:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:26:12,693 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:26:12,694 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:26:12,698 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:26:12,699 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:26:12 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:26:12,718 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:26:12,719 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:26:12,720 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:26:12 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 10
2024-02-05T18:26:12,720 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:26:12,721 - INFO  - [pulsar-62-2:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:26:12,724 - INFO  - [pulsar-7-4:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:26:12,772 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:26:12,786 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:26:12,786 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:26:12,801 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:26:12,816 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:26:12,840 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:38049 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:26:12,898 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38049 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:38049, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150372844, versionId=1]. totalHandledRequests:1
2024-02-05T18:26:12,937 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38049 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:38049, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150372926, versionId=2]. totalHandledRequests:1
2024-02-05T18:26:12,941 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:26:12,968 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:26:12,968 - INFO  - [broker-client-shared-internal-executor-11-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:26:12,972 - INFO  - [AsyncHttpClient-37-1:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:26:12,973 - INFO  - [AsyncHttpClient-37-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:26:12 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 206
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:26:12,984 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:26:12 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 186
2024-02-05T18:26:12,992 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:26:12,999 - INFO  - [broker-client-shared-internal-executor-11-1:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:26:13,001 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:26:13,125 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38049 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:38049, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150372955, versionId=3]. totalHandledRequests:1
2024-02-05T18:26:13,133 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:26:13,134 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 8.0 ms
2024-02-05T18:26:13,143 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38049 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:38049, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150373125, versionId=4]. totalHandledRequests:1
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@63919eb1], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5587554b] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@63919eb1, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@79509cd7], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5587554b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6f85b282] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@63919eb1, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@79509cd7, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@ecdd5], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5587554b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6f85b282, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6f4cfd92] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@63919eb1, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@79509cd7, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@ecdd5, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@12877288], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5587554b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6f85b282, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6f4cfd92, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@50d4d3f8] 
2024-02-05T18:26:13,147 - WARN  - [ForkJoinPool.commonPool-worker-3:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:38049. Skipping this broker. Phase one
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@63919eb1, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@79509cd7, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@ecdd5, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@12877288, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2642cc52], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5587554b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6f85b282, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6f4cfd92, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@50d4d3f8, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e6a0565] 
2024-02-05T18:26:13,147 - WARN  - [ForkJoinPool.commonPool-worker-3:LeastResourceUsageWithWeight@126] - There is no broker load data for broker:localhost:38049. Skipping this broker. Phase two
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@63919eb1, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@79509cd7, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@ecdd5, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@12877288, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2642cc52, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7d03112], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5587554b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6f85b282, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6f4cfd92, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@50d4d3f8, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e6a0565, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@71ed6903] 
2024-02-05T18:26:13,147 - INFO  - [ForkJoinPool.commonPool-worker-3:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:38049 for bundle: public/test/0x00000000_0xffffffff.
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@63919eb1, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@79509cd7, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@ecdd5, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@12877288, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2642cc52, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7d03112, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@41fd1b30], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5587554b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6f85b282, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6f4cfd92, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@50d4d3f8, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e6a0565, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@71ed6903, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3f427f47] 
2024-02-05T18:26:13,156 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38049 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:38049, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150373147, versionId=5]. totalHandledRequests:8
2024-02-05T18:26:13,168 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38049 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:38049, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150373156, versionId=6]. totalHandledRequests:6
2024-02-05T18:26:13,170 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-a01a79a5f5] Subscribing to topic on cnx [id: 0x8f9666bd, L:/127.0.0.1:55308 - R:localhost/127.0.0.1:39333], consumerId 4
2024-02-05T18:26:13,170 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
!!!!!!!!! FAILURE-- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:26:13,172 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xe79261f7, L:/127.0.0.1:39333 - R:/127.0.0.1:55308]] Subscribing on topic persistent://public/test/__change_events / reader-a01a79a5f5. consumerId: 4
2024-02-05T18:26:13,182 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:26:13,184 - INFO  - [main:TestRetrySupport@70] - Detected test failure in test ExtensibleLoadManagerImplTest.testGetMetrics, currentSetupNumber=1
2024-02-05T18:26:13,185 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:26:13,197 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:26:13,198 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:26:13,205 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:26:13,210 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:26:13,216 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:26:13,219 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:26:13,235 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:26:13,236 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:26:13,236 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:26:13,238 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-bb5cfe37fb] Subscribing to topic on cnx [id: 0x8f9666bd, L:/127.0.0.1:55308 - R:localhost/127.0.0.1:39333], consumerId 5
2024-02-05T18:26:13,242 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-a01a79a5f5] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:26:13,243 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:26:13,243 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a01a79a5f5, ackPos=11:-1, readPos=11:0}
2024-02-05T18:26:13,247 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:55308] Created subscription on topic persistent://public/test/__change_events / reader-a01a79a5f5
2024-02-05T18:26:13,250 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xe79261f7, L:/127.0.0.1:39333 - R:/127.0.0.1:55308]] Subscribing on topic persistent://public/test/__change_events / reader-bb5cfe37fb. consumerId: 5
2024-02-05T18:26:13,251 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:26:13,252 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:26:13,253 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:26:13,254 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@328446e1{/static,null,STOPPED}
2024-02-05T18:26:13,254 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-a01a79a5f5] Subscribed to topic on localhost/127.0.0.1:39333 -- consumer: 4
2024-02-05T18:26:13,257 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-bb5cfe37fb] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:26:13,257 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:26:13,258 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-bb5cfe37fb, ackPos=11:-1, readPos=11:0}
2024-02-05T18:26:13,260 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,STOPPED}
2024-02-05T18:26:13,262 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:55308] Created subscription on topic persistent://public/test/__change_events / reader-bb5cfe37fb
2024-02-05T18:26:13,263 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-bb5cfe37fb] Subscribed to topic on localhost/127.0.0.1:39333 -- consumer: 5
2024-02-05T18:26:13,266 - INFO  - [pulsar-io-9-1:ServerCnx@2007] - [/127.0.0.1:55308] Closing consumer: consumerId=4
2024-02-05T18:26:13,266 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-a01a79a5f5}, consumerId=4, consumerName=13c72, address=/127.0.0.1:55308}
2024-02-05T18:26:13,267 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-a01a79a5f5] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a01a79a5f5, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:26:13,269 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-a01a79a5f5] Successfully closed dispatcher for reader
2024-02-05T18:26:13,274 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@12039ae0{/topics,null,STOPPED}
2024-02-05T18:26:13,277 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,STOPPED}
2024-02-05T18:26:13,278 - INFO  - [pulsar-io-9-1:ServerCnx@2043] - [/127.0.0.1:55308] Closed consumer, consumerId=4
2024-02-05T18:26:13,281 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,STOPPED}
2024-02-05T18:26:13,281 - INFO  - [pulsar-io-9-4:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-a01a79a5f5] Closed consumer
2024-02-05T18:26:13,284 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,STOPPED}
2024-02-05T18:26:13,284 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:26:13,286 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:26:13,287 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@633e4742{/admin,null,STOPPED}
2024-02-05T18:26:13,287 - INFO  - [pulsar-io-9-1:ServerCnx@2007] - [/127.0.0.1:55308] Closing consumer: consumerId=5
2024-02-05T18:26:13,288 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-bb5cfe37fb}, consumerId=5, consumerName=80a14, address=/127.0.0.1:55308}
2024-02-05T18:26:13,288 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-bb5cfe37fb] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-bb5cfe37fb, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:26:13,288 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-bb5cfe37fb] Successfully closed dispatcher for reader
2024-02-05T18:26:13,289 - INFO  - [pulsar-io-9-1:ServerCnx@2043] - [/127.0.0.1:55308] Closed consumer, consumerId=5
2024-02-05T18:26:13,290 - INFO  - [pulsar-io-9-4:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-bb5cfe37fb] Closed consumer
2024-02-05T18:26:13,293 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/,null,STOPPED}
2024-02-05T18:26:13,298 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:26:13,300 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:26:13,301 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:26:13,302 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:41091
2024-02-05T18:26:13,306 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:41091 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:26:13,315 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:41091 registry has been deleted.
2024-02-05T18:26:13,315 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:41091 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:26:13,318 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:41091 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:26:13,318 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:41091
2024-02-05T18:26:13,320 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:41091 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:26:13,333 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:41091 was invalidated. state Releasing
2024-02-05T18:26:13,335 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:41091. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:26:13,336 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:41091
2024-02-05T18:26:13,358 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:41091/0x00000000_0xffffffff.
2024-02-05T18:26:13,361 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:41091/0x00000000_0xffffffff.
2024-02-05T18:26:13,370 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:41091/0x00000000_0xffffffff.
2024-02-05T18:26:13,370 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.033 seconds
2024-02-05T18:26:13,372 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:26:13,379 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x419b006c, L:/127.0.0.1:34610 ! R:localhost/127.0.0.1:39333] Disconnected
2024-02-05T18:26:13,381 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:26:13,382 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:41091/persistent/__change_events] Closing managed ledger
2024-02-05T18:26:13,384 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:34610
2024-02-05T18:26:13,386 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x419b006c, L:/127.0.0.1:34610 ! R:localhost/127.0.0.1:39333] -- Will try again in 0.1 s
2024-02-05T18:26:13,386 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x513c9289, L:/127.0.0.1:37580 ! R:localhost/127.0.0.1:37985] Disconnected
2024-02-05T18:26:13,386 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x419b006c, L:/127.0.0.1:34610 ! R:localhost/127.0.0.1:39333] -- Will try again in 0.1 s
2024-02-05T18:26:13,387 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x419b006c, L:/127.0.0.1:34610 ! R:localhost/127.0.0.1:39333] -- Will try again in 0.1 s
2024-02-05T18:26:13,387 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-7454eb6e7c}, consumerId=0, consumerName=0cbd2, address=/127.0.0.1:34610}
2024-02-05T18:26:13,387 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-7454eb6e7c] Closed connection [id: 0x419b006c, L:/127.0.0.1:34610 ! R:localhost/127.0.0.1:39333] -- Will try again in 0.1 s
2024-02-05T18:26:13,388 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:37580
2024-02-05T18:26:13,388 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7454eb6e7c] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-7454eb6e7c, ackPos=3:5, readPos=3:6}]
2024-02-05T18:26:13,388 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-ce2c092a76] Closed connection [id: 0x419b006c, L:/127.0.0.1:34610 ! R:localhost/127.0.0.1:39333] -- Will try again in 0.1 s
2024-02-05T18:26:13,388 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:41091/__change_events, name=reader-3dd695bbd2}, consumerId=2, consumerName=4a934, address=/127.0.0.1:37580}
2024-02-05T18:26:13,388 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7454eb6e7c] Successfully closed dispatcher for reader
2024-02-05T18:26:13,388 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:41091/__change_events][reader-3dd695bbd2] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:41091/persistent/__change_events, cursor=reader-3dd695bbd2, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:26:13,389 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:41091/__change_events][reader-3dd695bbd2] Successfully closed dispatcher for reader
2024-02-05T18:26:13,393 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:41091/__change_events] [reader-3dd695bbd2] Closed connection [id: 0x513c9289, L:/127.0.0.1:37580 ! R:localhost/127.0.0.1:37985] -- Will try again in 0.1 s
2024-02-05T18:26:13,393 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:41091/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:26:13,394 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:26:13,396 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:26:13,398 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:26:13,407 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-ce2c092a76}, consumerId=1, consumerName=d1bd6, address=/127.0.0.1:34610}
2024-02-05T18:26:13,419 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:37985
2024-02-05T18:26:13,420 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:26:13,422 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:26:13,422 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:26:13,424 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-7454eb6e7c] Closed Consumer (not connected)
2024-02-05T18:26:13,425 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-7454eb6e7c was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-7454eb6e7c was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:26:13,428 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-ce2c092a76] Closed Consumer (not connected)
2024-02-05T18:26:13,429 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-ce2c092a76 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-ce2c092a76 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:26:13,434 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:41091/__change_events] [reader-3dd695bbd2] Closed Consumer (not connected)
2024-02-05T18:26:13,436 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:41091/__change_events with subscription name reader-3dd695bbd2 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:41091/__change_events with subscription name reader-3dd695bbd2 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:26:13,449 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:26:13,450 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:26:13,455 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:26:13,455 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:26:13,464 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:26:13,465 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:26:13,549 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:26:13,549 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 22.46%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 22.46%, msgThroughputEMA= 0.00, updatedAt= 1707150373548, reportedAt= 0
2024-02-05T18:26:13,650 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:26:13,650 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:26:14,651 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:26:14,652 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:26:14,705 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:26:14,706 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:26:14,708 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:26:14,708 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:26:14,709 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:26:14,709 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:26:15,652 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:26:15,653 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:26:16,654 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:26:16,654 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:26:16,723 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:26:16,724 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:26:16,725 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:26:16,725 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:26:16,725 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@7c200e57{/static,null,STOPPED}
2024-02-05T18:26:16,726 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,STOPPED}
2024-02-05T18:26:16,727 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,STOPPED}
2024-02-05T18:26:16,729 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,STOPPED}
2024-02-05T18:26:16,730 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,STOPPED}
2024-02-05T18:26:16,731 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,STOPPED}
2024-02-05T18:26:16,732 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,STOPPED}
2024-02-05T18:26:16,734 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/,null,STOPPED}
2024-02-05T18:26:16,735 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:26:16,735 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:26:16,736 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:26:16,736 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38049
2024-02-05T18:26:16,738 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:38049, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150373156, versionId=6]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:26:21,748 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38049 in 5010.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:26:21,755 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:38049 was invalidated. state Releasing
2024-02-05T18:26:21,755 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:38049. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:26:21,756 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:38049
2024-02-05T18:26:21,761 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:38049/0x00000000_0xffffffff.
2024-02-05T18:26:21,769 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38049 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:38049, splitServiceUnitToDestBroker=null, force=true, timestamp=1707150381762, versionId=7]. totalHandledRequests:10
2024-02-05T18:26:21,771 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:26:21,773 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:26:21,774 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:26:21,775 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:26:21,780 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:26:21,784 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:26:21,785 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 15.0 ms
2024-02-05T18:26:21,794 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38049 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:38049, splitServiceUnitToDestBroker=null, force=false, timestamp=1707150381770, versionId=8]. totalHandledRequests:4
2024-02-05T18:26:21,794 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:26:21,797 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:38049/0x00000000_0xffffffff.
2024-02-05T18:26:21,798 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:38049/0x00000000_0xffffffff.
2024-02-05T18:26:21,799 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.042 seconds
2024-02-05T18:26:21,799 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:26:21,800 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:55308
2024-02-05T18:26:21,801 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x8f9666bd, L:/127.0.0.1:55308 ! R:localhost/127.0.0.1:39333] Disconnected
2024-02-05T18:26:21,801 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-0239a16e72}, consumerId=0, consumerName=a63ac, address=/127.0.0.1:55308}
2024-02-05T18:26:21,801 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x8f9666bd, L:/127.0.0.1:55308 ! R:localhost/127.0.0.1:39333] -- Will try again in 0.1 s
2024-02-05T18:26:21,801 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0239a16e72] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-0239a16e72, ackPos=3:5, readPos=3:8}]
2024-02-05T18:26:21,801 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0239a16e72] Successfully closed dispatcher for reader
2024-02-05T18:26:21,802 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:38049/__change_events, name=reader-36fddd7057}, consumerId=3, consumerName=ce266, address=/127.0.0.1:55308}
2024-02-05T18:26:21,803 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:38049/__change_events][reader-36fddd7057] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38049/persistent/__change_events, cursor=reader-36fddd7057, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:26:21,803 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:38049/__change_events][reader-36fddd7057] Successfully closed dispatcher for reader
2024-02-05T18:26:21,804 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-79ac86fdb1}, consumerId=2, consumerName=1627c, address=/127.0.0.1:55308}
2024-02-05T18:26:21,804 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-877768784a}, consumerId=1, consumerName=9e822, address=/127.0.0.1:55308}
2024-02-05T18:26:21,806 - WARN  - [pulsar-io-9-1:ServerCnx@407] - [/127.0.0.1:55308] Got exception java.util.concurrent.RejectedExecutionException: event executor terminated
	at io.netty.util.concurrent.SingleThreadEventExecutor.reject(SingleThreadEventExecutor.java:934)
	at io.netty.util.concurrent.SingleThreadEventExecutor.offerTask(SingleThreadEventExecutor.java:351)
	at io.netty.util.concurrent.SingleThreadEventExecutor.addTask(SingleThreadEventExecutor.java:344)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:836)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute0(SingleThreadEventExecutor.java:827)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:817)
	at io.netty.util.concurrent.AbstractEventExecutorGroup.execute(AbstractEventExecutorGroup.java:115)
	at java.base/java.util.concurrent.CompletableFuture.asyncRunStage(CompletableFuture.java:1818)
	at java.base/java.util.concurrent.CompletableFuture.runAsync(CompletableFuture.java:2033)
	at org.apache.pulsar.broker.service.nonpersistent.NonPersistentTopic.unsubscribe(NonPersistentTopic.java:1151)
	at org.apache.pulsar.broker.service.nonpersistent.NonPersistentSubscription.removeConsumer(NonPersistentSubscription.java:189)
	at org.apache.pulsar.broker.service.Consumer.close(Consumer.java:400)
	at org.apache.pulsar.broker.service.Consumer.close(Consumer.java:396)
	at org.apache.pulsar.broker.service.ServerCnx.lambda$channelInactive$1(ServerCnx.java:378)
	at org.apache.pulsar.common.util.collections.ConcurrentLongHashMap$Section.forEach(ConcurrentLongHashMap.java:562)
	at org.apache.pulsar.common.util.collections.ConcurrentLongHashMap.forEach(ConcurrentLongHashMap.java:242)
	at org.apache.pulsar.broker.service.ServerCnx.channelInactive(ServerCnx.java:369)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.handler.flow.FlowControlHandler.channelInactive(FlowControlHandler.java:134)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.handler.codec.ByteToMessageDecoder.channelInputClosed(ByteToMessageDecoder.java:411)
	at io.netty.handler.codec.ByteToMessageDecoder.channelInactive(ByteToMessageDecoder.java:376)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasksFrom(SingleThreadEventExecutor.java:426)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:375)
	at io.netty.util.concurrent.SingleThreadEventExecutor.confirmShutdown(SingleThreadEventExecutor.java:763)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:431)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:840)

2024-02-05T18:26:21,801 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x8f9666bd, L:/127.0.0.1:55308 ! R:localhost/127.0.0.1:39333] -- Will try again in 0.1 s
2024-02-05T18:26:21,807 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x8f9666bd, L:/127.0.0.1:55308 ! R:localhost/127.0.0.1:39333] -- Will try again in 0.1 s
2024-02-05T18:26:21,807 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-0239a16e72] Closed connection [id: 0x8f9666bd, L:/127.0.0.1:55308 ! R:localhost/127.0.0.1:39333] -- Will try again in 0.1 s
2024-02-05T18:26:21,807 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-877768784a] Closed connection [id: 0x8f9666bd, L:/127.0.0.1:55308 ! R:localhost/127.0.0.1:39333] -- Will try again in 0.1 s
2024-02-05T18:26:21,807 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:38049/__change_events] [reader-36fddd7057] Closed connection [id: 0x8f9666bd, L:/127.0.0.1:55308 ! R:localhost/127.0.0.1:39333] -- Will try again in 0.1 s
2024-02-05T18:26:21,808 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-79ac86fdb1] Closed connection [id: 0x8f9666bd, L:/127.0.0.1:55308 ! R:localhost/127.0.0.1:39333] -- Will try again in 0.1 s
2024-02-05T18:26:21,808 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:26:21,809 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:26:21,809 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:38049/persistent/__change_events] Closing managed ledger
2024-02-05T18:26:21,811 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:26:21,815 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:38049/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:26:21,816 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:26:21,816 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:26:21,817 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:26:21,820 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:39333
2024-02-05T18:26:21,821 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:26:21,821 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:26:21,821 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:26:21,821 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:38049/__change_events] [reader-36fddd7057] Closed Consumer (not connected)
2024-02-05T18:26:21,821 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-877768784a] Closed Consumer (not connected)
2024-02-05T18:26:21,821 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-79ac86fdb1] Closed Consumer (not connected)
2024-02-05T18:26:21,822 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-0239a16e72] Closed Consumer (not connected)
2024-02-05T18:26:21,821 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38049/__change_events with subscription name reader-36fddd7057 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38049/__change_events with subscription name reader-36fddd7057 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:26:21,822 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-877768784a was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-877768784a was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:26:21,822 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-79ac86fdb1 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-79ac86fdb1 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:26:21,823 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-0239a16e72 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-0239a16e72 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:26:21,826 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:26:21,826 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:26:21,827 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:26:21,827 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:26:21,827 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:26:21,828 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:26:21,829 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:26:21,829 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:26:23,111 - INFO  - [globalEventExecutor-10-7:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:26:23,112 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:26:23,113 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:26:23,114 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:26:23,114 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:26:23,114 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:26:23,121 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:26:23,122 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:26:23,126 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:26:23,126 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:26:23,126 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:26:23,127 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-2,5,main]'
2024-02-05T18:26:23,127 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:26:23,127 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:26:23,127 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:26:23,127 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:26:23,127 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:26:23,127 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:26:23,128 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 190 with name 'Thread[globalEventExecutor-10-7,5,main]'
2024-02-05T18:26:23,128 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:26:23,128 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:26:23,128 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@3c2ed946
2024-02-05T18:26:23,128 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:26:23,128 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:26:23,129 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[ERROR] Tests run: 1, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 28.302 s <<< FAILURE! - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[ERROR] org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.testGetMetrics  Time elapsed: 0.194 s  <<< FAILURE!
java.lang.AssertionError: Sets differ: expected [dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}]] but got [dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}]]
	at org.testng.Assert.fail(Assert.java:110)
	at org.testng.Assert.assertEquals(Assert.java:2036)
	at org.testng.Assert.assertEquals(Assert.java:1963)
	at org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.testGetMetrics(ExtensibleLoadManagerImplTest.java:1018)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.testng.internal.invokers.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:139)
	at org.testng.internal.invokers.InvokeMethodRunnable.runOne(InvokeMethodRunnable.java:47)
	at org.testng.internal.invokers.InvokeMethodRunnable.call(InvokeMethodRunnable.java:76)
	at org.testng.internal.invokers.InvokeMethodRunnable.call(InvokeMethodRunnable.java:11)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

[INFO] 
[INFO] Results:
[INFO] 
[ERROR] Failures: 
[ERROR]   ExtensibleLoadManagerImplTest.testGetMetrics:1018 Sets differ: expected [dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}]] but got [dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}]]
[INFO] 
[ERROR] Tests run: 1, Failures: 1, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  54.703 s
[INFO] Finished at: 2024-02-05T18:26:23+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:3.1.0:test (default-test) on project pulsar-broker: There are test failures.
[ERROR] 
[ERROR] Please refer to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/surefire-reports for the individual test results.
[ERROR] Please refer to dump files (if any exist) [date].dump, [date]-jvmRun[N].dump and [date].dumpstream.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
Exited after loop #10
